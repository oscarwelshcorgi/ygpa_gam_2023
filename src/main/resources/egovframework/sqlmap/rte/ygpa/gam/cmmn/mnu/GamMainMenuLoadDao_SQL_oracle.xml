<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="MenuCreat">

	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
    <typeAlias  alias="menuCreatVO" type="egovframework.com.sym.mnu.mcm.service.MenuCreatVO"/>
	<typeAlias  alias="comDefaultVO" type="egovframework.com.cmm.ComDefaultVO"/>

	<select id="gamMainMenuLoadDAO.selectMenuList_D" parameterClass="java.lang.String" resultClass="egovMap">
		<![CDATA[
			SELECT
				  A.MENU_NO AS "menuNo"
				, A.MENU_ORDR AS "menuOrdr"
				, A.MENU_NM AS "menuNm"
				, A.UPPER_MENU_NO AS "upperMenuId"
				, (SELECT URL FROM COMTNPROGRMLIST WHERE PROGRM_FILE_NM=A.PROGRM_FILE_NM) as "url"
				, (SELECT PROGRM_STRE_PATH FROM COMTNPROGRMLIST WHERE PROGRM_FILE_NM=A.PROGRM_FILE_NM) as "progrmStrePath"
			FROM COMTNMENUINFO A, COMTNMENUCREATDTLS B
			WHERE A.MENU_NO > 0
				AND B.MENU_NO = A.MENU_NO
				AND B.AUTHOR_CODE = (select AUTHOR_CODE AS "authorCode" from COMTNEMPLYRSCRTYESTBS
		where SCRTY_DTRMN_TRGET_ID =
			(select ESNTL_ID from COMVNUSERMASTER
			where user_id = #userId# ))
			ORDER BY A.MENU_NO, A.MENU_ORDR
		 ]]>
	</select>

	<select id="gamMainMenuLoadDAO.selectAuthorByUsr" parameterClass="comDefaultVO" resultClass="MenuCreatVO">
		<![CDATA[
		select AUTHOR_CODE AS "authorCode" from COMTNEMPLYRSCRTYESTBS5
		where SCRTY_DTRMN_TRGET_ID =
			(select ESNTL_ID from COMVNUSERMASTER
			where user_id = #searchKeyword# )
		]]>
	</select>

	<select id="gamMainMenuLoadDAO.selectUsrByPk" parameterClass="comDefaultVO" resultClass="int">
		<![CDATA[
		select count(AUTHOR_CODE) from COMTNEMPLYRSCRTYESTBS
		where SCRTY_DTRMN_TRGET_ID =
			(select ESNTL_ID from COMVNUSERMASTER
			where user_id = #searchKeyword# )
		]]>
	</select>

</sqlMap>