<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >

<sqlMap namespace="ygpa.gam.oper.htldnew">

	<typeAlias alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
    <typeAlias alias="hashMap" type="java.util.HashMap"/>

	<typeAlias alias="gamHtldRentMngtMainVO" type="egovframework.rte.ygpa.gam.oper.htldnew.service.GamHtldRentMngtMainVO"/>
	<typeAlias alias="gamHtldRentRntfeeVO" type="egovframework.rte.ygpa.gam.oper.htldnew.service.GamHtldRentRntfeeVO"/>
	<typeAlias alias="gamHtldQuGtqyVO" type="egovframework.rte.ygpa.gam.oper.htldnew.service.GamHtldQuGtqyVO"/>

	<!-- 배후단지 임대 상세목록 조회 -->
	<select id="gamHtldRentMngtMainDao.selectHtldRentDetailList_D" parameterClass="gamHtldRentMngtMainVO" resultClass="egovMap">
		SELECT
			L.MNG_YEAR MNG_YEAR
			,L.MNG_NO MNG_NO
			,L.MNG_SEQ MNG_SEQ
			,L.ASSETS_NM
			,L.ASSETS_CD
			,L.REGIST_SEQ REGIST_SEQ
			,L.RNTFEE_SEQ RNTFEE_SEQ
			,L.ENTRPS_CD ENTRPS_CD
			,L.ENTRPS_NM ENTRPS_NM
			,L.BOUND_CD BOUND_CD
			,L.BOUND_NM BOUND_NM
			,L.PAY_SE PAY_SE
			,L.CTRT_BEGIN_DT CTRT_BEGIN_DT
			,L.CTRT_END_DT CTRT_END_DT
			,L.PAY_SE_NM PAY_SE_NM
			,L.CHRGE_KND_CD CHRGE_KND_CD
			,L.CHRGE_KND_NM CHRGE_KND_NM
			,L.TERMN_DT TERMN_DT
			,L.TERMN_YN TERMN_YN
			,L.DETAIL_PD_BEGIN DETAIL_PD_BEGIN
			,L.DETAIL_PD_END DETAIL_PD_END
			,L.RENT_AR RENT_AR
			,L.RENT_AR_STR RENT_AR_STR
			,L.RENT_AR_SE RENT_AR_SE
			,L.RENT_AR_SE_NM RENT_AR_SE_NM
			,L.APPLC_RNTFEE APPLC_RNTFEE
			,L.APPLC_RNTFEE_STR APPLC_RNTFEE_STR
			,L.PRICE_SE PRICE_SE
			,L.PRICE_SE_NM PRICE_SE_NM
			,L.ASE_RNTFEE ASE_RNTFEE
			,L.ASE_RNTFEE_STR ASE_RNTFEE_STR
			,L.ASE_APPLC_BEGIN ASE_APPLC_BEGIN
			,L.ASE_APPLC_END ASE_APPLC_END
			,L.NTIC_BEGIN_DT NTIC_BEGIN_DT
			,L.NTIC_END_DT NTIC_END_DT
			,L.RNTFEE RNTFEE
			,L.RNTFEE_SE RNTFEE_SE
			,L.RNTFEE_SE_NM RNTFEE_SE_NM
			,L.PAYINST_INTR PAYINST_INTR
			,L.SUP_AMT SUP_AMT
			,L.VAT VAT
			,L.PAY_AMT PAY_AMT
			,L.ACCNUT_YEAR ACCNUT_YEAR
			,L.RNTFEE_NTIC_NO RNTFEE_NTIC_NO
			,L.NTIC_SEQ NTIC_SEQ
			,L.NTIC_NO NTIC_NO
			,DECODE(L.NTIC_NO, NULL, 'N', 'Y') NTIC_YN
			,L.RCIV_SE RCIV_SE
			,TO_CHAR(L.RCIV_DT, 'YYYY-MM-DD') RCIV_DT
			,TO_CHAR(L.PAY_TMLMT, 'YYYY-MM-DD') PAY_TMLMT
			,GAM_GET_IS_PASS_DATE_YN(L.PAY_TMLMT) PAY_TMLMT_YN
			,L.HIST_SEQ
			,NVL(L.DLY_SER_NO, '00') DLY_SER_NO
			,NVL(L.NHT_PRT_YN, 'N') NHT_PRT_YN
			,NVL(L.DLY_BILL_PRT_YN, 'N') DLY_BILL_PRT_YN
			,L.RM RM
		FROM
			(
				(
				<!-- 임대료 상세 가져오는 쿼리 -->
				SELECT
					D.MNG_YEAR MNG_YEAR
					,D.MNG_NO MNG_NO
					,D.MNG_SEQ MNG_SEQ
					,D.ASSETS_NM ASSETS_NM
					,D.GIS_ASSETS_CD || '-' || D.GIS_ASSETS_SUB_CD ASSETS_CD
					,D.REGIST_SEQ REGIST_SEQ
					,F.RNTFEE_SEQ RNTFEE_SEQ
					,R.ENTRPS_CD ENTRPS_CD
					,(SELECT E.ENTRPS_NM FROM ENTRPS_INFO_F E WHERE E.ENTRPSCD = R.ENTRPS_CD) ENTRPS_NM
					,R.BOUND_CD BOUND_CD
					,GAM_GETCODENAME('GAM062', R.BOUND_CD) BOUND_NM
					,R.PAY_SE PAY_SE
					,TO_CHAR(R.CTRT_BEGIN_DT, 'YYYY-MM-DD') CTRT_BEGIN_DT
					,TO_CHAR(R.CTRT_END_DT, 'YYYY-MM-DD') CTRT_END_DT
					,GAM_GETCODENAME('GAM008', R.PAY_SE) PAY_SE_NM
					,R.CHRGE_KND_CD CHRGE_KND_CD
					,GAM_GETCODENAME('GAM053', R.CHRGE_KND_CD) CHRGE_KND_NM
					,TO_CHAR(R.TERMN_DT, 'YYYY-MM-DD') TERMN_DT
					,GAM_GET_RENT_TERMN_YN(R.TERMN_DT) TERMN_YN
					,TO_CHAR(D.DETAIL_PD_BEGIN, 'YYYY-MM-DD') DETAIL_PD_BEGIN
					,TO_CHAR(D.DETAIL_PD_END, 'YYYY-MM-DD') DETAIL_PD_END
					,NVL(D.RENT_AR, 0) RENT_AR
					,TO_CHAR(NVL(D.RENT_AR, 0), '9,999,999,999.99') RENT_AR_STR
					,D.RENT_AR_SE RENT_AR_SE
					,DECODE(D.RENT_AR_SE, '1', '물류부지', '2', '제조부지', '3', '숙성실', '') RENT_AR_SE_NM
					,NVL(D.APPLC_RNTFEE, 0) APPLC_RNTFEE
					,TO_CHAR(NVL(D.APPLC_RNTFEE, 0), '9,999,999,999.99') APPLC_RNTFEE_STR
					,D.PRICE_SE PRICE_SE
					,DECODE(D.PRICE_SE, '1', '면적당단가', '2', '월단가','') PRICE_SE_NM
					,NVL(D.ASE_RNTFEE, 0) ASE_RNTFEE
					,TO_CHAR(NVL(D.ASE_RNTFEE, 0), '9,999,999,999.99') ASE_RNTFEE_STR
					,TO_CHAR(D.ASE_APPLC_BEGIN, 'YYYY-MM-DD') ASE_APPLC_BEGIN
					,TO_CHAR(D.ASE_APPLC_END, 'YYYY-MM-DD') ASE_APPLC_END
					,TO_CHAR(F.NTIC_BEGIN_DT, 'YYYY-MM-DD') NTIC_BEGIN_DT
					,TO_CHAR(F.NTIC_END_DT, 'YYYY-MM-DD') NTIC_END_DT
					,NVL(F.RNTFEE, 0) RNTFEE
					,NVL(F.RNTFEE_SE, '0') RNTFEE_SE
					,F.RNTFEE_SE_NM RNTFEE_SE_NM
					,NVL(F.PAYINST_INTR, 0) PAYINST_INTR
					,NVL(F.SUP_AMT, 0) SUP_AMT
					,NVL(F.VAT, 0) VAT
					,NVL(F.PAY_AMT, 0) PAY_AMT
					,F.ACCNUT_YEAR ACCNUT_YEAR
					,F.RNTFEE_NTIC_NO RNTFEE_NTIC_NO
					,F.NTIC_SEQ NTIC_SEQ
					,(SELECT NTIC_NO FROM HTLD_NTIC_DTLS_F WHERE ACCNUT_YEAR = F.ACCNUT_YEAR AND RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND NTIC_SEQ = F.NTIC_SEQ) NTIC_NO
					,(SELECT PAY_TMLMT FROM HTLD_NTIC_DTLS_F WHERE ACCNUT_YEAR = F.ACCNUT_YEAR AND RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND NTIC_SEQ = F.NTIC_SEQ) PAY_TMLMT
					,(SELECT RCIV_SE FROM HTLD_NTIC_DTLS_F WHERE ACCNUT_YEAR = F.ACCNUT_YEAR AND RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND NTIC_SEQ = F.NTIC_SEQ) RCIV_SE
					,(SELECT RCIV_DT FROM HTLD_NTIC_DTLS_F WHERE ACCNUT_YEAR = F.ACCNUT_YEAR AND RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND NTIC_SEQ = F.NTIC_SEQ) RCIV_DT
					,(SELECT HIST_SEQ FROM HTLD_NTIC_DTLS_F WHERE ACCNUT_YEAR = F.ACCNUT_YEAR AND RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND NTIC_SEQ = F.NTIC_SEQ) HIST_SEQ
					,(SELECT ARRRG_NO FROM HTLD_NTIC_DTLS_F WHERE ACCNUT_YEAR = F.ACCNUT_YEAR AND RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND NTIC_SEQ = F.NTIC_SEQ) DLY_SER_NO
					,(SELECT NHT_PRT_YN FROM HTLD_NTIC_DTLS_F WHERE ACCNUT_YEAR = F.ACCNUT_YEAR AND RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND NTIC_SEQ = F.NTIC_SEQ) NHT_PRT_YN
					,( SELECT U.DLY_BILL_PRT_YN FROM HTLD_NTIC_DTLS_F N, UNPAID_F U WHERE U.PRT_AT_CODE = '622'
  						AND N.ACCNUT_YEAR = U.FISCAL_YR AND N.NTIC_NO = U.BILL_NO AND GAM_GET_HTLD_ARRRG_CHRGE_KND(N.CHRGE_KND_CD) = U.WORK_CODE
  						AND U.FEE_TP = GAM_GET_HTLD_FEE_TP(GAM_GET_HTLD_ARRRG_CHRGE_KND(N.CHRGE_KND_CD))
  						AND N.ACCNUT_YEAR = F.ACCNUT_YEAR AND N.RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND N.NTIC_SEQ = F.NTIC_SEQ
					) DLY_BILL_PRT_YN
					,F.RM RM
				FROM
					<isNotEmpty property="histDt">
						<![CDATA[
						(	SELECT A.* FROM HTLD_RENT_DETAIL_HIST_F A
								WHERE A.HIST_SEQ = GAM_GET_HTLD_RENT_HIST_SEQ(A.MNG_YEAR, A.MNG_NO, A.MNG_SEQ, #histDt#)
									AND A.DETAIL_PD_BEGIN <= TO_DATE(#histDt#, 'YYYY-MM-DD')
									AND A.DETAIL_PD_END >= TO_DATE(#histDt#, 'YYYY-MM-DD')
						) D
						]]>
					</isNotEmpty>
				LEFT OUTER JOIN
					HTLD_RNTFEE_F F
					ON D.MNG_YEAR = F.MNG_YEAR AND D.MNG_NO = F.MNG_NO AND D.MNG_SEQ = F.MNG_SEQ
						AND (F.RENT_DETAIL_REGIST_SEQ IS NULL OR F.RENT_DETAIL_REGIST_SEQ = D.REGIST_SEQ) AND (F.RNTFEE_SE IS NULL OR F.RNTFEE_SE = '0' )
						<isNotEmpty property="histDt" prepend="AND">
							<![CDATA[
								((F.NTIC_BEGIN_DT <= TO_DATE(#histDt#, 'YYYY-MM-DD') AND F.NTIC_END_DT >= TO_DATE(#histDt#, 'YYYY-MM-DD')) OR (F.NTIC_BEGIN_DT IS NULL AND F.NTIC_END_DT IS NULL ))
							]]>
						</isNotEmpty>
				INNER JOIN
					<isNotEmpty property="histDt">
						(SELECT B.* FROM HTLD_RENT_HIST_F B WHERE B.HIST_SEQ = GAM_GET_HTLD_RENT_HIST_SEQ(B.MNG_YEAR, B.MNG_NO, B.MNG_SEQ, #histDt#)) R
					</isNotEmpty>
					ON D.MNG_YEAR = R.MNG_YEAR AND D.MNG_NO = R.MNG_NO AND D.MNG_SEQ = R.MNG_SEQ
				)
				UNION ALL
				(
				<!-- 실적평가 및 지적평가 가져오는 쿼리 -->
				SELECT
					D.MNG_YEAR MNG_YEAR
					,D.MNG_NO MNG_NO
					,D.MNG_SEQ MNG_SEQ
					,D.ASSETS_NM ASSETS_NM
					,D.GIS_ASSETS_CD || '-' || D.GIS_ASSETS_SUB_CD ASSETS_CD
					,D.REGIST_SEQ REGIST_SEQ
					,F.RNTFEE_SEQ RNTFEE_SEQ
					,R.ENTRPS_CD ENTRPS_CD
					,(SELECT E.ENTRPS_NM FROM ENTRPS_INFO_F E WHERE E.ENTRPSCD = R.ENTRPS_CD) ENTRPS_NM
					,R.BOUND_CD BOUND_CD
					,GAM_GETCODENAME('GAM062', R.BOUND_CD) BOUND_NM
					,R.PAY_SE PAY_SE
					,TO_CHAR(R.CTRT_BEGIN_DT, 'YYYY-MM-DD') CTRT_BEGIN_DT
					,TO_CHAR(R.CTRT_END_DT, 'YYYY-MM-DD') CTRT_END_DT
					,GAM_GETCODENAME('GAM008', R.PAY_SE) PAY_SE_NM
					,R.CHRGE_KND_CD CHRGE_KND_CD
					,GAM_GETCODENAME('GAM053', R.CHRGE_KND_CD) CHRGE_KND_NM
					,TO_CHAR(R.TERMN_DT, 'YYYY-MM-DD') TERMN_DT
					,GAM_GET_RENT_TERMN_YN(R.TERMN_DT) TERMN_YN
					,TO_CHAR(D.DETAIL_PD_BEGIN, 'YYYY-MM-DD') DETAIL_PD_BEGIN
					,TO_CHAR(D.DETAIL_PD_END, 'YYYY-MM-DD') DETAIL_PD_END
					,NVL(D.RENT_AR, 0) RENT_AR
					,TO_CHAR(NVL(D.RENT_AR, 0), '9,999,999,999.99') RENT_AR_STR
					,D.RENT_AR_SE RENT_AR_SE
					,DECODE(D.RENT_AR_SE, '1', '물류부지', '2', '제조부지', '3', '숙성실', '') RENT_AR_SE_NM
					,NVL(D.APPLC_RNTFEE, 0) APPLC_RNTFEE
					,TO_CHAR(NVL(D.APPLC_RNTFEE, 0), '9,999,999,999.99') APPLC_RNTFEE_STR
					,D.PRICE_SE PRICE_SE
					,DECODE(D.PRICE_SE, '1', '면적당단가', '2', '월단가','') PRICE_SE_NM
					,NVL(F.APPLC_RNTFEE, 0) ASE_RNTFEE
					,TO_CHAR(NVL(F.APPLC_RNTFEE, 0), '9,999,999,999.99') ASE_RNTFEE_STR
					,TO_CHAR(F.APPLC_BEGIN_DT, 'YYYY-MM-DD') ASE_APPLC_BEGIN
					,TO_CHAR(F.APPLC_END_DT, 'YYYY-MM-DD') ASE_APPLC_END
					,TO_CHAR(F.NTIC_BEGIN_DT, 'YYYY-MM-DD') NTIC_BEGIN_DT
					,TO_CHAR(F.NTIC_END_DT, 'YYYY-MM-DD') NTIC_END_DT
					,NVL(F.RNTFEE, 0) RNTFEE
					,F.RNTFEE_SE RNTFEE_SE
					,F.RNTFEE_SE_NM RNTFEE_SE_NM
					,NVL(F.PAYINST_INTR, 0) PAYINST_INTR
					,NVL(F.SUP_AMT, 0) SUP_AMT
					,NVL(F.VAT, 0) VAT
					,NVL(F.PAY_AMT, 0) PAY_AMT
					,F.ACCNUT_YEAR ACCNUT_YEAR
					,F.RNTFEE_NTIC_NO RNTFEE_NTIC_NO
					,F.NTIC_SEQ NTIC_SEQ
					,(SELECT NTIC_NO FROM HTLD_NTIC_DTLS_F WHERE ACCNUT_YEAR = F.ACCNUT_YEAR AND RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND NTIC_SEQ = F.NTIC_SEQ) NTIC_NO
					,(SELECT PAY_TMLMT FROM HTLD_NTIC_DTLS_F WHERE ACCNUT_YEAR = F.ACCNUT_YEAR AND RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND NTIC_SEQ = F.NTIC_SEQ) PAY_TMLMT
					,(SELECT RCIV_SE FROM HTLD_NTIC_DTLS_F WHERE ACCNUT_YEAR = F.ACCNUT_YEAR AND RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND NTIC_SEQ = F.NTIC_SEQ) RCIV_SE
					,(SELECT RCIV_DT FROM HTLD_NTIC_DTLS_F WHERE ACCNUT_YEAR = F.ACCNUT_YEAR AND RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND NTIC_SEQ = F.NTIC_SEQ) RCIV_DT
					,(SELECT HIST_SEQ FROM HTLD_NTIC_DTLS_F WHERE ACCNUT_YEAR = F.ACCNUT_YEAR AND RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND NTIC_SEQ = F.NTIC_SEQ) HIST_SEQ
					,(SELECT ARRRG_NO FROM HTLD_NTIC_DTLS_F WHERE ACCNUT_YEAR = F.ACCNUT_YEAR AND RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND NTIC_SEQ = F.NTIC_SEQ) DLY_SER_NO
					,(SELECT NHT_PRT_YN FROM HTLD_NTIC_DTLS_F WHERE ACCNUT_YEAR = F.ACCNUT_YEAR AND RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND NTIC_SEQ = F.NTIC_SEQ) NHT_PRT_YN
					,( SELECT U.DLY_BILL_PRT_YN FROM HTLD_NTIC_DTLS_F N, UNPAID_F U WHERE U.PRT_AT_CODE = '622'
  						AND N.ACCNUT_YEAR = U.FISCAL_YR AND N.NTIC_NO = U.BILL_NO AND GAM_GET_HTLD_ARRRG_CHRGE_KND(N.CHRGE_KND_CD) = U.WORK_CODE
  						AND U.FEE_TP = GAM_GET_HTLD_FEE_TP(GAM_GET_HTLD_ARRRG_CHRGE_KND(N.CHRGE_KND_CD))
  						AND N.ACCNUT_YEAR = F.ACCNUT_YEAR AND N.RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND N.NTIC_SEQ = F.NTIC_SEQ
					) DLY_BILL_PRT_YN
					,F.RM RM
				FROM
					HTLD_RNTFEE_F F
				LEFT OUTER JOIN
					<isNotEmpty property="histDt">
						(SELECT A.* FROM HTLD_RENT_DETAIL_HIST_F A WHERE A.HIST_SEQ = GAM_GET_HTLD_RENT_HIST_SEQ(A.MNG_YEAR, A.MNG_NO, A.MNG_SEQ, #histDt#)) D
					</isNotEmpty>
					ON D.MNG_YEAR = F.MNG_YEAR AND D.MNG_NO = F.MNG_NO AND D.MNG_SEQ = F.MNG_SEQ AND D.REGIST_SEQ = F.RENT_DETAIL_REGIST_SEQ AND (F.RNTFEE_SE = '1' OR F.RNTFEE_SE = '2')
						<isNotEmpty property="histDt" prepend="AND">
							<![CDATA[
								D.DETAIL_PD_BEGIN <= TO_DATE(#histDt#, 'YYYY-MM-DD')
								AND D.DETAIL_PD_END >= TO_DATE(#histDt#, 'YYYY-MM-DD')
								AND F.NTIC_BEGIN_DT <= TO_DATE(#histDt#, 'YYYY-MM-DD')
								AND F.NTIC_END_DT >= TO_DATE(#histDt#, 'YYYY-MM-DD')
							]]>
						</isNotEmpty>
				INNER JOIN
					<isNotEmpty property="histDt">
						(SELECT B.* FROM HTLD_RENT_HIST_F B WHERE B.HIST_SEQ = GAM_GET_HTLD_RENT_HIST_SEQ(B.MNG_YEAR, B.MNG_NO, B.MNG_SEQ, #histDt#)) R
					</isNotEmpty>
					ON D.MNG_YEAR = R.MNG_YEAR AND D.MNG_NO = R.MNG_NO AND D.MNG_SEQ = R.MNG_SEQ
				)
				UNION ALL
				(
				<!-- 추가정산 가져오는 쿼리 -->
				SELECT
					F.MNG_YEAR MNG_YEAR
					,F.MNG_NO MNG_NO
					,F.MNG_SEQ MNG_SEQ
					,'' ASSETS_NM
					,'' ASSETS_CD
					,NULL REGIST_SEQ
					,F.RNTFEE_SEQ RNTFEE_SEQ
					,R.ENTRPS_CD ENTRPS_CD
					,(SELECT E.ENTRPS_NM FROM ENTRPS_INFO_F E WHERE E.ENTRPSCD = R.ENTRPS_CD) ENTRPS_NM
					,R.BOUND_CD BOUND_CD
					,GAM_GETCODENAME('GAM062', R.BOUND_CD) BOUND_NM
					,R.PAY_SE PAY_SE
					,TO_CHAR(R.CTRT_BEGIN_DT, 'YYYY-MM-DD') CTRT_BEGIN_DT
					,TO_CHAR(R.CTRT_END_DT, 'YYYY-MM-DD') CTRT_END_DT
					,GAM_GETCODENAME('GAM008', R.PAY_SE) PAY_SE_NM
					,R.CHRGE_KND_CD CHRGE_KND_CD
					,GAM_GETCODENAME('GAM053', R.CHRGE_KND_CD) CHRGE_KND_NM
					,TO_CHAR(R.TERMN_DT, 'YYYY-MM-DD') TERMN_DT
					,GAM_GET_RENT_TERMN_YN(R.TERMN_DT) TERMN_YN
					,TO_CHAR(R.CTRT_BEGIN_DT, 'YYYY-MM-DD') DETAIL_PD_BEGIN
					,TO_CHAR(R.CTRT_END_DT, 'YYYY-MM-DD') DETAIL_PD_END
					,0 RENT_AR
					,'0' RENT_AR_STR
					,NULL RENT_AR_SE
					,'' RENT_AR_SE_NM
					,0 APPLC_RNTFEE
					,'0' APPLC_RNTFEE_STR
					,NULL PRICE_SE
					,'' PRICE_SE_NM
					,NVL(F.APPLC_RNTFEE, 0) ASE_RNTFEE
					,TO_CHAR(NVL(F.APPLC_RNTFEE, 0), '9,999,999,999.99') ASE_RNTFEE_STR
					,TO_CHAR(F.APPLC_BEGIN_DT, 'YYYY-MM-DD') ASE_APPLC_BEGIN
					,TO_CHAR(F.APPLC_END_DT, 'YYYY-MM-DD') ASE_APPLC_END
					,TO_CHAR(F.NTIC_BEGIN_DT, 'YYYY-MM-DD') NTIC_BEGIN_DT
					,TO_CHAR(F.NTIC_END_DT, 'YYYY-MM-DD') NTIC_END_DT
					,NVL(F.RNTFEE, 0) RNTFEE
					,F.RNTFEE_SE RNTFEE_SE
					,F.RNTFEE_SE_NM RNTFEE_SE_NM
					,NVL(F.PAYINST_INTR, 0) PAYINST_INTR
					,NVL(F.SUP_AMT, 0) SUP_AMT
					,NVL(F.VAT, 0) VAT
					,NVL(F.PAY_AMT, 0) PAY_AMT
					,F.ACCNUT_YEAR ACCNUT_YEAR
					,F.RNTFEE_NTIC_NO RNTFEE_NTIC_NO
					,F.NTIC_SEQ NTIC_SEQ
					,(SELECT NTIC_NO FROM HTLD_NTIC_DTLS_F WHERE ACCNUT_YEAR = F.ACCNUT_YEAR AND RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND NTIC_SEQ = F.NTIC_SEQ) NTIC_NO
					,(SELECT PAY_TMLMT FROM HTLD_NTIC_DTLS_F WHERE ACCNUT_YEAR = F.ACCNUT_YEAR AND RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND NTIC_SEQ = F.NTIC_SEQ) PAY_TMLMT
					,(SELECT RCIV_SE FROM HTLD_NTIC_DTLS_F WHERE ACCNUT_YEAR = F.ACCNUT_YEAR AND RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND NTIC_SEQ = F.NTIC_SEQ) RCIV_SE
					,(SELECT RCIV_DT FROM HTLD_NTIC_DTLS_F WHERE ACCNUT_YEAR = F.ACCNUT_YEAR AND RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND NTIC_SEQ = F.NTIC_SEQ) RCIV_DT
					,(SELECT HIST_SEQ FROM HTLD_NTIC_DTLS_F WHERE ACCNUT_YEAR = F.ACCNUT_YEAR AND RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND NTIC_SEQ = F.NTIC_SEQ) HIST_SEQ
					,(SELECT ARRRG_NO FROM HTLD_NTIC_DTLS_F WHERE ACCNUT_YEAR = F.ACCNUT_YEAR AND RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND NTIC_SEQ = F.NTIC_SEQ) DLY_SER_NO
					,(SELECT NHT_PRT_YN FROM HTLD_NTIC_DTLS_F WHERE ACCNUT_YEAR = F.ACCNUT_YEAR AND RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND NTIC_SEQ = F.NTIC_SEQ) NHT_PRT_YN
					,( SELECT U.DLY_BILL_PRT_YN FROM HTLD_NTIC_DTLS_F N, UNPAID_F U WHERE U.PRT_AT_CODE = '622'
  						AND N.ACCNUT_YEAR = U.FISCAL_YR AND N.NTIC_NO = U.BILL_NO AND GAM_GET_HTLD_ARRRG_CHRGE_KND(N.CHRGE_KND_CD) = U.WORK_CODE
  						AND U.FEE_TP = GAM_GET_HTLD_FEE_TP(GAM_GET_HTLD_ARRRG_CHRGE_KND(N.CHRGE_KND_CD))
  						AND N.ACCNUT_YEAR = F.ACCNUT_YEAR AND N.RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND N.NTIC_SEQ = F.NTIC_SEQ
					) DLY_BILL_PRT_YN
					,F.RM RM
				FROM
					HTLD_RNTFEE_F F
				INNER JOIN
					<isNotEmpty property="histDt">
						(SELECT B.* FROM HTLD_RENT_HIST_F B WHERE B.HIST_SEQ = GAM_GET_HTLD_RENT_HIST_SEQ(B.MNG_YEAR, B.MNG_NO, B.MNG_SEQ, #histDt#)) R
					</isNotEmpty>
					ON F.MNG_YEAR = R.MNG_YEAR AND F.MNG_NO = R.MNG_NO AND F.MNG_SEQ = R.MNG_SEQ AND F.RNTFEE_SE = '3'
						<isNotEmpty property="histDt" prepend="AND">
							<![CDATA[
								R.CTRT_BEGIN_DT <= TO_DATE(#histDt#, 'YYYY-MM-DD')
								AND R.CTRT_END_DT >= TO_DATE(#histDt#, 'YYYY-MM-DD')
								AND F.NTIC_BEGIN_DT <= TO_DATE(#histDt#, 'YYYY-MM-DD')
								AND F.NTIC_END_DT >= TO_DATE(#histDt#, 'YYYY-MM-DD')
							]]>
						</isNotEmpty>
				)
				UNION ALL
	      		(
	      			<!--  전분기 또는 전년도 미납 연체 임대료 자료 조회 -->
					SELECT
						D.MNG_YEAR MNG_YEAR
						,D.MNG_NO MNG_NO
						,D.MNG_SEQ MNG_SEQ
						,D.ASSETS_NM ASSETS_NM
						,D.GIS_ASSETS_CD || '-' || D.GIS_ASSETS_SUB_CD ASSETS_CD
						,D.REGIST_SEQ REGIST_SEQ
						,F.RNTFEE_SEQ RNTFEE_SEQ
						,R.ENTRPS_CD ENTRPS_CD
						,(SELECT E.ENTRPS_NM FROM ENTRPS_INFO_F E WHERE E.ENTRPSCD = R.ENTRPS_CD) ENTRPS_NM
						,R.BOUND_CD BOUND_CD
						,GAM_GETCODENAME('GAM062', R.BOUND_CD) BOUND_NM
						,R.PAY_SE PAY_SE
						,TO_CHAR(R.CTRT_BEGIN_DT, 'YYYY-MM-DD') CTRT_BEGIN_DT
						,TO_CHAR(R.CTRT_END_DT, 'YYYY-MM-DD') CTRT_END_DT
						,GAM_GETCODENAME('GAM008', R.PAY_SE) PAY_SE_NM
						,R.CHRGE_KND_CD CHRGE_KND_CD
						,GAM_GETCODENAME('GAM053', R.CHRGE_KND_CD) CHRGE_KND_NM
						,TO_CHAR(R.TERMN_DT, 'YYYY-MM-DD') TERMN_DT
						,GAM_GET_RENT_TERMN_YN(R.TERMN_DT) TERMN_YN
						,TO_CHAR(D.DETAIL_PD_BEGIN, 'YYYY-MM-DD') DETAIL_PD_BEGIN
						,TO_CHAR(D.DETAIL_PD_END, 'YYYY-MM-DD') DETAIL_PD_END
						,NVL(D.RENT_AR, 0) RENT_AR
						,TO_CHAR(NVL(D.RENT_AR, 0), '9,999,999,999.99') RENT_AR_STR
						,D.RENT_AR_SE RENT_AR_SE
						,DECODE(D.RENT_AR_SE, '1', '물류부지', '2', '제조부지', '3', '숙성실', '') RENT_AR_SE_NM
						,NVL(D.APPLC_RNTFEE, 0) APPLC_RNTFEE
						,TO_CHAR(NVL(D.APPLC_RNTFEE, 0), '9,999,999,999.99') APPLC_RNTFEE_STR
						,D.PRICE_SE PRICE_SE
						,DECODE(D.PRICE_SE, '1', '면적당단가', '2', '월단가','') PRICE_SE_NM
						,NVL(DECODE(F.RNTFEE_SE, '0', D.ASE_RNTFEE, F.APPLC_RNTFEE), 0) ASE_RNTFEE
						,TO_CHAR(NVL(DECODE(F.RNTFEE_SE, '0', D.ASE_RNTFEE, F.APPLC_RNTFEE), 0), '9,999,999,999.99') ASE_RNTFEE_STR
						,TO_CHAR(DECODE(F.RNTFEE_SE, '0', D.ASE_APPLC_BEGIN, F.APPLC_BEGIN_DT), 'YYYY-MM-DD') ASE_APPLC_BEGIN
						,TO_CHAR(DECODE(F.RNTFEE_SE, '0', D.ASE_APPLC_END, F.APPLC_END_DT), 'YYYY-MM-DD') ASE_APPLC_END
						,TO_CHAR(F.NTIC_BEGIN_DT, 'YYYY-MM-DD') NTIC_BEGIN_DT
						,TO_CHAR(F.NTIC_END_DT, 'YYYY-MM-DD') NTIC_END_DT
						,NVL(F.RNTFEE, 0) RNTFEE
						,F.RNTFEE_SE RNTFEE_SE
						,F.RNTFEE_SE_NM RNTFEE_SE_NM
						,NVL(F.PAYINST_INTR, 0) PAYINST_INTR
						,NVL(F.SUP_AMT, 0) SUP_AMT
						,NVL(F.VAT, 0) VAT
						,NVL(F.PAY_AMT, 0) PAY_AMT
						,F.ACCNUT_YEAR ACCNUT_YEAR
						,F.RNTFEE_NTIC_NO RNTFEE_NTIC_NO
						,F.NTIC_SEQ NTIC_SEQ
						,N.NTIC_NO NTIC_NO
	 					,N.PAY_TMLMT PAY_TMLMT
						,N.RCIV_SE RCIV_SE
						,N.RCIV_DT RCIV_DT
						,N.HIST_SEQ
						,N.ARRRG_NO DLY_SER_NO
						,N.NHT_PRT_YN NHT_PRT_YN
						,( SELECT U.DLY_BILL_PRT_YN FROM HTLD_NTIC_DTLS_F A, UNPAID_F U WHERE U.PRT_AT_CODE = '622'
  							AND A.ACCNUT_YEAR = U.FISCAL_YR AND A.NTIC_NO = U.BILL_NO AND GAM_GET_HTLD_ARRRG_CHRGE_KND(A.CHRGE_KND_CD) = U.WORK_CODE
  							AND U.FEE_TP = GAM_GET_HTLD_FEE_TP(GAM_GET_HTLD_ARRRG_CHRGE_KND(A.CHRGE_KND_CD))
  							AND A.ACCNUT_YEAR = N.ACCNUT_YEAR AND A.RNTFEE_NTIC_NO = N.RNTFEE_NTIC_NO AND A.NTIC_SEQ = N.NTIC_SEQ
						) DLY_BILL_PRT_YN
						,F.RM RM
					FROM
						HTLD_RNTFEE_F F
			        INNER JOIN
			          	HTLD_NTIC_DTLS_F N
			          	ON N.ACCNUT_YEAR = F.ACCNUT_YEAR AND N.RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND N.NTIC_SEQ = F.NTIC_SEQ
			          		AND (F.RNTFEE_SE = '0' OR F.RNTFEE_SE = '1' OR F.RNTFEE_SE = '2') AND (N.RCIV_SE = '0' OR N.RCIV_SE = '1')
					LEFT OUTER JOIN
						HTLD_RENT_DETAIL_HIST_F D
						ON D.MNG_YEAR = F.MNG_YEAR AND D.MNG_NO = F.MNG_NO AND D.MNG_SEQ = F.MNG_SEQ AND (D.REGIST_SEQ = F.RENT_DETAIL_REGIST_SEQ) AND D.HIST_SEQ = N.HIST_SEQ
						<isNotEmpty property="histDt" prepend="AND">
							<![CDATA[
								F.NTIC_END_DT < TO_DATE(GAM_GET_QUARTER_START_DATE(#histDt#), 'YYYY-MM-DD')
							]]>
						</isNotEmpty>
					INNER JOIN
						HTLD_RENT_HIST_F R
			            ON D.MNG_YEAR = R.MNG_YEAR AND D.MNG_NO = R.MNG_NO AND D.MNG_SEQ = R.MNG_SEQ AND R.HIST_SEQ = N.HIST_SEQ
      			)
      			UNION ALL
      			(
      				<!--  전분기 또는 전년도 미납 연체 추가정산 자료 조회 -->
					SELECT
						R.MNG_YEAR MNG_YEAR
						,R.MNG_NO MNG_NO
						,R.MNG_SEQ MNG_SEQ
						,'' ASSETS_NM
						,'' ASSETS_CD
						,NULL REGIST_SEQ
						,F.RNTFEE_SEQ RNTFEE_SEQ
						,R.ENTRPS_CD ENTRPS_CD
						,(SELECT E.ENTRPS_NM FROM ENTRPS_INFO_F E WHERE E.ENTRPSCD = R.ENTRPS_CD) ENTRPS_NM
						,R.BOUND_CD BOUND_CD
						,GAM_GETCODENAME('GAM062', R.BOUND_CD) BOUND_NM
						,R.PAY_SE PAY_SE
						,TO_CHAR(R.CTRT_BEGIN_DT, 'YYYY-MM-DD') CTRT_BEGIN_DT
						,TO_CHAR(R.CTRT_END_DT, 'YYYY-MM-DD') CTRT_END_DT
						,GAM_GETCODENAME('GAM008', R.PAY_SE) PAY_SE_NM
						,R.CHRGE_KND_CD CHRGE_KND_CD
						,GAM_GETCODENAME('GAM053', R.CHRGE_KND_CD) CHRGE_KND_NM
						,TO_CHAR(R.TERMN_DT, 'YYYY-MM-DD') TERMN_DT
						,GAM_GET_RENT_TERMN_YN(R.TERMN_DT) TERMN_YN
						,TO_CHAR(R.CTRT_BEGIN_DT, 'YYYY-MM-DD') DETAIL_PD_BEGIN
						,TO_CHAR(R.CTRT_END_DT, 'YYYY-MM-DD') DETAIL_PD_END
						,0 RENT_AR
						,TO_CHAR(0, '9,999,999,999.99') RENT_AR_STR
						,'' RENT_AR_SE
						,'' RENT_AR_SE_NM
						,0 APPLC_RNTFEE
						,TO_CHAR(0, '9,999,999,999.99') APPLC_RNTFEE_STR
						,'' PRICE_SE
						,'' PRICE_SE_NM
						,NVL(F.APPLC_RNTFEE, 0) ASE_RNTFEE
						,TO_CHAR(NVL(F.APPLC_RNTFEE, 0), '9,999,999,999.99') ASE_RNTFEE_STR
						,TO_CHAR(F.APPLC_BEGIN_DT, 'YYYY-MM-DD') ASE_APPLC_BEGIN
						,TO_CHAR(F.APPLC_END_DT, 'YYYY-MM-DD') ASE_APPLC_END
						,TO_CHAR(F.NTIC_BEGIN_DT, 'YYYY-MM-DD') NTIC_BEGIN_DT
						,TO_CHAR(F.NTIC_END_DT, 'YYYY-MM-DD') NTIC_END_DT
						,NVL(F.RNTFEE, 0) RNTFEE
						,F.RNTFEE_SE RNTFEE_SE
						,F.RNTFEE_SE_NM RNTFEE_SE_NM
						,NVL(F.PAYINST_INTR, 0) PAYINST_INTR
						,NVL(F.SUP_AMT, 0) SUP_AMT
						,NVL(F.VAT, 0) VAT
						,NVL(F.PAY_AMT, 0) PAY_AMT
						,F.ACCNUT_YEAR ACCNUT_YEAR
						,F.RNTFEE_NTIC_NO RNTFEE_NTIC_NO
						,F.NTIC_SEQ NTIC_SEQ
						,N.NTIC_NO NTIC_NO
	 					,N.PAY_TMLMT PAY_TMLMT
						,N.RCIV_SE RCIV_SE
						,N.RCIV_DT RCIV_DT
						,N.HIST_SEQ
						,N.ARRRG_NO DLY_SER_NO
						,N.NHT_PRT_YN NHT_PRT_YN
						,( SELECT U.DLY_BILL_PRT_YN FROM HTLD_NTIC_DTLS_F A, UNPAID_F U WHERE U.PRT_AT_CODE = '622'
  							AND A.ACCNUT_YEAR = U.FISCAL_YR AND A.NTIC_NO = U.BILL_NO AND GAM_GET_HTLD_ARRRG_CHRGE_KND(A.CHRGE_KND_CD) = U.WORK_CODE
  							AND U.FEE_TP = GAM_GET_HTLD_FEE_TP(GAM_GET_HTLD_ARRRG_CHRGE_KND(A.CHRGE_KND_CD))
  							AND A.ACCNUT_YEAR = N.ACCNUT_YEAR AND A.RNTFEE_NTIC_NO = N.RNTFEE_NTIC_NO AND A.NTIC_SEQ = N.NTIC_SEQ
						) DLY_BILL_PRT_YN
						,F.RM RM
					FROM
						HTLD_RNTFEE_F F
			        INNER JOIN
			         	HTLD_NTIC_DTLS_F N
			          	ON N.ACCNUT_YEAR = F.ACCNUT_YEAR AND N.RNTFEE_NTIC_NO = F.RNTFEE_NTIC_NO AND N.NTIC_SEQ = F.NTIC_SEQ
			          		AND F.RNTFEE_SE = '3' AND (N.RCIV_SE = '0' OR N.RCIV_SE = '1')
					INNER JOIN
						HTLD_RENT_HIST_F R
			            ON N.MNG_YEAR = R.MNG_YEAR AND N.MNG_NO = R.MNG_NO AND N.MNG_SEQ = R.MNG_SEQ AND R.HIST_SEQ = N.HIST_SEQ
						<isNotEmpty property="histDt" prepend="AND">
							<![CDATA[
			            	F.NTIC_END_DT < TO_DATE(GAM_GET_QUARTER_START_DATE(#histDt#), 'YYYY-MM-DD')
							]]>
						</isNotEmpty>
    			)
			) L
		WHERE 1=1
			<isNotEmpty property="histDt" prepend="AND">
				<![CDATA[
				TO_DATE(L.CTRT_BEGIN_DT) <= TO_DATE(#histDt#, 'YYYY-MM-DD')
				AND TO_DATE(L.CTRT_END_DT) >= TO_DATE(#histDt#, 'YYYY-MM-DD')
				]]>
			</isNotEmpty>
			<isNotEmpty property="paySe" prepend="AND">
				L.PAY_SE = #paySe#
			</isNotEmpty>
			<isNotEmpty property="termnYn" prepend="AND">
				L.TERMN_YN = #termnYn#
			</isNotEmpty>
		ORDER BY
			BOUND_CD, ENTRPS_CD, MNG_YEAR, MNG_NO, MNG_SEQ, ACCNUT_YEAR, RNTFEE_NTIC_NO, NTIC_SEQ, RNTFEE_SE, REGIST_SEQ,  RNTFEE_SEQ
	</select>

	<!-- Cofix 이자율 조회 -->
	<select id="gamHtldRentMngtMainDao.selectCofixIntrrate_S" parameterClass="gamHtldRentMngtMainVO" resultClass="java.lang.String">
		SELECT TO_CHAR(NEW_MANIP_AMT_STDR_INTRRATE * 100, '99.99') COFIX_INTRRATE
		FROM
			COFIX_INTRRATE_F
		WHERE
			<isNotEmpty property="histDt">
				<![CDATA[
				OBJ_YRMT = (SELECT MAX(OBJ_YRMT) FROM COFIX_INTRRATE_F WHERE TO_DATE(TO_CHAR(ANNODT, 'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(GAM_GET_QUARTER_START_DATE(#histDt#), 'YYYY-MM-DD'))
				]]>
			</isNotEmpty>
			<isEmpty property="histDt">
				<![CDATA[
				OBJ_YRMT = (SELECT MAX(OBJ_YRMT) FROM COFIX_INTRRATE_F WHERE TO_DATE(TO_CHAR(ANNODT, 'YYYY-MM-DD'), 'YYYY-MM-DD') <= TO_DATE(GAM_GET_QUARTER_START_DATE(TO_CHAR(SYSDATE, 'YYYY-MM-DD')), 'YYYY-MM-DD'))
				]]>
			</isEmpty>
	</select>

	<!-- 임대료 테이블 등록(일반고지일 경우 가상데이터를 위한 쿼리 -->
	<insert id="gamHtldRentMngtMainDao.insertHtldRntfee_S" parameterClass="gamHtldRentRntfeeVO">
		INSERT INTO HTLD_RNTFEE_F (
			MNG_YEAR
			,MNG_NO
			,MNG_SEQ
			,RNTFEE_SEQ
			,RENT_DETAIL_REGIST_SEQ
			,RNTFEE_SE
			,RNTFEE_SE_NM
			,NTIC_BEGIN_DT
			,NTIC_END_DT
			,RNTFEE
			,PAYINST_INTR
			,SUP_AMT
			,VAT
			,PAY_AMT
			,RM
			,REG_USR
			,REGIST_DT
		) VALUES (
			#mngYear#
			,#mngNo#
			,#mngSeq#
			,#rntfeeSeq#
			,#registSeq#
			,#rntfeeSe#
			,#rntfeeSeNm#
			,TO_DATE(#nticBeginDt#, 'YYYY-MM-DD')
			,TO_DATE(#nticEndDt#, 'YYYY-MM-DD')
			,TO_NUMBER(#rntfee#)
			,TO_NUMBER(#payinstIntr#)
			,TO_NUMBER(#supAmt#)
			,TO_NUMBER(#vat#)
			,TO_NUMBER(#payAmt#)
			,#rm#
			,#regUsr#
			,SYSDATE
		)
	</insert>

	<!-- 임대료 수정(메인화면에서 임대료등을 고치면 자동계산후 갱신) -->
	<update id="gamHtldRentMngtMainDao.updateHtldRntfee_S" parameterClass="gamHtldRentRntfeeVO">
		UPDATE HTLD_RNTFEE_F
		SET
			RNTFEE = TO_NUMBER(#rntfee#)
			,PAYINST_INTR = TO_NUMBER(#payinstIntr#)
			,SUP_AMT = TO_NUMBER(#supAmt#)
			,VAT = TO_NUMBER(#vat#)
			,PAY_AMT = TO_NUMBER(#payAmt#)
			,RM = #rm#
			,UPD_USR = #updUsr#
			,UPDT_DT = SYSDATE
		WHERE
			MNG_YEAR = #mngYear#
			AND MNG_NO = #mngNo#
			AND MNG_SEQ = #mngSeq#
			AND RNTFEE_SEQ = #rntfeeSeq#
	</update>

		<!-- 배후단지 임대료 순번 생성 -->
	<select id="gamHtldRentMngtMainDao.selectNextRntfeeSeq_S" parameterClass="gamHtldRentRntfeeVO" resultClass="java.lang.String">
   		SELECT
   		  	LPAD(NVL(MAX(RNTFEE_SEQ),0) + 1,'3','0')
   		FROM
   		  	HTLD_RNTFEE_F
   		WHERE
			MNG_YEAR=#mngYear#
			AND MNG_NO=#mngNo#
			AND MNG_SEQ=#mngSeq#
	</select>


	<select id="gamHtldRentMngtMainDao.deleteHtldRentList" resultClass="egovMap">
		SELECT MNG_YEAR AS S_MNG_YEAR, MNG_NO AS S_MNG_NO, MNG_SEQ AS S_MNG_SEQ
		  FROM HTLD_RENT_F
		 WHERE CTRT_BEGIN_DT >= TO_DATE(TO_CHAR(SYSDATE,'YYYY')||'0101')

	</select>
	<delete id="gamHtldRentMngtMainDao.deleteHtldRentData" parameterClass="egovMap">
		DELETE FROM HTLD_RENT_F
		 WHERE MNG_YEAR = #sMngYear#
		   AND MNG_NO = #sMngNo#
		   AND MNG_SEQ = #sMngSeq#

	</delete>

	<delete id="gamHtldRentMngtMainDao.deleteHtldRentDetailData" parameterClass="egovMap">
		DELETE FROM HTLD_RENT_DETAIL_F
		 WHERE MNG_YEAR = #sMngYear#
		   AND MNG_NO = #sMngNo#
		   AND MNG_SEQ = #sMngSeq#

	</delete>

	<insert id="gamHtldRentMngtMainDao.inserHtldRentData" parameterClass="egovMap">
		<selectKey keyProperty="mngSeq" resultClass="java.lang.String">
			SELECT TO_CHAR(NVL(MAX(TO_NUMBER(MNG_SEQ)),0)+1, '09') AS MNG_SEQ FROM HTLD_RENT_F WHERE MNG_YEAR = #sMngYear# AND MNG_NO = #sMngNo#
		</selectKey>
		INSERT INTO HTLD_RENT_F (
								  MNG_YEAR
								  ,MNG_NO
								  ,MNG_SEQ
								  ,ENTRPS_CD
								  ,BOUND_CD
								  ,CHRGE_KND_CD
								  ,GR_RENT_AR
								  ,PAY_SE
								  ,CTRT_BEGIN_DT
								  ,CTRT_END_DT
								  ,CTRT_DT
								  ,REG_USR
								  ,REGIST_DT
								  ,UPD_USR
								  ,UPDT_DT
								)

							SELECT 	MNG_YEAR
									,MNG_NO
									,#mngSeq#
									,ENTRPS_CD
									,BOUND_CD
									,CHRGE_KND_CD
									,GR_RENT_AR
									,PAY_SE
									,CTRT_BEGIN_DT+(INTERVAL '3' YEAR)
									,CTRT_END_DT+(INTERVAL '3' YEAR)
									,CTRT_DT+(INTERVAL '3' YEAR)
									,REG_USR
									,SYSDATE
									,UPD_USR
									,SYSDATE
							  FROM HTLD_RENT_F
							 WHERE 	MNG_YEAR = #sMngYear#
							   AND MNG_NO = #sMngNo#
							   AND MNG_SEQ = #sMngSeq#


	</insert>

	<insert id="gamHtldRentMngtMainDao.inserHtldRentDetailData" >
		INSERT INTO HTLD_RENT_DETAIL_F (
										  MNG_YEAR
										  ,MNG_NO
										  ,MNG_SEQ
										  ,REGIST_SEQ
										  ,GIS_ASSETS_PRT_AT_CODE
										  ,GIS_ASSETS_CD
										  ,GIS_ASSETS_SUB_CD
										  ,DETAIL_PD_BEGIN
										  ,DETAIL_PD_END
										  ,RENT_AR
										  ,RENT_AR_SE
										  ,APPLC_RNTFEE
										  ,ASSETS_NM
										  ,PRICE_SE
										  ,RM
										  ,REG_USR
										  ,REGIST_DT
										  ,UPD_USR
										  ,UPDT_DT
										)

									SELECT MNG_YEAR
											,MNG_NO
											,#mngSeq#
											,REGIST_SEQ
											,GIS_ASSETS_PRT_AT_CODE
											,GIS_ASSETS_CD
											,GIS_ASSETS_SUB_CD
											,DETAIL_PD_BEGIN+(INTERVAL '1' YEAR)
											,DETAIL_PD_END+(INTERVAL '1' YEAR)
											,RENT_AR
											,RENT_AR_SE
											,APPLC_RNTFEE
											,ASSETS_NM
											,PRICE_SE
											,RM
											,REG_USR
											,sysdate
											,UPD_USR
											,sysdate
									  FROM HTLD_RENT_DETAIL_F
									 WHERE 	MNG_YEAR = #sMngYear#
									   AND MNG_NO = #sMngNo#
									   AND MNG_SEQ = #sMngSeq#

	</insert>

	<!-- 물동량 조회 -->
	<select id="gamHtldRentMngtMainDao.selectHtldQuGtqyList" parameterClass="gamHtldQuGtqyVO" resultClass="egovMap">
		SELECT YEAR
				, ONE_QU_GNRL
				, ONE_QU_CNTANR
				, TWO_QU_GNRL
				, TWO_QU_CNTANR
				, THREE_QU_GNRL
				, THREE_QU_CNTANR
				, FOUR_GNRL
				, FOUR_QU_CNTANR
		  FROM HTLD_QU_GTQY
		 ORDER BY YEAR DESC
	</select>

	<delete id="gamHtldRentMngtMainDao.deleteHtldQuGtqyList">
		<![CDATA[
			DELETE FROM HTLD_QU_GTQY
			 WHERE YEAr = #year#
		]]>
	</delete>

	<update id="gamHtldRentMngtMainDao.updateHtldQuGtqyList">
		<![CDATA[
			UPDATE HTLD_QU_GTQY SET   ONE_QU_GNRL = #oneQuGnrl#
									, ONE_QU_CNTANR = #oneQuCntanr#
									, TWO_QU_GNRL = #twoQuGnrl#
									, TWO_QU_CNTANR = #twoQuCntanr#
									, THREE_QU_GNRL = #threeQuGnrl#
									, THREE_QU_CNTANR = #threeQuCntanr#
									, FOUR_GNRL = #fourGnrl#
									, FOUR_QU_CNTANR = #fourQuCntanr#
									, UPDUSR = #updusr#
									, UPDDE = sysdate
			 WHERE  YEAR = #year#
		]]>
	</update>

	<insert id="gamHtldRentMngtMainDao.insertHtldQuGtqyList">
		<![CDATA[
			INSERT INTO HTLD_QU_GTQY( YEAR
									, ONE_QU_GNRL
									, ONE_QU_CNTANR
									, TWO_QU_GNRL
									, TWO_QU_CNTANR
									, THREE_QU_GNRL
									, THREE_QU_CNTANR
									, FOUR_GNRL
									, FOUR_QU_CNTANR
									, REGISTER
									, RGSDE
									)
			 VALUES	( #year#
					, #oneQuGnrl#
					, #oneQuCntanr#
					, #twoQuGnrl#
					, #twoQuCntanr#
					, #threeQuGnrl#
					, #threeQuCntanr#
					, #fourGnrl#
					, #fourQuCntanr#
					, #register#
					, #rgsde#
					)
		]]>
	</insert>

	<!-- 계약 복사 쿼리 -->
	<insert id="gamHtldRentMngtMainDao.insertHtldCopyCtrt">
		<![CDATA[
			INSERT INTO HTLD_RENT_HIST_F (
			ENTRPS_CD, BOUND_CD, CTRT_BEGIN_DT, CTRT_END_DT, GR_RENT_AR, PAY_SE, CTRT_DT, REG_USR, REGIST_DT,
			UPD_USR, UPDT_DT, MNG_YEAR, MNG_NO, MNG_SEQ, HIST_SEQ, TERMN_DT, TERMN_RSN, CHRGE_KND_CD, HIST_DT
			)
			SELECT ENTRPS_CD, BOUND_CD, NEW_CTRT_BEGIN_DT, NEW_CTRT_BEGIN_DT+PERIOD_DT NEW_CTRT_END_DT, GR_RENT_AR, PAY_SE, CTRT_DT, REG_USR, REGIST_DT,
			'TEST1', SYSDATE, MNG_YEAR, MNG_NO, LPAD(MNG_SEQ+1, 2,'0'), '0001', TERMN_DT, TERMN_RSN, CHRGE_KND_CD, HIST_DT
			FROM (
			SELECT R.ENTRPS_CD, R.BOUND_CD,
			TO_DATE((#mngYear#+1)||'-01-01', 'YYYY-MM-DD') NEW_CTRT_BEGIN_DT,
			R.CTRT_BEGIN_DT, R.CTRT_END_DT, R.CTRT_END_DT-R.CTRT_BEGIN_DT PERIOD_DT,
			R.GR_RENT_AR, R.PAY_SE, R.CTRT_DT, R.REG_USR, R.REGIST_DT,
			R.UPD_USR, R.UPDT_DT, R.MNG_YEAR, R.MNG_NO, R.MNG_SEQ, R.HIST_SEQ, R.TERMN_DT, R.TERMN_RSN, R.CHRGE_KND_CD, R.HIST_DT
			FROM HTLD_RENT_HIST_F R
			WHERE 1=1
			    AND TO_DATE(#mngYear#||'-12-31', 'YYYY-MM-DD') BETWEEN R.CTRT_BEGIN_DT AND R.CTRT_END_DT
			    AND R.TERMN_DT IS NULL
			    AND R.CTRT_END_DT < TO_DATE((#mngYear#+1)||'-01-01', 'YYYY-MM-DD')
			    AND R.HIST_SEQ='0001'
			ORDER BY
			    R.BOUND_CD, R.ENTRPS_CD, R.MNG_YEAR, R.MNG_NO, R.MNG_SEQ
			)
		]]>
	</insert>

	<!-- 계약 상세 복사 쿼리 -->
	<insert id="gamHtldRentMngtMainDao.insertHtldCopyCtrtDtls">
		<![CDATA[
			INSERT INTO HTLD_RENT_DETAIL_HIST_F (
			REGIST_SEQ, RENT_AR, APPLC_RNTFEE, ASE_RNTFEE, ASE_APPLC_BEGIN, ASE_APPLC_END, APPLC_RSN, REG_USR, REGIST_DT, UPD_USR, RM, PRICE_SE,
			MNG_YEAR, MNG_NO, MNG_SEQ, GIS_ASSETS_CD, GIS_ASSETS_SUB_CD, ASSETS_NM, HIST_SEQ, RENT_AR_SE,
			DETAIL_PD_BEGIN, DETAIL_PD_END, GIS_ASSETS_PRT_AT_CODE, HIST_DT
			)
			SELECT
			REGIST_SEQ, RENT_AR, APPLC_RNTFEE, ASE_RNTFEE, ASE_APPLC_BEGIN, ASE_APPLC_END, APPLC_RSN, REG_USR, REGIST_DT, 'TEST1', RM, PRICE_SE,
			MNG_YEAR, MNG_NO, LPAD(MNG_SEQ+1, 2,'0'), GIS_ASSETS_CD, GIS_ASSETS_SUB_CD, ASSETS_NM, HIST_SEQ, RENT_AR_SE,
			NEW_DETAIL_PD_BEGIN, NEW_DETAIL_PD_BEGIN+PERIOD_DAY NEW_DETAIL_PD_END, GIS_ASSETS_PRT_AT_CODE, HIST_DT
			FROM
			(
			SELECT D.REGIST_SEQ, D.RENT_AR, D.APPLC_RNTFEE, D.ASE_RNTFEE, D.ASE_APPLC_BEGIN, D.ASE_APPLC_END, D.APPLC_RSN, D.REG_USR, D.REGIST_DT, D.UPD_USR, D.RM, D.PRICE_SE,
			D.MNG_YEAR, D.MNG_NO, D.MNG_SEQ, D.GIS_ASSETS_CD, D.GIS_ASSETS_SUB_CD, D.ASSETS_NM, D.HIST_SEQ, D.RENT_AR_SE,
			TO_DATE((#mngYear#+1)||'-01-01', 'YYYY-MM-DD') NEW_DETAIL_PD_BEGIN, D.DETAIL_PD_END-D.DETAIL_PD_BEGIN PERIOD_DAY, D.DETAIL_PD_BEGIN, D.DETAIL_PD_END, D.GIS_ASSETS_PRT_AT_CODE, D.HIST_DT
			FROM HTLD_RENT_HIST_F R, HTLD_RENT_DETAIL_HIST_F D
			WHERE 1=1
			    AND TO_DATE(#mngYear#||'-12-31', 'YYYY-MM-DD') BETWEEN R.CTRT_BEGIN_DT AND R.CTRT_END_DT
			    AND TERMN_DT IS NULL
			    AND R.CTRT_END_DT < TO_DATE((#mngYear#+1)||'-01-01', 'YYYY-MM-DD')
			    AND R.MNG_YEAR=D.MNG_YEAR
			    AND R.MNG_NO=D.MNG_NO
			    AND R.MNG_SEQ=D.MNG_SEQ
			    AND R.MNG_YEAR=D.MNG_YEAR
			    AND R.HIST_SEQ=D.HIST_SEQ
			    AND R.HIST_SEQ='0001'
			ORDER BY
			    R.BOUND_CD, R.ENTRPS_CD, R.MNG_YEAR, R.MNG_NO, R.MNG_SEQ
			)
		]]>
	</insert>

	<!-- 계약 복사시 기존 고지 데이터 삭제 -->
	<delete id="gamHtldRentMngtMainDao.deleteHtldCopyCtrtNticDtls">
		<![CDATA[
			DELETE FROM HTLD_NTIC_DTLS_F F
			WHERE (F.MNG_YEAR, F.MNG_NO, F.MNG_SEQ) IN (
			    SELECT MNG_YEAR, MNG_NO, MNG_SEQ
			    FROM (
			    SELECT MNG_YEAR, MNG_NO, LPAD(MNG_SEQ+1, 2,'0') MNG_SEQ
			    FROM (
			        SELECT R.MNG_YEAR, R.MNG_NO, R.MNG_SEQ
			        FROM HTLD_RENT_HIST_F R
			        WHERE 1=1
			            AND TO_DATE(#mngYear#||'-12-31', 'YYYY-MM-DD') BETWEEN R.CTRT_BEGIN_DT AND R.CTRT_END_DT
			            AND R.TERMN_DT IS NULL
			            AND R.CTRT_END_DT < TO_DATE((#mngYear#+1)||'-01-01', 'YYYY-MM-DD')
			            AND R.HIST_SEQ='0001'
			        ORDER BY
			            R.MNG_YEAR, R.MNG_NO, R.MNG_SEQ
			        )
			    )
			)
		]]>
	</delete>

	<!-- 계약 복사시 기존 요금 데이터 삭제 -->
	<delete id="gamHtldRentMngtMainDao.deleteHtldCopyCtrtRntfee">
		<![CDATA[
			DELETE FROM HTLD_RNTFEE_F F
			WHERE (F.MNG_YEAR, F.MNG_NO, F.MNG_SEQ) IN (
			    SELECT MNG_YEAR, MNG_NO, MNG_SEQ
			    FROM (
			    SELECT MNG_YEAR, MNG_NO, LPAD(MNG_SEQ+1, 2,'0') MNG_SEQ
			    FROM (
			        SELECT R.MNG_YEAR, R.MNG_NO, R.MNG_SEQ
			        FROM HTLD_RENT_HIST_F R
			        WHERE 1=1
			            AND TO_DATE(#mngYear#||'-12-31', 'YYYY-MM-DD') BETWEEN R.CTRT_BEGIN_DT AND R.CTRT_END_DT
			            AND R.TERMN_DT IS NULL
			            AND R.CTRT_END_DT < TO_DATE((#mngYear#+1)||'-01-01', 'YYYY-MM-DD')
			            AND R.HIST_SEQ='0001'
			        ORDER BY
			            R.MNG_YEAR, R.MNG_NO, R.MNG_SEQ
			        )
			    )
			)
		]]>
	</delete>

	<!-- 계약 복사시 기존 상세 데이터 삭제 -->
	<delete id="gamHtldRentMngtMainDao.deleteHtldCopyCtrtDtls">
		<![CDATA[
			DELETE FROM HTLD_RENT_DETAIL_HIST_F F
			WHERE (F.MNG_YEAR, F.MNG_NO, F.MNG_SEQ) IN (
			    SELECT MNG_YEAR, MNG_NO, MNG_SEQ
			    FROM (
			    SELECT MNG_YEAR, MNG_NO, LPAD(MNG_SEQ+1, 2,'0') MNG_SEQ
			    FROM (
			        SELECT R.MNG_YEAR, R.MNG_NO, R.MNG_SEQ
			        FROM HTLD_RENT_HIST_F R
			        WHERE 1=1
			            AND TO_DATE(#mngYear#||'-12-31', 'YYYY-MM-DD') BETWEEN R.CTRT_BEGIN_DT AND R.CTRT_END_DT
			            AND R.TERMN_DT IS NULL
			            AND R.CTRT_END_DT < TO_DATE((#mngYear#+1)||'-01-01', 'YYYY-MM-DD')
			            AND R.HIST_SEQ='0001'
			        ORDER BY
			            R.MNG_YEAR, R.MNG_NO, R.MNG_SEQ
			        )
			    )
			)
		]]>
	</delete>

	<!-- 계약 복사시 기존 계약 데이터 삭제 -->
	<delete id="gamHtldRentMngtMainDao.deleteHtldCopyCtrtMst">
		<![CDATA[
			DELETE FROM HTLD_RENT_HIST_F F
			WHERE (F.MNG_YEAR, F.MNG_NO, F.MNG_SEQ) IN (
			    SELECT MNG_YEAR, MNG_NO, MNG_SEQ
			    FROM (
			    SELECT MNG_YEAR, MNG_NO, LPAD(MNG_SEQ+1, 2,'0') MNG_SEQ
			    FROM (
			        SELECT R.MNG_YEAR, R.MNG_NO, R.MNG_SEQ
			        FROM HTLD_RENT_HIST_F R
			        WHERE 1=1
			            AND TO_DATE(#mngYear#||'-12-31', 'YYYY-MM-DD') BETWEEN R.CTRT_BEGIN_DT AND R.CTRT_END_DT
			            AND R.TERMN_DT IS NULL
			            AND R.CTRT_END_DT < TO_DATE((#mngYear#+1)||'-01-01', 'YYYY-MM-DD')
			            AND R.HIST_SEQ='0001'
			        ORDER BY
			            R.MNG_YEAR, R.MNG_NO, R.MNG_SEQ
			        )
			    )
			)
		]]>
	</delete>



</sqlMap>