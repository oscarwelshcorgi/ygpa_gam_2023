<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="ygpa.gam.oper.center">

    <typeAlias alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
    <typeAlias alias="hashMap" type="java.util.HashMap"/>
    <typeAlias alias="gamMarineCenterRentStairStsReportVO" type="egovframework.rte.ygpa.gam.oper.center.service.GamMarineCenterRentStairStsReportVO"/>
    
    <select id="gamMarineCenterRentStairStsReportDao.selectMarineCenterRentStairStsReportList_D" parameterClass="gamMarineCenterRentStairStsReportVO" resultClass="egovMap">
        SELECT A.*
           FROM (
                   SELECT  ROWNUM RNUM, S.*
                     FROM (
							SELECT
							      USAGE_YEAR
							    , USAGE_QU
							    , USAGE_MT
							    , ASSETS_USAGE_SEQ
							    , MNG_YEAR
							    , MNG_NO
							    , MNG_CNT
							    , PRT_AT_CODE
							    , USAGE_PRPOS_CD
							    , REQST_ENTRPS_CD
							    , ( SELECT E.ENTRPS_NM FROM ENTRPS_INFO_F E WHERE E.ENTRPSCD = REQST_ENTRPS_CD AND ROWNUM = 1 ) REQST_ENTRPS_CD_NM
							    , USAGE_CND
							    , EXEMPT_SE
							    , NVL(FEE,0) FEE
							    , NVL(RDCXPT_FEE,0) RDCXPT_FEE
							    , UPD_USR
							    , TO_CHAR(UPDT_DT, 'YYYY-MM-DD') UPDT_DT 
							    , TO_CHAR(USAGE_PD_FROM, 'YYYY-MM-DD') USAGE_PD_FROM
							    , TO_CHAR(USAGE_PD_TO, 'YYYY-MM-DD') USAGE_PD_TO
							    , GIS_ASSETS_CD
							    , GIS_ASSETS_SUB_CD
							    , QUAY_CD
							FROM USAGE_PD_BY_STATS_F
							WHERE 1 = 1
					
							<isNotEmpty property="sPrtAtCode">
					            AND PRT_AT_CODE = #sPrtAtCode#  
					        </isNotEmpty>
					        
					        <isNotEmpty property="sEntrpscd">
					            AND REQST_ENTRPS_CD = #sEntrpscd#  
					        </isNotEmpty>
					        
					        <isNotEmpty property="sGrUsagePdFrom"> 
					            AND USAGE_PD_FROM <![CDATA[>=]]> TO_DATE(#sGrUsagePdFrom#||'000000','yyyy-mm-ddhh24miss')
					        </isNotEmpty>
					        
					        <isNotEmpty property="sGrUsagePdTo">
					            AND USAGE_PD_TO <![CDATA[<=]]> TO_DATE(#sGrUsagePdTo#||'235959','yyyy-mm-ddhh24miss')
					        </isNotEmpty>
							<!-- GROUP BY USAGE_YEAR, USAGE_MT __Query Change!!!__ -->
							                    
							ORDER BY USAGE_YEAR, USAGE_MT DESC
                        ) S
             ) A
        <![CDATA[ WHERE ROWNUM <= #recordCountPerPage# and RNUM > #firstIndex# ]]>
    </select>
    
    <select id="gamMarineCenterRentStairStsReportDao.selectMarineCenterRentStairStsReportListTotCnt_S" parameterClass="gamMarineCenterRentStairStsReportVO" resultClass="int">
            SELECT COUNT(*) totcnt
              FROM USAGE_PD_BY_STATS_F
              WHERE 1 = 1
              
              <isNotEmpty property="sPrtAtCode">
                  AND PRT_AT_CODE = #sPrtAtCode#  
              </isNotEmpty>
              
              <isNotEmpty property="sEntrpscd">
                  AND REQST_ENTRPS_CD = #sEntrpscd#  
              </isNotEmpty>
              
              <isNotEmpty property="sGrUsagePdFrom"> 
                  AND USAGE_PD_FROM <![CDATA[>=]]> TO_DATE(#sGrUsagePdFrom#||'000000','yyyy-mm-ddhh24miss')
              </isNotEmpty>
              
              <isNotEmpty property="sGrUsagePdTo">
                  AND USAGE_PD_TO <![CDATA[<=]]> TO_DATE(#sGrUsagePdTo#||'235959','yyyy-mm-ddhh24miss')
              </isNotEmpty>
              <!-- GROUP BY USAGE_YEAR, USAGE_MT __Query Change!!!__ -->
                                  
              ORDER BY USAGE_YEAR, USAGE_MT DESC
    </select>
    
</sqlMap>
