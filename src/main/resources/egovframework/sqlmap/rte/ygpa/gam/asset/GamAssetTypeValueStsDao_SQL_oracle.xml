<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="ygpa.gam.asset">

    <typeAlias alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
    <typeAlias alias="hashMap" type="java.util.HashMap"/>
    <typeAlias alias="gamAssetTypeValueStsVO" type="egovframework.rte.ygpa.gam.asset.service.GamAssetTypeValueStsVO"/>
    
    <select id="gamAssetTypeValueStsDao.selectAssetTypeValueStsList_D" parameterClass="gamAssetTypeValueStsVO" resultClass="egovMap">
        SELECT A.*
           FROM (
                   SELECT  ROWNUM RNUM, S.*
                     FROM (
							SELECT 
							        B.DEPRCTN_YEAR          
							       ,B.ASSET_CLS     
							       ,B.ASSET_NO          
							       ,B.ASSET_NO_SEQ          
							       ,NVL(B.REVAL_AMT,0) REVAL_AMT
							       ,NVL(B.THIS_TERM_INCRE_AMT,0) THIS_TERM_INCRE_AMT 
							       ,NVL(B.BS_THIS_CUR_AMT,0) BS_THIS_CUR_AMT  
							       ,NVL(B.BS_PRE_DEPRCTN_SUM,0)  BS_PRE_DEPRCTN_SUM      
							       ,NVL(B.BS_NO_DEPRCTN_BAL,0) BS_NO_DEPRCTN_BAL        
							       ,NVL(B.PRE_END_ASSET_BUY_SUM,0) PRE_END_ASSET_BUY_SUM    
							       ,NVL(B.ASSET_BUY_AMT,0) ASSET_BUY_AMT        
							       ,NVL(B.GNRL_DEPRCTN_RATE,0) GNRL_DEPRCTN_RATE        
							       ,NVL(B.THIS_TERM_DEPRCTN_AMT,0) THIS_TERM_DEPRCTN_AMT    
							       ,NVL(B.CUR_AMT,0) CUR_AMT   
							       ,A.GIS_ASSETS_INVSTMNT_MTHD
							       ,A.GIS_ASSETS_SE_CD
							       ,(SELECT CD.CODE_NM FROM COMTCCMMNDETAILCODE CD WHERE CD.CODE_ID = 'GAM003' AND CD.CODE = A.GIS_ASSETS_SE_CD AND ROWNUM = 1) GIS_ASSETS_SE_CD_NM
							  FROM GIS_ASSETS_CD_F A,
							       YGPAERP.EGMFA2000 B
							 WHERE A.ERP_ASSETS_CLS    = B.ASSET_CLS
							   AND A.ERP_ASSETS_NO     = B.ASSET_NO
							   AND A.ERP_ASSETS_NO_SEQ = B.ASSET_NO_SEQ
					
							<isNotEmpty property="sDeprctnYear">
					            AND B.DEPRCTN_YEAR = #sDeprctnYear#  
					        </isNotEmpty>
                    
							ORDER BY B.DEPRCTN_YEAR DESC
                        ) S
             ) A
        <![CDATA[ WHERE ROWNUM <= #recordCountPerPage# and RNUM > #firstIndex# ]]>
    </select>
    
    <select id="gamAssetTypeValueStsDao.selectAssetTypeValueStsListTotCnt_S" parameterClass="gamAssetTypeValueStsVO" resultClass="int">
            SELECT COUNT(*) totcnt
              FROM GIS_ASSETS_CD_F A,
                   YGPAERP.EGMFA2000 B
             WHERE A.ERP_ASSETS_CLS    = B.ASSET_CLS
               AND A.ERP_ASSETS_NO     = B.ASSET_NO
               AND A.ERP_ASSETS_NO_SEQ = B.ASSET_NO_SEQ
    
            <isNotEmpty property="sDeprctnYear">
                AND B.DEPRCTN_YEAR = #sDeprctnYear#  
            </isNotEmpty>
    </select>
    
</sqlMap>
