<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="ygpa.gam.oper.gnrl">

	<typeAlias alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
    <typeAlias alias="hashMap" type="java.util.HashMap"/>
    <typeAlias alias="gamPrtFcltyRentMngtVO" type="egovframework.rte.ygpa.gam.oper.gnrl.service.GamPrtFcltyRentMngtVO"/>
    <typeAlias alias="gamPrtFcltyRentMngtDetailVO" type="egovframework.rte.ygpa.gam.oper.gnrl.service.GamPrtFcltyRentMngtDetailVO"/>
    <typeAlias alias="gamPrtFcltyRentMngtLevReqestVO" type="egovframework.rte.ygpa.gam.oper.gnrl.service.GamPrtFcltyRentMngtLevReqestVO"/>
    
    <resultMap id="gamPrtFcltyRentMngtSumMap" class="egovframework.rte.ygpa.gam.oper.gnrl.service.GamPrtFcltyRentMngtVO">
        <result property="sumCnt" column="SUM_CNT" columnIndex="1"/>
        <result property="sumGrAr" column="SUM_GR_AR" columnIndex="2"/>
        <result property="sumGrFee" column="SUM_GR_FEE" columnIndex="3"/>
    </resultMap>
    
    <resultMap id="gamPrtFcltyRentMngtMaxMngMap" class="egovframework.rte.ygpa.gam.oper.gnrl.service.GamPrtFcltyRentMngtVO">
        <result property="maxMngCnt" column="MAX_MNG_CNT" columnIndex="1"/>
    </resultMap>
    
    <resultMap id="gamPrtFcltyRentMngtInfoMap" class="egovframework.rte.ygpa.gam.oper.gnrl.service.GamPrtFcltyRentMngtVO">
	    <result property="prtAtCode" column="PRT_AT_CODE" columnIndex="1"/>         
	    <result property="mngYear" column="MNG_YEAR" columnIndex="2"/>        
	    <result property="mngNo" column="MNG_NO" columnIndex="3"/>          
	    <result property="mngCnt" column="MNG_CNT" columnIndex="4"/>         
	    <result property="entrpscd" column="ENTRPSCD" columnIndex="5"/>         
	    <result property="entrpsNm" column="ENTRPS_NM" columnIndex="6"/>          
	    <result property="dt" column="DT" columnIndex="7"/>              
	    <result property="reqstSeCd" column="REQST_SE_CD" columnIndex="8"/>        
	    <result property="grAr" column="GR_AR" columnIndex="9"/>           
	    <result property="grFee" column="GR_FEE" columnIndex="10"/>          
	    <result property="nticMth" column="NTIC_MTH" columnIndex="11"/>         
	    <result property="frstPrmisnDt" column="FRST_PRMISN_DT" columnIndex="12"/>         
	    <result property="prmisnDt" column="PRMISN_DT" columnIndex="13"/>          
	    <result property="prmisnYn" column="PRMISN_YN" columnIndex="14"/>         
	    <result property="grUsagePdFrom" column="GR_USAGE_PD_FROM" columnIndex="15"/>         
	    <result property="grUsagePdTo" column="GR_USAGE_PD_TO" columnIndex="16"/>         
	    <result property="docNo" column="DOC_NO" columnIndex="17"/>          
	    <result property="rm" column="RM" columnIndex="18"/>              
	    <result property="cmt" column="CMT" columnIndex="19"/>             
	    <result property="etc" column="ETC" columnIndex="20"/>             
	    <result property="regUsr" column="REG_USR" columnIndex="21"/>         
	    <result property="registDt" column="REGIST_DT" columnIndex="22"/>         
	    <result property="updUsr" column="UPD_USR" columnIndex="23"/>         
	    <result property="updtDt" column="UPDT_DT" columnIndex="24"/>         
	    <result property="grRdcxptFee" column="GR_RDCXPT_FEE" columnIndex="25"/>         
	    <result property="gisCd" column="GIS_CD" columnIndex="26"/>          
	    <result property="deptcd" column="DEPTCD" columnIndex="27"/>
	</resultMap>
    
    <select id="gamPrtFcltyRentMngtDao.selectPrtFcltyRentMngtList_D" parameterClass="gamPrtFcltyRentMngtVO" resultClass="egovMap">
           SELECT A.*
           FROM (
                   SELECT  ROWNUM RNUM, S.*
                     FROM (
                           SELECT 
                                    A.PRT_AT_CODE
                                  , ( SELECT CD.CODE_NM FROM COMTCCMMNDETAILCODE CD WHERE CD.USE_AT = 'Y' AND CODE_ID = 'GAM019' AND CD.CODE = A.PRT_AT_CODE ) PRT_AT_CODE_NM    
                                  , A.MNG_YEAR
                                  , A.MNG_NO
                                  , A.MNG_CNT
                                  , A.MNG_YEAR || '-' || A.MNG_NO || '-' || A.MNG_CNT AS RENT_MNG_NO
                                  , A.ENTRPSCD
                                  , ( SELECT E.ENTRPS_NM FROM ENTRPS_INFO_F E WHERE E.ENTRPSCD = A.ENTRPSCD AND ROWNUM = 1 ) ENTRPS_NM 
                                  , TO_CHAR(A.DT, 'YYYY-MM-DD') DT
                                  , A.REQST_SE_CD
                                  , A.GR_AR
                                  , A.GR_FEE
                                  , A.NTIC_MTH
                                  , ( SELECT CD.CODE_NM FROM COMTCCMMNDETAILCODE CD WHERE CD.USE_AT = 'Y' AND CODE_ID = 'GAM008' AND CD.CODE = A.NTIC_MTH ) NTIC_MTH_NM 
                                  , TO_CHAR(TO_DATE(A.FRST_PRMISN_DT), 'YYYY-MM-DD') FRST_PRMISN_DT
                                  , TO_CHAR(TO_DATE(A.PRMISN_DT), 'YYYY-MM-DD') PRMISN_DT
                                  , A.PRMISN_YN
                                  , TO_CHAR(TO_DATE(A.GR_USAGE_PD_FROM), 'YYYY-MM-DD') GR_USAGE_PD_FROM 
                                  , TO_CHAR(TO_DATE(A.GR_USAGE_PD_TO), 'YYYY-MM-DD') GR_USAGE_PD_TO
                                  , A.DOC_NO
                                  , A.RM
                                  , A.CMT
                                  , A.ETC
                                  , A.REG_USR
                                  , TO_CHAR(A.REGIST_DT, 'YYYY-MM-DD') REGIST_DT 
                                  , A.UPD_USR
                                  , TO_CHAR(A.UPDT_DT, 'YYYY-MM-DD') UPDT_DT 
                                  , A.GR_RDCXPT_FEE
                                  , A.GIS_CD
                                  , A.DEPTCD
                             FROM ASSETS_RENT_F A
                            WHERE 1=1 
                            
                             <isNotEmpty property="sPrtAtCode">
					             AND A.PRT_AT_CODE = #sPrtAtCode#  
					         </isNotEmpty>
					         
					         <isNotEmpty property="sReqstSeCd">
					             AND A.REQST_SE_CD = #sReqstSeCd#  
					         </isNotEmpty>
					         
					         <isNotEmpty property="sEntrpscd">
					             AND A.ENTRPSCD = #sEntrpscd#  
					         </isNotEmpty>
					         
					         <isNotEmpty property="sGrUsagePdFrom"> 
					             AND A.GR_USAGE_PD_FROM <![CDATA[>=]]> REPLACE(#sGrUsagePdFrom#,'-','')    
					         </isNotEmpty>
					         
					         <isNotEmpty property="sGrUsagePdTo">
					             AND A.GR_USAGE_PD_TO <![CDATA[<=]]> REPLACE(#sGrUsagePdTo#,'-','')
					         </isNotEmpty>
					         
					         <isNotEmpty property="sGrAr">
					             AND A.GR_AR = #sGrAr#
					         </isNotEmpty>
					         
					         <isNotEmpty property="sMngYear">
					             AND A.MNG_YEAR = #sMngYear#
					         </isNotEmpty>
					         
					         <isNotEmpty property="sMngNo">
					             AND A.MNG_NO = #sMngNo#
					         </isNotEmpty>
					         
					         <isNotEmpty property="sMngCnt">
					             AND A.MNG_CNT = #sMngCnt#
					         </isNotEmpty>
					         
					         <isNotEmpty property="sPrmisnYn">
					             AND A.PRMISN_YN = #sPrmisnYn#
					         </isNotEmpty>
                             
                             <isNotEmpty property="sUsagePrposCd">
                                 AND (
								       (PRT_AT_CODE, MNG_YEAR, MNG_NO, MNG_CNT) IN (
															                         SELECT  PRT_AT_CODE
															                               , MNG_YEAR
															                               , MNG_NO
															                               , MNG_CNT 
															                           FROM ASSETS_RENT_DETAIL_F
															                          WHERE USAGE_PRPOS_CD = #sUsagePrposCd#
															                       )
								     ) 
                             </isNotEmpty>
                             
                             ORDER BY REGIST_DT DESC
                ) S
             ) A
        <![CDATA[ WHERE ROWNUM <= #recordCountPerPage# and RNUM > #firstIndex# ]]>
    </select>
    
    <select id="gamPrtFcltyRentMngtDao.selectPrtFcltyRentMngtListTotCnt_S" parameterClass="gamPrtFcltyRentMngtVO" resultClass="int">
            SELECT COUNT(*) totcnt
              FROM ASSETS_RENT_F A
             WHERE 1=1
              
             <isNotEmpty property="sPrtAtCode">
                 AND A.PRT_AT_CODE = #sPrtAtCode#  
             </isNotEmpty>
             
             <isNotEmpty property="sReqstSeCd">
                 AND A.REQST_SE_CD = #sReqstSeCd#  
             </isNotEmpty>
             
             <isNotEmpty property="sEntrpscd">
                 AND A.ENTRPSCD = #sEntrpscd#  
             </isNotEmpty>
             
             <isNotEmpty property="sGrUsagePdFrom"> 
                 AND A.GR_USAGE_PD_FROM <![CDATA[>=]]> REPLACE(#sGrUsagePdFrom#,'-','')    
             </isNotEmpty>
             
             <isNotEmpty property="sGrUsagePdTo">
                 AND A.GR_USAGE_PD_TO <![CDATA[<=]]> REPLACE(#sGrUsagePdTo#,'-','')
             </isNotEmpty>
             
             <isNotEmpty property="sGrAr">
                 AND A.GR_AR = #sGrAr#
             </isNotEmpty>
             
             <isNotEmpty property="sMngYear">
                 AND A.MNG_YEAR = #sMngYear#
             </isNotEmpty>
             
             <isNotEmpty property="sMngNo">
                 AND A.MNG_NO = #sMngNo#
             </isNotEmpty>
             
             <isNotEmpty property="sMngCnt">
                 AND A.MNG_CNT = #sMngCnt#
             </isNotEmpty>
             
             <isNotEmpty property="sPrmisnYn">
                 AND A.PRMISN_YN = #sPrmisnYn#
             </isNotEmpty>
             
             <isNotEmpty property="sUsagePrposCd">
                 AND (
                       (PRT_AT_CODE, MNG_YEAR, MNG_NO, MNG_CNT) IN (
                                                                     SELECT  PRT_AT_CODE
                                                                           , MNG_YEAR
                                                                           , MNG_NO
                                                                           , MNG_CNT 
                                                                       FROM ASSETS_RENT_DETAIL_F
                                                                      WHERE USAGE_PRPOS_CD = #sUsagePrposCd#
                                                                   )
                     ) 
             </isNotEmpty>
             
    </select>
    
    <select id="gamPrtFcltyRentMngtDao.selectPrtFcltyRentMngtSum_S" parameterClass="gamPrtFcltyRentMngtVO" resultMap="gamPrtFcltyRentMngtSumMap">
         SELECT 
                 NVL(COUNT(*),0) SUM_CNT
               , NVL(SUM(A.GR_AR),0) SUM_GR_AR
               , NVL(SUM(A.GR_FEE),0) SUM_GR_FEE
          FROM ASSETS_RENT_F A
         WHERE 1=1
              
         <isNotEmpty property="sPrtAtCode">
             AND A.PRT_AT_CODE = #sPrtAtCode#  
         </isNotEmpty>
         
         <isNotEmpty property="sReqstSeCd">
             AND A.REQST_SE_CD = #sReqstSeCd#  
         </isNotEmpty>
         
         <isNotEmpty property="sEntrpscd">
             AND A.ENTRPSCD = #sEntrpscd#  
         </isNotEmpty>
         
         <isNotEmpty property="sGrUsagePdFrom"> 
             AND A.GR_USAGE_PD_FROM <![CDATA[>=]]> REPLACE(#sGrUsagePdFrom#,'-','')    
         </isNotEmpty>
         
         <isNotEmpty property="sGrUsagePdTo">
             AND A.GR_USAGE_PD_TO <![CDATA[<=]]> REPLACE(#sGrUsagePdTo#,'-','')
         </isNotEmpty>
         
         <isNotEmpty property="sGrAr">
             AND A.GR_AR = #sGrAr#
         </isNotEmpty>
         
         <isNotEmpty property="sMngYear">
             AND A.MNG_YEAR = #sMngYear#
         </isNotEmpty>
         
         <isNotEmpty property="sMngNo">
             AND A.MNG_NO = #sMngNo#
         </isNotEmpty>
         
         <isNotEmpty property="sMngCnt">
             AND A.MNG_CNT = #sMngCnt#
         </isNotEmpty>
         
         <isNotEmpty property="sPrmisnYn">
             AND A.PRMISN_YN = #sPrmisnYn#
         </isNotEmpty>
         
         <isNotEmpty property="sUsagePrposCd">
             AND (
                   (PRT_AT_CODE, MNG_YEAR, MNG_NO, MNG_CNT) IN (
                                                                 SELECT  PRT_AT_CODE
                                                                       , MNG_YEAR
                                                                       , MNG_NO
                                                                       , MNG_CNT 
                                                                   FROM ASSETS_RENT_DETAIL_F
                                                                  WHERE USAGE_PRPOS_CD = #sUsagePrposCd#
                                                               )
                 ) 
         </isNotEmpty>
         
    </select>
    
    <select id="gamPrtFcltyRentMngtDao.selectPrtFcltyRentMngtMaxNo_S" parameterClass="gamPrtFcltyRentMngtVO" resultMap="gamPrtFcltyRentMngtMaxMngMap">
          SELECT 
                  MAX(MNG_CNT) MAX_MNG_CNT
           FROM ASSETS_RENT_F A
          WHERE A.PRT_AT_CODE = #prtAtCode# 
            AND A.MNG_YEAR    = #mngYear#    
            AND A.MNG_NO      = #mngNo#    
            <!-- AND A.MNG_CNT     = #mngCnt# -->  
    </select>       
    
    <insert id="gamPrtFcltyRentMngtDao.insertPrtFcltyRentMngtFirst_S">     
        INSERT INTO ASSETS_RENT_F (
                                     PRT_AT_CODE
                                   , MNG_YEAR
                                   , MNG_NO
                                   , MNG_CNT
                                   , ENTRPSCD
                                   , DT
                                   , REQST_SE_CD
                                   , GR_AR
                                   , GR_FEE
                                   , NTIC_MTH
                                   , FRST_PRMISN_DT
                                   , PRMISN_DT
                                   , PRMISN_YN
                                   , GR_USAGE_PD_FROM
                                   , GR_USAGE_PD_TO
                                   , DOC_NO
                                   , RM
                                   , CMT
                                   , ETC
                                   , REG_USR
                                   , REGIST_DT
                                   , UPD_USR
                                   , UPDT_DT
                                   , GR_RDCXPT_FEE
                                   , GIS_CD
                                   , DEPTCD
                                   )
                            VALUES (
                                     #prtAtCode#
                                   , TO_CHAR(SYSDATE,'YYYY')
                                   , ( SELECT LPAD(MAX(NVL(MNG_NO,0)) + 1,'3','0') FROM ASSETS_RENT_F )
                                   , '01'  
                                   , #entrpscd#
                                   , TO_DATE(#dt:DATE:NO_ENTRY#)  
                                   , #reqstSeCd#
                                   , #grAr#
                                   , #grFee#
                                   , #nticMth#
                                   , REPLACE(#frstPrmisnDt#,'-','')
                                   , REPLACE(#prmisnDt#,'-','')
                                   , #prmisnYn#
                                   , TO_CHAR(SYSDATE,'YYYYMMDD')
                                   , TO_CHAR(SYSDATE + 365,'YYYYMMDD')
                                   , #docNo#
                                   , #rm#
                                   , #cmt#
                                   , #etc#
                                   , #regUsr#
                                   , SYSDATE
                                   , #updUsr#
                                   , SYSDATE
                                   , #grRdcxptFee#
                                   , #gisCd#
                                   , #deptcd#
                                   )
	                               
	                               
	                               
    </insert>
    
    <insert id="gamPrtFcltyRentMngtDao.insertPrtFcltyRentMngtRenew_S">     
        INSERT INTO ASSETS_RENT_F (
                                      PRT_AT_CODE
                                    , MNG_YEAR
                                    , MNG_NO
                                    , MNG_CNT
                                    , ENTRPSCD
                                    , DT
                                    , REQST_SE_CD
                                    , GR_AR
                                    , GR_FEE
                                    , NTIC_MTH
                                    , FRST_PRMISN_DT
                                    , PRMISN_DT
                                    , PRMISN_YN
                                    , GR_USAGE_PD_FROM
                                    , GR_USAGE_PD_TO
                                    , DOC_NO
                                    , RM
                                    , CMT
                                    , ETC
                                    , REG_USR
                                    , REGIST_DT
                                    , UPD_USR
                                    , UPDT_DT
                                    , GR_RDCXPT_FEE
                                    , GIS_CD
                                    , DEPTCD
                               )
          SELECT   A.PRT_AT_CODE
                 , A.MNG_YEAR
                 , A.MNG_NO
                 , LPAD(A.MNG_CNT + 1,'2','0')
                 , A.ENTRPSCD
                 , A.DT
                 , A.REQST_SE_CD
                 , A.GR_AR
                 , A.GR_FEE
                 , A.NTIC_MTH
                 , A.FRST_PRMISN_DT
                 , A.PRMISN_DT
                 , A.PRMISN_YN
                 , A.GR_USAGE_PD_FROM
                 , A.GR_USAGE_PD_TO
                 , A.DOC_NO
                 , A.RM
                 , A.CMT
                 , A.ETC
                 , A.REG_USR
                 , A.REGIST_DT
                 , A.UPD_USR
                 , A.UPDT_DT
                 , A.GR_RDCXPT_FEE
                 , A.GIS_CD
                 , A.DEPTCD
            FROM ASSETS_RENT_F A
           WHERE A.PRT_AT_CODE = #prtAtCode#
             AND A.MNG_YEAR    = #mngYear#
             AND A.MNG_NO      = #mngNo#
             AND A.MNG_CNT     = #mngCnt#
    </insert>
    
    <update id="gamPrtFcltyRentMngtDao.updatePrtFcltyRentMngt_S">
        UPDATE ASSETS_RENT_F SET
		         ENTRPSCD         = #entrpscd#
		       , DT               = TO_DATE(#dt:DATE:NO_ENTRY#)  
		       , REQST_SE_CD      = #reqstSeCd#
		       , GR_AR            = #grAr#
		       , GR_FEE           = #grFee#
		       , NTIC_MTH         = #nticMth#
		       , FRST_PRMISN_DT   = REPLACE(#frstPrmisnDt#,'-','')
		       <!-- , PRMISN_DT        = REPLACE(#prmisnDt#,'-','')
		       , PRMISN_YN        = #prmisnYn# -->
		       , GR_USAGE_PD_FROM = REPLACE(#grUsagePdFrom#,'-','') 
		       , GR_USAGE_PD_TO   = REPLACE(#grUsagePdTo#,'-','') 
		       , DOC_NO           = #docNo#
		       , RM               = #rm#
		       , CMT              = #cmt#
		       , ETC              = #etc#
		       , UPD_USR          = #updUsr#
		       , UPDT_DT          = SYSDATE
		       , GR_RDCXPT_FEE    = #grRdcxptFee#
		       , GIS_CD           = #gisCd#
		       , DEPTCD           = #deptcd#
		WHERE  PRT_AT_CODE        = #prtAtCode#
		AND    MNG_YEAR           = #mngYear#
		AND    MNG_NO             = #mngNo#
		AND    MNG_CNT            = #mngCnt#
    </update>
    
    <select id="gamPrtFcltyRentMngtDao.selectPrtFcltyRentMngtDetailList_D" parameterClass="gamPrtFcltyRentMngtVO" resultClass="egovMap">
           SELECT A.*
           FROM (
                   SELECT  ROWNUM RNUM, S.*
                     FROM (
                           SELECT 
                                  A.ASSETS_USAGE_SEQ             
                                , A.GIS_ASSETS_CD
                                , A.GIS_ASSETS_SUB_CD
                                , A.USAGE_AR
                                , TO_CHAR(TO_DATE(A.USAGE_PD_FROM), 'YYYY-MM-DD') USAGE_PD_FROM
                                , TO_CHAR(TO_DATE(A.USAGE_PD_TO), 'YYYY-MM-DD') USAGE_PD_TO
                                , A.USAGE_PURPS
                                , A.USAGE_DTLS
                                , A.USAGE_PRPOS_CD
                                , ( SELECT CD.CODE_NM FROM COMTCCMMNDETAILCODE CD WHERE CD.USE_AT = 'Y' AND CODE_ID = 'GAM007' AND CD.CODE = A.USAGE_PRPOS_CD ) USAGE_PRPOS_CD_NM
                                , A.EXEMPT_SE
                                , ( SELECT CD.CODE_NM FROM COMTCCMMNDETAILCODE CD WHERE CD.USE_AT = 'Y' AND CODE_ID = 'GAM009' AND CD.CODE = A.EXEMPT_SE ) EXEMPT_SE_NM
                                , A.EXEMPT_RSN_CD
                                , ( SELECT CD.CODE_NM FROM COMTCCMMNDETAILCODE CD WHERE CD.USE_AT = 'Y' AND CODE_ID = 'GAM017' AND CD.CODE = A.EXEMPT_RSN_CD ) EXEMPT_RSN_CD_NM
                                , A.EXEMPT_RSN
                                , TO_CHAR(TO_DATE(A.EXEMPT_PD_FROM), 'YYYY-MM-DD') EXEMPT_PD_FROM 
                                , TO_CHAR(TO_DATE(A.EXEMPT_PD_TO), 'YYYY-MM-DD') EXEMPT_PD_TO 
                                , A.COMPUT_DTLS
                                , A.OLNLP
                                , A.APPLC_TARIFF
                                , A.APPLC_MTH
                                , A.PACK_SE
                                , ( SELECT CD.CODE_NM FROM COMTCCMMNDETAILCODE CD WHERE CD.USE_AT = 'Y' AND CODE_ID = 'GAM015' AND CD.CODE = A.PACK_SE ) PACK_SE_NM
                                , A.ENTRPS_SE
                                , ( SELECT CD.CODE_NM FROM COMTCCMMNDETAILCODE CD WHERE CD.USE_AT = 'Y' AND CODE_ID = 'GAM012' AND CD.CODE = A.ENTRPS_SE ) ENTRPS_SE_NM
                                , A.FEE_CALC_SE
                                , ( SELECT CD.CODE_NM FROM COMTCCMMNDETAILCODE CD WHERE CD.USE_AT = 'Y' AND CODE_ID = 'GAM023' AND CD.CODE = A.FEE_CALC_SE ) FEE_CALC_SE_NM
                                , A.RDCXPT_FEE_CALC_SE
                                <!-- 감면 사용료 계산 구분명 코드테이블 확인해서 CODE_ID 변경 -->
                                , ( SELECT CD.CODE_NM FROM COMTCCMMNDETAILCODE CD WHERE CD.USE_AT = 'Y' AND CODE_ID = 'COM061' AND CD.CODE = A.RDCXPT_FEE_CALC_SE ) RDCXPT_FEE_CALC_SE_NM
                                , A.RDCXPT_FEE
                                , A.FEE
                                , TO_CHAR(TO_DATE(A.TRMNAT_DT), 'YYYY-MM-DD') TRMNAT_DT
                                , A.TRMNAT_RSN
                                , A.GIS_CD
                                , A.REG_USR
                                , TO_CHAR(A.REGIST_DT,'YYYY-MM-DD') REGIST_DT
                                , A.UPD_USR
                                , TO_CHAR(A.UPDT_DT,'YYYY-MM-DD') UPDT_DT
                                , A.PRT_AT_CODE
                                , A.GIS_ASSETS_PRT_AT_CODE
                                , A.MNG_YEAR
                                , A.MNG_NO
                                , A.MNG_CNT
                            FROM ASSETS_RENT_DETAIL_F A
                           WHERE 1=1  
                             AND A.PRT_AT_CODE = #prtAtCode#
                             AND A.MNG_YEAR    = #mngYear#
                             AND A.MNG_NO      = #mngNo#
                             AND A.MNG_CNT     = #mngCnt#
                             
                             ORDER BY REGIST_DT DESC
                ) S
             ) A
        <![CDATA[ WHERE ROWNUM <= #recordCountPerPage# and RNUM > #firstIndex# ]]>
    </select>
    
    <select id="gamPrtFcltyRentMngtDao.selectPrtFcltyRentMngtDetailListTotCnt_S" parameterClass="gamPrtFcltyRentMngtVO" resultClass="int">
            SELECT COUNT(*) totcnt
              FROM ASSETS_RENT_DETAIL_F A
             WHERE 1=1  
               AND A.PRT_AT_CODE = #prtAtCode#
               AND A.MNG_YEAR    = #mngYear#
               AND A.MNG_NO      = #mngNo#
               AND A.MNG_CNT     = #mngCnt#
    </select>
    
    <select id="gamPrtFcltyRentMngtDao.selectPrtFcltyRentMngtLevReqestCnt_S" parameterClass="gamPrtFcltyRentMngtVO" resultClass="int">
	    SELECT COUNT(*) LEV_REQEST_CNT 
	      FROM LEV_REQEST_F A
	     WHERE A.PRT_AT_CODE = #prtAtCode#
           AND A.MNG_YEAR    = #mngYear#
           AND A.MNG_NO      = #mngNo#
           AND A.MNG_CNT     = #mngCnt#
    </select>
    
    <delete id="gamPrtFcltyRentMngtDao.deletePrtFcltyRentMngtPhoto_S">
        DELETE FROM ASSETS_RENT_PHOTO_F
         WHERE PRT_AT_CODE = #prtAtCode#
           AND MNG_YEAR    = #mngYear#
           AND MNG_NO      = #mngNo#
           AND MNG_CNT     = #mngCnt# 
    </delete>
    
    <delete id="gamPrtFcltyRentMngtDao.deletePrtFcltyRentMngtDetail_S">
        DELETE FROM ASSETS_RENT_DETAIL_F
         WHERE PRT_AT_CODE = #prtAtCode#
           AND MNG_YEAR    = #mngYear#
           AND MNG_NO      = #mngNo#
           AND MNG_CNT     = #mngCnt#
    </delete>
    
    <delete id="gamPrtFcltyRentMngtDao.deletePrtFcltyRentMngt_S">
        DELETE FROM ASSETS_RENT_F
         WHERE PRT_AT_CODE = #prtAtCode#
           AND MNG_YEAR    = #mngYear#
           AND MNG_NO      = #mngNo#
           AND MNG_CNT     = #mngCnt#
    </delete>
    
    <insert id="gamPrtFcltyRentMngtDao.insertPrtFcltyRentMngtDetail_S">
        INSERT INTO ASSETS_RENT_DETAIL_F (
		                                     ASSETS_USAGE_SEQ
		                                   , GIS_ASSETS_CD
		                                   , GIS_ASSETS_SUB_CD
		                                   , USAGE_AR
		                                   , USAGE_PD_FROM
		                                   , USAGE_PD_TO 
		                                   , USAGE_PURPS
		                                   , USAGE_DTLS
		                                   , USAGE_PRPOS_CD
		                                   , EXEMPT_SE
		                                   , EXEMPT_RSN_CD
		                                   , EXEMPT_RSN
		                                   , EXEMPT_PD_FROM
		                                   , EXEMPT_PD_TO
		                                   , COMPUT_DTLS
		                                   , OLNLP
		                                   , APPLC_TARIFF
		                                   , APPLC_MTH
		                                   , PACK_SE
		                                   , ENTRPS_SE
		                                   , FEE_CALC_SE
		                                   , RDCXPT_FEE_CALC_SE
		                                   , RDCXPT_FEE
		                                   , FEE
		                                   , TRMNAT_DT
		                                   , TRMNAT_RSN
		                                   , GIS_CD
		                                   , REG_USR
		                                   , REGIST_DT
		                                   , UPD_USR
		                                   , UPDT_DT
		                                   , PRT_AT_CODE
		                                   , GIS_ASSETS_PRT_AT_CODE
		                                   , MNG_YEAR
		                                   , MNG_NO
		                                   , MNG_CNT
		                                 ) 
		                          VALUES (
		                                     ( SELECT NVL(MAX(ASSETS_USAGE_SEQ),0) + 1
											     FROM ASSETS_RENT_DETAIL_F
											    WHERE MNG_YEAR    = #detailMngYear#
											      AND MNG_NO      = #detailMngNo#
											      AND MNG_CNT     = #detailMngCnt#
											      AND PRT_AT_CODE = #detailPrtAtCode# )
		                                   , #gisAssetsCd#
		                                   , #gisAssetsSubCd#
		                                   , #usageAr#
		                                   , REPLACE(#usagePdFrom#,'-','') 
		                                   , REPLACE(#usagePdTo#,'-','') 
		                                   , #usagePurps#
		                                   , #usageDtls#
		                                   , #usagePrposCd#
		                                   , #exemptSe#
		                                   , #exemptRsnCd#
		                                   , #exemptRsn#
		                                   , REPLACE(#exemptPdFrom#,'-','')
		                                   , REPLACE(#exemptPdTo#,'-','') 
		                                   , #computDtls#
		                                   , #olnlp#
		                                   , #applcTariff#
		                                   , #applcMth#
		                                   , #packSe#
		                                   , #entrpsSe#
		                                   , #feeCalcSe#
		                                   , #rdcxptFeeCalcSe#
		                                   , #rdcxptFee#
		                                   , #fee#
		                                   , REPLACE(#trmnatDt#,'-','') 
		                                   , #trmnatRsn#
		                                   , #gisCd#
		                                   , #regUsr#
		                                   , SYSDATE
		                                   , #updUsr#
		                                   , SYSDATE
		                                   , #detailPrtAtCode#
		                                   , #gisAssetsPrtAtCode#
		                                   , #detailMngYear#
		                                   , #detailMngNo#
		                                   , #detailMngCnt#
		                                 )
    </insert>
    
    <update id="gamPrtFcltyRentMngtDao.updatePrtFcltyRentMngtDetail_S">
        UPDATE ASSETS_RENT_DETAIL_F SET
		         GIS_ASSETS_CD          = #gisAssetsCd#
		       , GIS_ASSETS_SUB_CD      = #gisAssetsSubCd#
		       , USAGE_AR               = #usageAr#
		       , USAGE_PD_FROM          = REPLACE(#usagePdFrom#,'-','')
		       , USAGE_PD_TO            = REPLACE(#usagePdTo#,'-','') 
		       , USAGE_PURPS            = #usagePurps#
		       , USAGE_DTLS             = #usageDtls#
		       , USAGE_PRPOS_CD         = #usagePrposCd#
		       , EXEMPT_SE              = #exemptSe#
		       , EXEMPT_RSN_CD          = #exemptRsnCd#
		       , EXEMPT_RSN             = #exemptRsn#
		       , EXEMPT_PD_FROM         = REPLACE(#exemptPdFrom#,'-','') 
		       , EXEMPT_PD_TO           = REPLACE(#exemptPdTo#,'-','') 
		       , COMPUT_DTLS            = #computDtls#
		       , OLNLP                  = #olnlp#
		       , APPLC_TARIFF           = #applcTariff#
		       , APPLC_MTH              = #applcMth#
		       , PACK_SE                = #packSe#
		       , ENTRPS_SE              = #entrpsSe#
		       , FEE_CALC_SE            = #feeCalcSe#
		       , RDCXPT_FEE_CALC_SE     = #rdcxptFeeCalcSe#
		       , RDCXPT_FEE             = #rdcxptFee#
		       , FEE                    = #fee#
		       , TRMNAT_DT              = REPLACE(#trmnatDt#,'-','') 
		       , TRMNAT_RSN             = #trmnatRsn#
		       , GIS_CD                 = #detailGisCd#
		       , UPD_USR                = #updUsr#
		       , UPDT_DT                = SYSDATE
		       , GIS_ASSETS_PRT_AT_CODE = #gisAssetsPrtAtCode#
		  WHERE  ASSETS_USAGE_SEQ       = #assetsUsageSeq#
		    AND  MNG_YEAR               = #detailMngYear#
		    AND  MNG_NO                 = #detailMngNo#
		    AND  MNG_CNT                = #detailMngCnt#
		    AND  PRT_AT_CODE            = #detailPrtAtCode#
    </update>
    
    <delete id="gamPrtFcltyRentMngtDao.deletePrtFcltyRentMngtDetail2_S">
        DELETE FROM ASSETS_RENT_DETAIL_F
         WHERE ASSETS_USAGE_SEQ = #assetsUsageSeq#
           AND MNG_YEAR         = #mngYear#
           AND MNG_NO           = #mngNo#
           AND MNG_CNT          = #mngCnt#
           AND PRT_AT_CODE      = #prtAtCode# 
    </delete>
    
    <select id="gamPrtFcltyRentMngtDao.selectPrtFcltyRentMngtPrmisnInfo_S" parameterClass="gamPrtFcltyRentMngtVO" resultMap="gamPrtFcltyRentMngtInfoMap">
        SELECT   A.PRT_AT_CODE
               , A.MNG_YEAR
               , A.MNG_NO
               , A.MNG_CNT
               , A.ENTRPSCD
               , ( SELECT E.ENTRPS_NM FROM ENTRPS_INFO_F E WHERE E.ENTRPSCD = A.ENTRPSCD AND ROWNUM = 1 ) ENTRPS_NM 
               , TO_CHAR(A.DT, 'YYYYMMDD') DT
               , A.REQST_SE_CD
               , A.GR_AR
               , A.GR_FEE
               , A.NTIC_MTH
               , A.FRST_PRMISN_DT
               , A.PRMISN_DT 
               , A.PRMISN_YN
               , A.GR_USAGE_PD_FROM
               , A.GR_USAGE_PD_TO
               , A.DOC_NO
               , A.RM
               , A.CMT
               , A.ETC
               , A.REG_USR
               , A.REGIST_DT
               , A.UPD_USR
               , A.UPDT_DT
               , A.GR_RDCXPT_FEE
               , A.GIS_CD
               , A.DEPTCD
          FROM ASSETS_RENT_F A
         WHERE 1=1 
           AND A.MNG_YEAR         = #mngYear#
           AND A.MNG_NO           = #mngNo#
           AND A.MNG_CNT          = #mngCnt#
           AND A.PRT_AT_CODE      = #prtAtCode# 
    </select>
    
    <update id="gamPrtFcltyRentMngtDao.updatePrtFcltyRentMngtPrmisn_S">
        UPDATE ASSETS_RENT_F SET
               PRMISN_DT        = TO_CHAR(SYSDATE,'YYYYMMDD')
             , PRMISN_YN        = #prmisnYn# 
        WHERE  PRT_AT_CODE      = #prtAtCode#
        AND    MNG_YEAR         = #mngYear#
        AND    MNG_NO           = #mngNo#
        AND    MNG_CNT          = #mngCnt#
    </update>
    
    <insert id="gamPrtFcltyRentMngtDao.insertPrtFcltyRentMngtLevReqest_S">
        INSERT INTO LEV_REQEST_F (
                             NTIC_CNT
                           , FCLTY_SE
                           , CHRGE_KND
                           , ENTRPSCD
                           , ENTRPS_NM
                           , NTIC_PD_FROM
                           , CONST_PER_TO
                           , ACCNUT_YEAR
                           , NTICNO
                           , NTIC_DT
                           , PAY_TMLMT
                           , OLNLP
                           , FEE
                           , VAT_YN
                           , VAT
                           , NTIC_AMT
                           , RM
                           , RCIV_SE
                           , RCIV_DT
                           , NHT_ISUE_YN
                           , ARRRG_NO
                           , ARRRG_AMT
                           , REQEST_SEQ
                           , DEPTCD
                           , NTIC_MTH
                           , REG_USR
                           , REGIST_DT
                           , UPD_USR
                           , UPDT_DT
                           , PRT_AT_CODE
                           , MNG_YEAR
                           , MNG_NO
                           , MNG_CNT
                         ) 
                  VALUES ( 
                             #nticCnt#
                           , #fcltySe#
                           , #chrgeKnd#
                           , #entrpscd#
                           , #entrpsNm#
                           , #nticPdFrom#
                           , #constPerTo#
                           , #accnutYear#
                           , #nticno#
                           , #nticDt#
                           , #payTmlmt#
                           , #olnlp#
                           , #fee#
                           , #vatYn#
                           , #vat#
                           , #nticAmt#
                           , #rm#
                           , #rcivSe#
                           , #rcivDt#
                           , #nhtIsueYn#
                           , #arrrgNo#
                           , #arrrgAmt#
                           , #reqestSeq#
                           , #deptcd#
                           , #nticMth#
                           , #regUsr#
                           , SYSDATE
                           , #updUsr#
                           , SYSDATE
                           , #prtAtCode#
                           , #mngYear#
                           , #mngNo#
                           , #mngCnt#
                         )
    </insert>
    
    <update id="gamPrtFcltyRentMngtDao.updatePrtFcltyRentMngtPrmisnCancel_S">
        UPDATE ASSETS_RENT_F SET
                PRMISN_DT     = TO_CHAR(SYSDATE,'YYYYMMDD')
              , PRMISN_YN     = #prmisnYn# 
        WHERE  PRT_AT_CODE   = #prtAtCode#
        AND    MNG_YEAR      = #mngYear#
        AND    MNG_NO        = #mngNo#
        AND    MNG_CNT       = #mngCnt#
    </update>
    
</sqlMap>