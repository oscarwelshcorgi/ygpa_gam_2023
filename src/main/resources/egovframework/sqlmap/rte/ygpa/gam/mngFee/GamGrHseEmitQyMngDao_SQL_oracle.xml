<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">
<sqlMap namespace="ygpa.gam.mngFee">

	<typeAlias alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias alias="hashMap" type="java.util.HashMap"/>
	<typeAlias alias="gamGrHseEmitQyMngVo" type="egovframework.rte.ygpa.gam.mngFee.service.GamGrHseEmitQyMngVo"/>

	<select id="gamGrHseEmitQyMngDao.selectGrHseEmitQyMngList_D" parameterClass="gamGrHseEmitQyMngVo" resultClass="egovMap">
		SELECT A.*
			FROM (
				SELECT  ROWNUM RNUM, S.*
					FROM (
						SELECT
								 T1.MNG_YEAR
								,T1.FUEL_CD
								,T1.MNG_MT
								,T1.USAGE_QY
								,T1.ENERGY_USAGE_QY
								,T1.GR_HSE_EMIT_QY
								,T1.REG_USR
								,TO_CHAR(T1.REGIST_DT, 'YYYY-MM-DD HH24:MI:SS') AS REGIST_DT
								,T1.UPD_USR
								,TO_CHAR(T1.UPDT_DT, 'YYYY-MM-DD HH24:MI:SS') AS UPDT_DT
								,T2.FUEL_NM
								,T2.ENERGY_UNIT
								,T2.ENERGY_TOTAL_CAL_VAL
								,T2.ENERGY_NET_CAL_VAL
								,T2.GR_HSE_UNIT
								,T2.GR_HSE_COEF
							FROM GR_HSE_EMIT_STTUS_F T1
							LEFT OUTER JOIN ENERGY_USAGEQY_COEF_F T2 ON (T1.MNG_YEAR=T2.MNG_YEAR AND T1.FUEL_CD=T2.FUEL_CD)
						WHERE 1=1

						<isNotEmpty property="sMngYear">
						AND T1.MNG_MT = || #sMngYear# || #sMngMt#
						</isNotEmpty>

						<isNotEmpty property="sCarNm">
						AND T1.FUEL_CD LIKE '%' || #sFuelCd# || '%'
						</isNotEmpty>

						ORDER BY CAR_REGIST_NO
				) S
			) A
		<![CDATA[
		WHERE ROWNUM <= #recordCountPerPage# and RNUM > #firstIndex#
		]]>
	</select>

	<select id="gamGrHseEmitQyMngDao.selectGrHseEmitQyMngListTotCnt_S" parameterClass="gamGrHseEmitQyMngVo" resultClass="int">
		SELECT COUNT(*) totcnt
			FROM GR_HSE_EMIT_STTUS_F
		WHERE 1=1
		<isNotEmpty property="sMngYear">
		AND MNG_MT = || #sMngYear# || #sMngMt#
		</isNotEmpty>

		<isNotEmpty property="sCarNm">
		AND FUEL_CD LIKE '%' || #sFuelCd# || '%'
		</isNotEmpty>
	</select>

	<insert id="gamGrHseEmitQyMngDao.insertGrHseEmitQyMng_S">
		<![CDATA[
		INSERT INTO GR_HSE_EMIT_STTUS_F
		(
			 FUEL_CD
			,MNG_YEAR
			,MNG_MT
			,USAGE_QY
			,ENERGY_USAGE_QY
			,GR_HSE_EMIT_QY
			,REG_USR
			,REGIST_DT
		)
		VALUES
		(
			 #fuelCd#
			,#mngYear#
			,#mngMt#
			,TO_NUMBER(#usageQy#)
			,TO_NUMBER(#energyUsageQy#)
			,TO_NUMBER(#grHseEmitQy#)
			,#regUsr#
			,SYSDATE
		)
		]]>
	</insert>

	<update id="gamGrHseEmitQyMngDao.updateGrHseEmitQyMng_S">
		<![CDATA[
		UPDATE GR_HSE_EMIT_STTUS_F SET
			 USAGE_QY = TO_NUMBER(#usageQy#)
			,ENERGY_USAGE_QY = TO_NUMBER(#energyUsageQy#)
			,GR_HSE_EMIT_QY = TO_NUMBER(#grHseEmitQy#)
			,UPD_USR = #updUsr#
			,UPDT_DT = SYSDATE
		WHERE FUEL_CD = #fuelCd#
		AND MNG_YEAR = #mngYear#
		AND MNG_MT = #mngMt#
		]]>
	</update>

	<delete id="gGamGrHseEmitQyMngDao.deleteGrHseEmitQyMng_S">
		<![CDATA[
		DELETE GR_HSE_EMIT_STTUS_F
		WHERE FUEL_CD = #fuelCd#
		AND MNG_YEAR = #mngYear#
		AND MNG_MT = #mngMt#
		]]>
	</delete>

</sqlMap>