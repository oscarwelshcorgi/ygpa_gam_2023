<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="ygpa.gam.oper.gnrl">

    <typeAlias alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
    <typeAlias alias="hashMap" type="java.util.HashMap"/>
    <typeAlias alias="gamPrtFcltyPdRentFeeSttusInqireVO" type="egovframework.rte.ygpa.gam.oper.gnrl.service.GamPrtFcltyPdRentFeeSttusInqireVO"/>
    
    <select id="gamPrtFcltyPdRentFeeSttusInqireDao.selectPrtFcltyPdRentFeeSttusInqireList_D" parameterClass="gamPrtFcltyPdRentFeeSttusInqireVO" resultClass="egovMap">
           SELECT A.*
           FROM (
                   SELECT  ROWNUM RNUM, S.*
                     FROM (
							SELECT T1.PRT_AT_CODE,
							       T1.USAGE_YEAR,
							       T1.USAGE_QU,
							       T1.USAGE_MT,
							       MIN(T3.CODE_NM) AS PRT_KOR_NM,
							       NVL(SUM(T1.FEE),0) AS SUM_TOTAL_FEE,
							       NVL(SUM(T1.RDCXPT_FEE),0) AS SUM_TOTAL_RDCXPT_FEE
							FROM USAGE_PD_BY_STATS_F T1
							LEFT OUTER JOIN COMTCCMMNDETAILCODE T3 ON ('GAM019'=T3.CODE_ID AND T1.PRT_AT_CODE=T3.CODE)
							WHERE 1 = 1
							AND T1.PRT_AT_CODE='622'                 
							<![CDATA[ AND T1.USAGE_YEARMT>='201401']]>          
							<![CDATA[ AND T1.USAGE_YEARMT<='201412']]>            
							AND T1.REQST_ENTRPS_CD='ZZZ1234'         
							AND T1.GIS_ASSETS_CD='LGR'               
							AND T1.GIS_ASSETS_SUB_CD='70'            
							AND T1.QUAY_GROUP_CD='G'                 
							GROUP BY T1.PRT_AT_CODE,
							         T1.USAGE_YEAR,
							         T1.USAGE_QU,
							         T1.USAGE_MT                
				) S
             ) A
        <![CDATA[ WHERE ROWNUM <= #recordCountPerPage# and RNUM > #firstIndex# ]]>

    </select>
    
</sqlMap>
