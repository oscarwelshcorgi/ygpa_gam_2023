<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="ygpa.gam.oper.center">

    <typeAlias alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
    <typeAlias alias="hashMap" type="java.util.HashMap"/>
    <typeAlias alias="gamMarineCenterRentNticMngtVO" type="egovframework.rte.ygpa.gam.oper.center.service.GamMarineCenterRentNticMngtVO"/>

    <resultMap id="gamMarineCenterRentNticMngtSumMap" class="egovframework.rte.ygpa.gam.oper.center.service.GamMarineCenterRentNticMngtVO">
        <result property="sumCnt" column="SUM_CNT" columnIndex="1"/>
        <result property="sumNticAmt" column="SUM_BILL_AMNT" columnIndex="2"/>
    </resultMap>
    
    <select id="gamMarineCenterRentNticMngtDao.selectMarineCenterRentNticList_D" parameterClass="gamMarineCenterRentNticMngtVO" resultClass="egovMap">
           SELECT A.*
           FROM (
                   SELECT  ROWNUM RNUM, S.*
                     FROM (
                           SELECT 
                                 E.INT_SEQ             
                                ,E.DEL_KIND           
                                ,E.JINGSU_DATE            
                                ,E.SUNAP_DATE         
                                ,E.PRT_AT_CODE            
                                ,E.FEE_TP             
                                ,E.FISCAL_YR          
                                ,E.BILL_NO                
                                ,E.ACCNT_CODE         
                                ,E.AGENT_CODE         
                                ,E.BILL_AMNT          
                                ,E.BILL_DT                
                                ,E.BILL_PRT_YN            
                                ,E.DUE_DATE           
                                ,E.RCVD_DT                
                                ,E.RCVD_TP                
                                ,E.RSLT_CODE          
                                ,E.EXMP_AMNT          
                                ,E.OVER_AMNT          
                                ,E.DC_AMNT                
                                ,E.DC_CODE                
                                ,E.DC_RATE                
                                ,E.RECPT_EPDT         
                                ,E.ELCT_BILL_RSLT     
                                ,E.BULL_INFO_INQR_DTIME
                                ,E.AMNT_RSN           
                                ,E.BZ_RGST_ID         
                                ,E.AGENT_NAME         
                                ,E.LAST               
                                ,E.VAT_YN             
                                ,E.JIRO_NO                
                                ,E.ELEC_PAY_NO            
                                ,E.CUSTOMER_MNGT_NO   
                                ,E.CUSTOMER_ADDR      
                                ,E.PAY_NAME 
                           FROM  ERP_REV_COLL_F@YGPA_PORTMIS E
                                ,LEV_REQEST_F L
                                ,ASSETS_RENT_F A
                          WHERE E.BILL_NO = L.NTICNO
                            AND A.PRT_AT_CODE = L.PRT_AT_CODE
                            AND A.MNG_YEAR = L.MNG_YEAR
                            AND A.MNG_NO = L.MNG_NO
                            AND A.MNG_CNT = L.MNG_CNT
                            AND A.QUAY_GROUP_CD='M'
                            AND A.QUAY_CD = 'X'
                             
                            <isNotEmpty property="sPrtAtCode">
                                AND A.PRT_AT_CODE = #sPrtAtCode#
                            </isNotEmpty>
                           ORDER BY INT_SEQ DESC
                ) S
             ) A
        <![CDATA[ WHERE ROWNUM <= #recordCountPerPage# and RNUM > #firstIndex# ]]>
    </select>
    
    <select id="gamMarineCenterRentNticMngtDao.selectMarineCenterRentNticListTotCnt_S" parameterClass="gamMarineCenterRentNticMngtVO" resultClass="int">
            SELECT COUNT(*) totcnt
              FROM  ERP_REV_COLL_F@YGPA_PORTMIS E
                   ,LEV_REQEST_F L
                   ,ASSETS_RENT_F A
             WHERE E.BILL_NO = L.NTICNO
               AND A.PRT_AT_CODE = L.PRT_AT_CODE
               AND A.MNG_YEAR = L.MNG_YEAR
               AND A.MNG_NO = L.MNG_NO
               AND A.MNG_CNT = L.MNG_CNT
               AND A.QUAY_GROUP_CD='M'
               AND A.QUAY_CD = 'X'
                
               <isNotEmpty property="sPrtAtCode">
                   AND A.PRT_AT_CODE = #sPrtAtCode#
               </isNotEmpty>
    </select>

     <select id="gamMarineCenterRentNticMngtDao.selectMarineCenterRentNticSum_S" parameterClass="gamMarineCenterRentNticMngtVO" resultMap="gamMarineCenterRentNticMngtSumMap">
            SELECT 
               TRIM(TO_CHAR(NVL(COUNT(*),0), '999,999,999,999')) SUM_CNT
               , TRIM(TO_CHAR(NVL(SUM(E.BILL_AMNT),0), '999,999,999,999')) SUM_BILL_AMNT
              FROM  ERP_REV_COLL_F@YGPA_PORTMIS E
                   ,LEV_REQEST_F L
                   ,ASSETS_RENT_F A
             WHERE E.BILL_NO = L.NTICNO
               AND A.PRT_AT_CODE = L.PRT_AT_CODE
               AND A.MNG_YEAR = L.MNG_YEAR
               AND A.MNG_NO = L.MNG_NO
               AND A.MNG_CNT = L.MNG_CNT
               AND A.QUAY_GROUP_CD='M'
               AND A.QUAY_CD = 'X'
                
               <isNotEmpty property="sPrtAtCode">
                   AND A.PRT_AT_CODE = #sPrtAtCode# 
               </isNotEmpty>
    </select>
     
</sqlMap>
