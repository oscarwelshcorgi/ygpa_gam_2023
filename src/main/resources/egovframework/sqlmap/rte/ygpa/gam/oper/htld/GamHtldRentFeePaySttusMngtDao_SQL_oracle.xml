<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="ygpa.gam.oper.htld">

    <typeAlias alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
    <typeAlias alias="hashMap" type="java.util.HashMap"/>
    <typeAlias alias="gamHtldRentFeePaySttusMngtVO" type="egovframework.rte.ygpa.gam.oper.htld.service.GamHtldRentFeePaySttusMngtVO"/>
    <typeAlias alias="gamHtldRentArrrgMngtVO" type="egovframework.rte.ygpa.gam.oper.htld.service.GamHtldRentArrrgMngtVO"/>

    <resultMap id="gamHtldRentFeePaySttusMngtSumMap" class="egovframework.rte.ygpa.gam.oper.htld.service.GamHtldRentFeePaySttusMngtVO">
        <result property="sumCnt" column="SUM_CNT" columnIndex="4"/>
        <result property="sumFee" column="SUM_FEE" columnIndex="5"/>
        <result property="sumNhtIsueAmt" column="SUM_NHT_ISUE_AMT" columnIndex="6"/>
        <result property="sumVat" column="SUM_VAT" columnIndex="7"/>
        <result property="sumNticAmt" column="SUM_NTIC_AMT" columnIndex="8"/>
        <result property="sumFeeA3" column="SUM_FEE_A3" columnIndex="9"/>
        <result property="sumFeeA4" column="SUM_FEE_A4" columnIndex="10"/>
        <result property="sumFeeD1" column="SUM_FEE_D1" columnIndex="11"/>
        <result property="sumFeeD2" column="SUM_FEE_D2" columnIndex="12"/>
        <result property="sumPayAmt" column="SUM_PAY_AMT" columnIndex="13"/>
   </resultMap>

	<!-- 납부현황목록 -->
    <select id="gamHtldRentFeePaySttusMngtDao.selectHtldRentFeePaySttusMngtList_D" parameterClass="gamHtldRentFeePaySttusMngtVO" resultClass="egovMap">
    	SELECT Z.* FROM (
           SELECT ROWNUM RNUM, A.*
           		FROM (
                           SELECT
							         L.NTIC_CNT
							       , L.FCLTY_SE
							       , L.CHRGE_KND
							       , L.ENTRPSCD
							       , L.ENTRPS_NM
							       , TO_CHAR(L.NTIC_PD_FROM, 'YYYY-MM-DD') NTIC_PD_FROM
							       , TO_CHAR(L.NTIC_PD_TO, 'YYYY-MM-DD') NTIC_PD_TO
							       , L.ACCNUT_YEAR
							       , L.NTICNO
							       , TO_CHAR(L.NTIC_DT, 'YYYY-MM-DD') NTIC_DT
							       , TO_CHAR(L.PAY_TMLMT, 'YYYY-MM-DD') PAY_TMLMT
							       , L.SANCTN_STTUS
							       , L.SANCTNER_EMPL_NO
							       , TO_CHAR(L.SANCTN_DT) SANCTN_DT
							       , GAM_GETCODENAME('GAM046', L.SANCTN_STTUS) SANCTN_STTUS_NM
							       , NVL(L.OLNLP,0) OLNLP
							       , NVL(L.FEE,0) FEE
							       , L.VAT_YN
							       , L.ADD_AMNT
							       , NVL(L.VAT,0) VAT
							       , NVL(L.INTR_AMNT, 0) INTR_AMNT
							       , NVL(L.NTIC_AMT,0) NTIC_AMT
							       , L.RM
							       , L.RCIV_SE
							       , L.ASSESS_SE
							       , GAM_GETCODENAME('GAM025', L.RCIV_SE) RCIV_SE_NM
							       , TO_CHAR(L.RCIV_DT, 'YYYY-MM-DD') RCIV_DT
							       , L.ARRRG_NO
							       , NVL(L.ARRRG_AMT,0) ARRRG_AMT
							       , L.REQEST_SEQ
							       , L.DEPTCD
							       , L.NTIC_MTH
							       , L.REG_USR
							       , TO_CHAR(L.REGIST_DT, 'YYYY-MM-DD') REGIST_DT
							       , L.UPD_USR
							       , TO_CHAR(L.UPDT_DT, 'YYYY-MM-DD') UPDT_DT
							       , L.PRT_AT_CODE
							       , L.MNG_YEAR
							       , L.MNG_NO
							       , L.MNG_CNT
							       , L.MNG_YEAR || '-' || L.MNG_NO || '-' || L.MNG_CNT AS RENT_MNG_NO
							       , GAM_GET_FEE_TP_NM(L.PRT_AT_CODE, 'H', L.CHRGE_KND) CHRGE_KND_NM
							       , (SELECT CD.CODE_NM FROM COMTCCMMNDETAILCODE CD WHERE CD.CODE_ID = 'GAM019' AND CD.CODE = L.PRT_AT_CODE AND ROWNUM = 1) PRT_AT_CODE_NM
    						       , GAM_GETDEPTNAME(L.DEPTCD) DEPTCD_NM
    						       , NVL(A.GR_AR,0) GR_AR
    						       , TO_CHAR(A.GR_USAGE_PD_FROM, 'YYYY-MM-DD') GR_USAGE_PD_FROM
    						       , TO_CHAR(A.GR_USAGE_PD_TO, 'YYYY-MM-DD') GR_USAGE_PD_TO
    						       , TO_CHAR(A.PRMISN_DT, 'YYYY-MM-DD') PRMISN_DT
    						       , NVL(A.GR_RDCXPT_FEE,0) GR_RDCXPT_FEE
							  FROM ASSETS_RENT_F A,
							       LEV_REQEST_F L
							 WHERE A.PRT_AT_CODE = L.PRT_AT_CODE
                               AND A.MNG_YEAR = L.MNG_YEAR
                               AND A.MNG_NO = L.MNG_NO
                               AND A.MNG_CNT = L.MNG_CNT
							   AND A.QUAY_GROUP_CD='H'
							   AND L.NHT_ISUE_YN='Y'
							   <!-- AND L.NHT_PRINT_YN  ='Y' -->
							   <isNotEmpty property="sPrtAtCode">
							       AND L.PRT_AT_CODE = #sPrtAtCode#
							   </isNotEmpty>
							   <isNotEmpty property="sEntrpscd">
							       AND L.entrpscd = #sEntrpscd#
							   </isNotEmpty>
						       <isNotEmpty property="nticPdFrom">
									<![CDATA[ AND L.NTIC_DT > TO_DATE(#nticPdFrom#, 'YYYY-MM-DD') ]]>
						       </isNotEmpty>
						       <isNotEmpty property="nticPdTo">
									<![CDATA[ AND L.NTIC_DT < TO_DATE(#nticPdTo#, 'YYYY-MM-DD')+1 ]]>
						       </isNotEmpty>
							   <isNotEmpty property="sMngYear">
							       AND L.MNG_YEAR = #sMngYear#
							   </isNotEmpty>
							   <isNotEmpty property="sMngNo">
							       AND L.MNG_NO = #sMngNo#
							   </isNotEmpty>
							   <isNotEmpty property="sMngCnt">
							       AND L.MNG_CNT = #sMngCnt#
							   </isNotEmpty>
							   <isEqual property="rcivSe" compareValue="Y">
									AND L.RCIV_SE IN ('2','3')
								</isEqual>
								<isEqual property="rcivSe" compareValue="N">
									AND (L.RCIV_SE IS NULL OR L.RCIV_SE IN ('0','1', '4'))
								</isEqual>
							   <isNotEmpty property="sChrgeKnd">
							   		AND L.CHRGE_KND = #sChrgeKnd#
							   </isNotEmpty>
                			ORDER BY L.ENTRPS_NM ASC, L.NTIC_CNT ASC
             	) A
             ) Z
        <![CDATA[
        	WHERE ROWNUM <= #recordCountPerPage# and Z.RNUM > #firstIndex#
        ]]>
    </select>

	<!-- 납부현황목록 갯수-->
    <select id="gamHtldRentFeePaySttusMngtDao.selectHtldRentFeePaySttusMngtListTotCnt_S" parameterClass="gamHtldRentFeePaySttusMngtVO" resultClass="int">
                           SELECT COUNT(*) totcnt
							  FROM ASSETS_RENT_F A,
							       LEV_REQEST_F L
							 WHERE A.PRT_AT_CODE = L.PRT_AT_CODE
                               AND A.MNG_YEAR = L.MNG_YEAR
                               AND A.MNG_NO = L.MNG_NO
                               AND A.MNG_CNT = L.MNG_CNT
							   AND A.QUAY_GROUP_CD='H'
							   AND L.NHT_ISUE_YN='Y'
							   <!-- AND L.NHT_PRINT_YN  ='Y' -->
							   <isNotEmpty property="sPrtAtCode">
							       AND L.PRT_AT_CODE = #sPrtAtCode#
							   </isNotEmpty>
							   <isNotEmpty property="sEntrpscd">
							       AND L.entrpscd = #sEntrpscd#
							   </isNotEmpty>
						       <isNotEmpty property="nticPdFrom">
									<![CDATA[ AND L.NTIC_DT > TO_DATE(#nticPdFrom#, 'YYYY-MM-DD') ]]>
						       </isNotEmpty>
						       <isNotEmpty property="nticPdTo">
									<![CDATA[ AND L.NTIC_DT < TO_DATE(#nticPdTo#, 'YYYY-MM-DD')+1 ]]>
						       </isNotEmpty>
							   <isNotEmpty property="sMngYear">
							       AND L.MNG_YEAR = #sMngYear#
							   </isNotEmpty>
							   <isNotEmpty property="sMngNo">
							       AND L.MNG_NO = #sMngNo#
							   </isNotEmpty>
							   <isNotEmpty property="sMngCnt">
							       AND L.MNG_CNT = #sMngCnt#
							   </isNotEmpty>
							   <isEqual property="rcivSe" compareValue="Y">
									AND L.RCIV_SE IN ('2','3')
								</isEqual>
								<isEqual property="rcivSe" compareValue="N">
									AND (L.RCIV_SE IS NULL OR L.RCIV_SE IN ('0','1', '4'))
								</isEqual>
							   <isNotEmpty property="sChrgeKnd">
							   		AND L.CHRGE_KND = #sChrgeKnd#
							   </isNotEmpty>
    </select>
    
	<!-- 자료수, 총고지금액, 부가세, 총납부금액  -->
    <select id="gamHtldRentFeePaySttusMngtDao.selectHtldRentFeePaySttusMngtSum_S" parameterClass="gamHtldRentFeePaySttusMngtVO" resultMap="gamHtldRentFeePaySttusMngtSumMap">
         SELECT
          	COUNT(*) SUM_CNT
            , SUM(DECODE(L.CHRGE_KND, 'A3', 0, 'A4', 0, 'D1', 0, 'D2', 0, L.FEE)) SUM_FEE
            , SUM(DECODE(L.CHRGE_KND, 'A3', L.FEE, 0)) SUM_FEE_A3
            , SUM(DECODE(L.CHRGE_KND, 'A4', L.FEE, 0)) SUM_FEE_A4
            , SUM(DECODE(L.CHRGE_KND, 'D1', L.FEE, 0)) SUM_FEE_D1
            , SUM(DECODE(L.CHRGE_KND, 'D2', L.FEE, 0)) SUM_FEE_D2
            , SUM(NVL(L.NTIC_AMT, 0)) SUM_NHT_ISUE_AMT
            , SUM(NVL(L.VAT, 0)) SUM_VAT
            , SUM(NVL(L.NTIC_AMT,0)) SUM_NTIC_AMT
            , SUM(DECODE(L.RCIV_SE, '3', L.FEE, 0)) SUM_PAY_AMT
          FROM ASSETS_RENT_F A, LEV_REQEST_F L
          WHERE A.QUAY_GROUP_CD='H'
             	AND A.PRT_AT_CODE=L.PRT_AT_CODE
             	AND A.MNG_YEAR=L.MNG_YEAR
             	AND A.MNG_NO=L.MNG_NO
             	AND A.MNG_CNT=L.MNG_CNT
             	AND L.NHT_ISUE_YN='Y'
							   <isNotEmpty property="sPrtAtCode">
							       AND L.PRT_AT_CODE = #sPrtAtCode#
							   </isNotEmpty>
							   <isNotEmpty property="sEntrpscd">
							       AND L.entrpscd = #sEntrpscd#
							   </isNotEmpty>
						       <isNotEmpty property="nticPdFrom">
									<![CDATA[ AND L.NTIC_DT > TO_DATE(#nticPdFrom#, 'YYYY-MM-DD') ]]>
						       </isNotEmpty>
						       <isNotEmpty property="nticPdTo">
									<![CDATA[ AND L.NTIC_DT < TO_DATE(#nticPdTo#, 'YYYY-MM-DD')+1 ]]>
						       </isNotEmpty>
							   <isNotEmpty property="sMngYear">
							       AND L.MNG_YEAR = #sMngYear#
							   </isNotEmpty>
							   <isNotEmpty property="sMngNo">
							       AND L.MNG_NO = #sMngNo#
							   </isNotEmpty>
							   <isNotEmpty property="sMngCnt">
							       AND L.MNG_CNT = #sMngCnt#
							   </isNotEmpty>
							   <isEqual property="rcivSe" compareValue="Y">
									AND L.RCIV_SE IN ('2','3')
								</isEqual>
								<isEqual property="rcivSe" compareValue="N">
									AND (L.RCIV_SE IS NULL OR L.RCIV_SE IN ('0','1', '4'))
								</isEqual>
							   <isNotEmpty property="sChrgeKnd">
							   		AND L.CHRGE_KND = #sChrgeKnd#
							   </isNotEmpty>
    </select>

	<!-- 지로 수납된 자료인지 체크 -->
	<select id="gamHtldRentFeePaySttusMngtDao.selectHtldCheckOcrResult_S" parameterClass="gamPrtFcltyRentFeePaySttusMngtVO" resultClass="egovMap">
       SELECT
       		L.PRT_AT_CODE,
			L.MNG_YEAR,
			L.MNG_NO,
			L.MNG_CNT,
			L.NTIC_CNT,
			L.CHRGE_KND,
			R.RCVD_DT,
        	R.OCR_DT
		FROM 
			LEV_REQEST_F L, 
			REV_COLL_F R
		WHERE R.PRT_AT_CODE=L.PRT_AT_CODE
			AND R.FISCAL_YR = L.ACCNUT_YEAR
			AND R.FEE_TP = GAM_GET_HTLD_FEE_TP(L.CHRGE_KND)
			AND R.WORK_CODE = L.CHRGE_KND
			AND R.BILL_NO = L.NTICNO
			AND L.PRT_AT_CODE=#prtAtCode#
			AND L.MNG_YEAR   =#mngYear#
			AND L.MNG_NO     =#mngNo#
			AND L.MNG_CNT    =#mngCnt#
			AND L.NTIC_CNT   =#nticCnt#
			AND L.CHRGE_KND  =#chrgeKnd#
	</select>

	<!-- 수납처리를 하기 위한 LEV_REQUEST_F 수정 -->
    <update id="gamHtldRentFeePaySttusMngtDao.htldUpdateLevReqestRcivSe" parameterClass="GamPrtFcltyRentFeePaySttusMngtVO">
        UPDATE LEV_REQEST_F SET
      		RCIV_SE=#rcivSe#,
      		UPDT_DT=SYSDATE,
      		<isNotEmpty property="updUsr">
      			UPD_USR=#updUsr#,
      		</isNotEmpty>
      		<isNotEmpty property="rm">
      			RM=#rm#,
      		</isNotEmpty>
      		<isEqual property="rcivSe" compareValue="3">
      			<isNotEmpty property="rcivDt">
	      			RCIV_DT=TO_DATE(#rcivDt#, 'YYYY-MM-DD')
	      		</isNotEmpty>
      			<isEmpty property="rcivDt">
	      			RCIV_DT=SYSDATE
	      		</isEmpty>
      		</isEqual>
      		<isNotEqual property="rcivSe" compareValue="3">
   		      <isEqual property="rcivSe" compareValue="2">
	      			<isNotEmpty property="rcivDt">
		      			RCIV_DT=TO_DATE(#rcivDt#, 'YYYY-MM-DD')
		      		</isNotEmpty>
	      			<isEmpty property="rcivDt">
		      			RCIV_DT=SYSDATE
		      		</isEmpty>
	      		</isEqual>
	      		<isNotEqual property="rcivSe" compareValue="2">
      				RCIV_DT=''
      			</isNotEqual>
      		</isNotEqual>
   		WHERE PRT_AT_CODE=#prtAtCode#
	      	AND MNG_YEAR=#mngYear#
	      	AND MNG_NO=#mngNo#
	      	AND MNG_CNT=#mngCnt#
	      	AND NTIC_CNT=#nticCnt#
            AND CHRGE_KND=#chrgeKnd#
	</update>

	<!-- 수납처리를 하기 위한 REV_COLL_F 수정 -->
    <update id="gamHtldRentFeePaySttusMngtDao.htldUpdateRevCollRcvdTp" parameterClass="hashMap">
        UPDATE REV_COLL_F SET
      		RCVD_TP=#rcvdTp#,
     		<isEqual property="rcvdTp" compareValue="3">
      			<isNotEmpty property="rcvdDt">
	      			RCVD_DT=TO_DATE(#rcvdDt#, 'YYYY-MM-DD')
	      		</isNotEmpty>
      			<isEmpty property="rcvdDt">
	      			RCVD_DT=SYSDATE
	      		</isEmpty>
      		</isEqual>
      		<isNotEqual property="rcvdTp" compareValue="3">
   		      <isEqual property="rcvdTp" compareValue="2">
	      			<isNotEmpty property="rcvdDt">
		      			RCVD_DT=TO_DATE(#rcvdDt#, 'YYYY-MM-DD')
		      		</isNotEmpty>
	      			<isEmpty property="rcvdDt">
		      			RCVD_DT=SYSDATE
		      		</isEmpty>
	      		</isEqual>
	      		<isNotEqual property="rcvdTp" compareValue="2">
      				RCVD_DT=''
      			</isNotEqual>
      		</isNotEqual>
   		WHERE (PRT_AT_CODE, WORK_CODE, FISCAL_YR, BILL_NO)
            IN (
              SELECT PRT_AT_CODE, CHRGE_KND, ACCNUT_YEAR, NTICNO
              FROM LEV_REQEST_F
              WHERE 1=1
                AND PRT_AT_CODE=#prtAtCode#
		      	AND MNG_YEAR=#mngYear#
		      	AND MNG_NO=#mngNo#
		      	AND MNG_CNT=#mngCnt#
		      	AND NTIC_CNT=#nticCnt#
                AND CHRGE_KND=#chrgeKnd#
            )
	</update>
	
	<!-- 배후단지임대료납부상세 원고지 정보 -->
    <select id="gamHtldRentFeePaySttusMngtDao.selectHtldRentFeePaySttusMngtDetailMaster_S" parameterClass="gamHtldRentFeePaySttusMngtVO" resultClass="egovMap">
          SELECT
		       L.NTIC_CNT
		       , L.FCLTY_SE
		       , L.CHRGE_KND
		       , L.ENTRPSCD
		       , L.ENTRPS_NM
		       , TO_CHAR(L.NTIC_PD_FROM, 'YYYY-MM-DD') NTIC_PD_FROM
		       , TO_CHAR(L.NTIC_PD_TO, 'YYYY-MM-DD') NTIC_PD_TO
		       , L.ACCNUT_YEAR
		       , L.NTICNO
		       , TO_CHAR(L.NTIC_DT, 'YYYY-MM-DD') NTIC_DT
		       , TO_CHAR(L.PAY_TMLMT, 'YYYY-MM-DD') PAY_TMLMT
		       , L.SANCTN_STTUS
		       , L.SANCTNER_EMPL_NO
		       , TO_CHAR(L.SANCTN_DT) SANCTN_DT
		       , GAM_GETCODENAME('GAM046', L.SANCTN_STTUS) SANCTN_STTUS_NM
		       , NVL(L.OLNLP,0) OLNLP
		       , NVL(L.FEE,0) FEE
		       , L.VAT_YN
		       , NVL(L.VAT,0) VAT
		       , NVL(L.NTIC_AMT,0) NTIC_AMT
		       , L.RM
		       , L.ASSESS_SE
		       , L.RCIV_SE
		       , TO_CHAR(L.RCIV_DT, 'YYYY-MM-DD') RCIV_DT
		       , L.ARRRG_NO
		       , NVL(L.ARRRG_AMT,0) ARRRG_AMT
		       , L.REQEST_SEQ
		       , L.DEPTCD
		       , L.NTIC_MTH
		       , L.REG_USR
		       , TO_CHAR(L.REGIST_DT, 'YYYY-MM-DD') REGIST_DT
		       , L.UPD_USR
		       , TO_CHAR(L.UPDT_DT, 'YYYY-MM-DD') UPDT_DT
		       , L.PRT_AT_CODE
		       , L.MNG_YEAR
		       , L.MNG_NO
		       , L.MNG_CNT
		       , (SELECT CD.CODE_NM FROM COMTCCMMNDETAILCODE CD WHERE CD.CODE_ID = 'GAM019' AND CD.CODE = L.PRT_AT_CODE AND ROWNUM = 1) PRT_AT_CODE_NM
			   , GAM_GETDEPTNAME(L.DEPTCD) DEPTCD_NM
			   , NVL(A.GR_AR,0) GR_AR
					       , TO_CHAR(A.GR_USAGE_PD_FROM, 'YYYY-MM-DD') GR_USAGE_PD_FROM
					       , TO_CHAR(A.GR_USAGE_PD_TO, 'YYYY-MM-DD') GR_USAGE_PD_TO
					       , TO_CHAR(A.PRMISN_DT, 'YYYY-MM-DD') PRMISN_DT
					       , NVL(A.GR_RDCXPT_FEE,0) GR_RDCXPT_FEE
		       , GAM_GET_FEE_TP_NM(L.PRT_AT_CODE, 'H', L.CHRGE_KND) CHRGE_KND_NM
		 FROM ASSETS_RENT_F A,
		       LEV_REQEST_F L
		 WHERE
		  		A.PRT_AT_CODE = L.PRT_AT_CODE
                AND A.MNG_YEAR = L.MNG_YEAR
                AND A.MNG_NO = L.MNG_NO
                AND A.MNG_CNT = L.MNG_CNT
		   		AND A.QUAY_GROUP_CD='H'
		   		AND L.NHT_ISUE_YN='Y'
	       		AND L.PRT_AT_CODE = #prtAtCode#
	      	 	AND L.MNG_YEAR    = #mngYear#
	       		AND L.MNG_NO      = #mngNo#
	       		AND L.MNG_CNT     = #mngCnt#
	       		AND L.NTIC_CNT     = #nticCnt#
	       		AND L.CHRGE_KND     = #chrgeKnd#
    </select>
	
	<!-- 배후단지임대료납부상세 전체사용료 목록 -->
    <select id="gamHtldRentFeePaySttusMngtDao.selectHtldRentFeePaySttusMngtDetailList_D" parameterClass="gamHtldRentFeePaySttusMngtVO" resultClass="egovMap">
            	SELECT
			         L.NTIC_CNT
			         , DECODE(L.NTIC_CNT, #nticCnt#, 'Y', 'N') CURR_NTIC_CNT
			       , L.FCLTY_SE
			       , L.CHRGE_KND
			       , GAM_GET_FEE_TP_NM(L.PRT_AT_CODE, 'H', L.CHRGE_KND) CHRGE_KND_NM
			       , L.ENTRPSCD
			       , L.ENTRPS_NM
			       , TO_CHAR(L.NTIC_PD_FROM, 'YYYY-MM-DD') NTIC_PD_FROM
			       , TO_CHAR(L.NTIC_PD_TO, 'YYYY-MM-DD') NTIC_PD_TO
			       , L.ACCNUT_YEAR
			       , L.NTICNO
			       , TO_CHAR(L.NTIC_DT, 'YYYY-MM-DD') NTIC_DT
			       , TO_CHAR(L.PAY_TMLMT, 'YYYY-MM-DD') PAY_TMLMT
			       , L.SANCTN_STTUS
			       , L.SANCTNER_EMPL_NO
			       , TO_CHAR(L.SANCTN_DT) SANCTN_DT
			       , GAM_GETCODENAME('GAM046', L.SANCTN_STTUS) SANCTN_STTUS_NM
			       , NVL(L.OLNLP,0) OLNLP
			       , NVL(L.FEE,0) FEE
			       , L.VAT_YN
			       , NVL(L.VAT,0) VAT
			       , NVL(L.NTIC_AMT,0) NTIC_AMT
			       , L.RM
			       , L.RCIV_SE
			       , TO_CHAR(L.RCIV_DT, 'YYYY-MM-DD') RCIV_DT
			       , L.ARRRG_NO
			       , NVL(L.ARRRG_AMT,0) ARRRG_AMT
			       , L.REQEST_SEQ
			       , L.DEPTCD
			       , L.REG_USR
			       , TO_CHAR(L.REGIST_DT, 'YYYY-MM-DD') REGIST_DT
			       , L.UPD_USR
			       , TO_CHAR(L.UPDT_DT, 'YYYY-MM-DD') UPDT_DT
			       , L.PRT_AT_CODE
			       , (SELECT CD.CODE_NM FROM COMTCCMMNDETAILCODE CD WHERE CD.CODE_ID = 'GAM019' AND CD.CODE = L.PRT_AT_CODE AND ROWNUM = 1) PRT_AT_CODE_NM
						       , GAM_GETDEPTNAME(L.DEPTCD) DEPTCD_NM
						       , NVL(A.GR_AR,0) GR_AR
						       , TO_CHAR(A.GR_USAGE_PD_FROM, 'YYYY-MM-DD') GR_USAGE_PD_FROM
						       , TO_CHAR(A.GR_USAGE_PD_TO, 'YYYY-MM-DD') GR_USAGE_PD_TO
						       , TO_CHAR(A.PRMISN_DT, 'YYYY-MM-DD') PRMISN_DT
						       , NVL(A.GR_RDCXPT_FEE,0) GR_RDCXPT_FEE
			  FROM ASSETS_RENT_F A,
			       LEV_REQEST_F L
			 WHERE A.PRT_AT_CODE = L.PRT_AT_CODE
                	AND A.MNG_YEAR = L.MNG_YEAR
                    AND A.MNG_NO = L.MNG_NO
                    AND A.MNG_CNT = L.MNG_CNT
			   		AND A.QUAY_GROUP_CD='H'
			   		AND L.NHT_ISUE_YN='Y'
			        AND L.PRT_AT_CODE = #prtAtCode#
			        AND L.MNG_YEAR    = #mngYear#
			        AND L.MNG_NO      = #mngNo#
			        AND L.MNG_CNT     = #mngCnt#
			        AND L.CHRGE_KND  = #chrgeKnd#
			   ORDER BY L.NTIC_CNT ASC
    </select>

	<!-- 배후단지임대료납부상세 총고지금액, 총납부금액, 관리비, 연체료, 과태료 정보 -->
    <select id="gamHtldRentFeePaySttusMngtDao.selectHtldRentFeePaySttusMngtDetailSum_D" parameterClass="gamHtldRentFeePaySttusMngtVO" resultClass="egovMap">
		SELECT
			SUM(DECODE(L.CHRGE_KND, 'A1', 0, 'A3', 0, 'D1', 0, 'D2', 0, L.FEE)) FEE_AMOUNT,
			SUM(L.NTIC_AMT) TOTAL_NTIC_AMOUNT,
			SUM(DECODE(L.RCIV_SE, '3', L.FEE, 0)) FEE_PAY_AMOUNT,
			SUM(DECODE(L.CHRGE_KND, 'A1', L.FEE, 0)) FEE_A1,
			SUM(DECODE(L.CHRGE_KND, 'A3', L.FEE, 0)) FEE_A3,
			SUM(DECODE(L.CHRGE_KND, 'D1', L.FEE, 0)) FEE_D1,
			SUM(DECODE(L.CHRGE_KND, 'D2', L.FEE, 0)) FEE_D2
		FROM ASSETS_RENT_F A,
			LEV_REQEST_F L
		WHERE A.PRT_AT_CODE = L.PRT_AT_CODE
			AND A.MNG_YEAR = L.MNG_YEAR
			AND A.MNG_NO = L.MNG_NO
			AND A.MNG_CNT = L.MNG_CNT
			AND A.QUAY_GROUP_CD='H'
			AND L.NHT_ISUE_YN='Y'
			AND L.PRT_AT_CODE = #prtAtCode#
			AND L.MNG_YEAR    = #mngYear#
			AND L.MNG_NO      = #mngNo#
			AND L.MNG_CNT     = #mngCnt#
    </select>
	
	<!-- 배후단지임대료납부상세 연체정보 -->
    <select id="gamHtldRentFeePaySttusMngtDao.selectNticArrrgDetail_S" parameterClass="gamHtldRentFeePaySttusMngtVO" resultClass="egovMap">
    <![CDATA[
			SELECT 
			    A.MNG_YEAR,
			    A.MNG_NO,
			    A.MNG_CNT,
			    A.NTICNO,
			    A.PRT_AT_CODE,
			    A.FEE_TP CHRGE_KND,
			    A.CHRGE_KND_NM,
			    A.FISCAL_YR ACCNUT_YEAR,
			    A.BILL_NO,
			    A.ACCNT_CODE,
			    A.ENTRPSCD,
			    A.ENTRPS_NM,
			    A.BILL_AMNT BILL_AMNT,
			    A.NTIC_DT,
			    TO_CHAR(SYSDATE+15, 'YYYY-MM-DD') DLY_DUE_DT,
			    TO_CHAR(SYSDATE, 'YYYY-MM-DD') DLY_BILL_DT,
			    A.ARRRG_TARIFF,
			    A.ARRRG_NO,
			    A.NEXT_ARRRG_NO,
			    A.FEE,
			    A.INTR_AMNT,
			    A.ADD_AMNT,
			    A.ADD_AMNT_RM,
			    A.VAT,
			    U.DLY_BILL_AMNT ARRRG_AMT,
			    U.DLY_BILL_RSN,
			    A.ICHE_STATUS,
			    A.ICHE_STATUS_NM,
			    A.BIZRNO,
			    A.RCIV_SE,
			    A.RSLT_CODE,
			    A.ORIGIN_FEE_TP,
			    A.ORIGIN_FISCAL_YR,
			    A.ORIGIN_BILL_NO
			    , U.BILL_NO DLY_BILL_NO
			    ,U.DLY_BILL_DT DB_DLY_BILL_DT
			FROM (
			        SELECT 
			          L.MNG_YEAR, 
			          L.MNG_NO, 
			          L.MNG_CNT,
			          L.NTICNO,
			          A.PRT_AT_CODE,
			          A.FEE_TP,
			          GAM_GET_FEE_TP_NM(A.PRT_AT_CODE, 'H', A.WORK_CODE) CHRGE_KND_NM,
			          A.FISCAL_YR,
			          A.BILL_NO,
			          A.ACCNT_CODE,
			          A.AGENT_CODE ENTRPSCD,
			          GAM_GETENTRPSNM(A.AGENT_CODE, '1') ENTRPS_NM,
			          A.BILL_AMNT,
			          TO_CHAR(A.BILL_DT,'YYYY-MM-DD') NTIC_DT,
			          TO_CHAR(A.DUE_DATE,'YYYY-MM-DD') DUE_DATE,
			          L.ARRRG_TARIFF,
			          L.ARRRG_NO,
			          NVL(L.ARRRG_NO, 0)+1 AS NEXT_ARRRG_NO,
			          L.FEE,
			          L.INTR_AMNT,
			          L.ADD_AMNT,
			          L.ADD_AMNT_RM,
			          L.VAT,
			          A.ICHE_STATUS,
			          '' ICHE_STATUS_NM,
			          A.BZ_RGST_ID BIZRNO,
			          A.RCVD_TP RCIV_SE,
			          A.RSLT_CODE,
			          A.ORIGIN_FEE_TP,
			          A.ORIGIN_FISCAL_YR,
			          A.ORIGIN_BILL_NO
			        FROM REV_COLL_F A, LEV_REQEST_F L
			        WHERE 
						A.PRT_AT_CODE = L.PRT_AT_CODE
			          AND A.FEE_TP        = GAM_GET_HTLD_FEE_TP(L.CHRGE_KND)
			          AND A.WORK_CODE = L.CHRGE_KND
			          AND A.FISCAL_YR     = L.ACCNUT_YEAR
			          AND A.BILL_NO       = L.NTICNO
			          AND L.PRT_AT_CODE = #prtAtCode#
			          AND L.MNG_YEAR = #mngYear#
			          AND L.MNG_NO = #mngNo#
			          AND L.MNG_CNT = #mngCnt#
			          AND L.NTIC_CNT = #nticCnt#
			          AND L.CHRGE_KND = #chrgeKnd#
			          AND L.PAY_TMLMT < TRUNC(SYSDATE)
			          AND (A.RCVD_TP = '0' OR A.RCVD_TP IS NULL)
			          AND A.BILL_AMNT > 0
			          AND A.BILL_AMNT     IS NOT NULL
			    ) A
			LEFT OUTER JOIN UNPAID_F U ON A.PRT_AT_CODE=U.PRT_AT_CODE AND A.FEE_TP=U.FEE_TP AND A.FISCAL_YR=U.FISCAL_YR AND A.BILL_NO=U.BILL_NO 
				AND U.DLY_SER_NO=lpad(nvl(A.ARRRG_NO, 0)+1, 2, '0')
    	]]>
    </select>

	<!--  연체고지 등록 전 고지입력테이블과 연제고지테이블에서 관련 데이터 가져옴. 2015-11-27 김종민 버그 부분 수정 작업 -->
 	<select id="gamHtldRentFeePaySttusMngtDao.selectLevReqestUnpaidF_S" parameterClass="gamHtldRentArrrgMngtVO" resultClass="egovMap">
		SELECT
			L.PRT_AT_CODE,
			L.MNG_YEAR,
			L.MNG_NO,
			L.MNG_CNT,
			L.NTIC_CNT,
			L.FCLTY_SE,
			L.CHRGE_KND,
			L.ENTRPSCD,
			L.ENTRPS_NM,
			TO_CHAR(L.NTIC_PD_FROM, 'YYYY-MM-DD') NTIC_PD_FROM,
			TO_CHAR(L.NTIC_PD_TO, 'YYYY-MM-DD') NTIC_PD_TO,
			L.ACCNUT_YEAR,
			L.NTICNO,
			TO_CHAR(L.NTIC_DT, 'YYYY-MM-DD') NTIC_DT,
			TO_CHAR(L.PAY_TMLMT, 'YYYY-MM-DD') PAY_TMLMT,
			L.FEE,
			L.RDCXPT_FEE,
			L.VAT_YN,
			L.VAT,
			L.NTIC_AMT,
			L.RCIV_SE,
			L.RCIV_DT,
			L.NHT_ISUE_YN,
			L.NHT_PRINT_YN,
			#arrrgAmt# DLY_BILL_AMNT,
			#arrrgAmt# DBILL_AMNT,
			#newPayTmlmt# DLY_DUE_DT,
			(
				SELECT lpad(nvl(MAX(DLY_SER_NO), 0)+1, 2, '0') FROM UNPAID_F 
					WHERE PRT_AT_CODE=L.PRT_AT_CODE
					AND FISCAL_YR=L.ACCNUT_YEAR
					AND WORK_CODE=GAM_GET_HTLD_ARRRG_CHRGE_KND(L.CHRGE_KND)
					AND FEE_TP=GAM_GET_HTLD_FEE_TP(GAM_GET_HTLD_ARRRG_CHRGE_KND(L.CHRGE_KND))
					AND BILL_NO=L.NTICNO
			) DLY_SER_NO,
			TO_CHAR(
				NVL(
				(
					SELECT U.PRV_DUE_DT FROM UNPAID_F U
						WHERE U.PRT_AT_CODE=L.PRT_AT_CODE
						AND U.FISCAL_YR=L.ACCNUT_YEAR
						AND U.WORK_CODE=GAM_GET_HTLD_ARRRG_CHRGE_KND(L.CHRGE_KND)
						AND U.FEE_TP=GAM_GET_HTLD_FEE_TP(GAM_GET_HTLD_ARRRG_CHRGE_KND(L.CHRGE_KND))
						AND U.BILL_NO=L.NTICNO
						AND U.DLY_SER_NO = DLY_SER_NO
						AND ROWNUM = 1
				), L.PAY_TMLMT ), 
			'YYYY-MM-DD') PRV_DUE_DT,
			TO_CHAR(
				NVL(
				(
					SELECT U.PRV_BILL_DT FROM UNPAID_F U 
						WHERE U.PRT_AT_CODE=L.PRT_AT_CODE
						AND U.FISCAL_YR=L.ACCNUT_YEAR
						AND U.WORK_CODE=GAM_GET_HTLD_ARRRG_CHRGE_KND(L.CHRGE_KND)
						AND U.FEE_TP=GAM_GET_HTLD_FEE_TP(GAM_GET_HTLD_ARRRG_CHRGE_KND(L.CHRGE_KND))
						AND U.BILL_NO=L.NTICNO
						AND U.DLY_SER_NO = DLY_SER_NO
						AND ROWNUM = 1
				), L.NTIC_DT ), 
			'YYYY-MM-DD') PRV_BILL_DT,
			L.NTIC_MTH,
			#regUsr# REG_USR,
			SYSDATE REGIST_DT,
			#arrrgTariff# ARRRG_TARIFF, 
			TRUNC(SYSDATE-L.PAY_TMLMT) ARRRG_PAY_DATES,
			L.SETOFF_YN,
			L.PAYINST_INTRRATE,
			L.INTR_AMNT,
			L.INTR_CHRGE_KND,
			L.INTR_FEE_NTICNO,
			L.COFIX_OBJ_YRMT,
			L.INTR_RATE,
			#dlyBillDt# DLY_BILL_DT, 
			#dlyBillRsn# DLY_BILL_RSN, 
			#deptCd# DEPT_CD
		FROM LEV_REQEST_F L
		WHERE L.PRT_AT_CODE=#prtAtCode#
			AND L.MNG_YEAR=#mngYear#
			AND L.MNG_NO=#mngNo#
			AND L.MNG_CNT=#mngCnt#
			AND L.NTIC_CNT=#nticCnt#
    </select>

	<!--연체고지 등록 2015.11.27 김종민 수정작업 - TYPE안 맞는 부분 다 고침.-->
    <insert id="gamHtldRentFeePaySttusMngtDao.insertNticRequestUnpaidF_S" parameterClass="egovMap" >
        INSERT INTO UNPAID_F (
      		PRT_AT_CODE, FEE_TP, WORK_CODE, FISCAL_YR, BILL_NO,
      		DLY_SER_NO, DLY_BILL_AMNT, DLY_BILL_DT, DLY_DUE_DT, DLY_BILL_PRT_YN, DLY_RCVD_TP, <!-- DLY_RCVD_DT는 연체수납일자로 빼버림. 2015.11.27 김종민 -->
      		FIRST_BILL_DT, DBILL_AMNT,
      		BZ_RGST_ID,
      		DLY_BILL_RSN, UPDT_UID, UPDT_DATE,
      		AGENT_CODE, ACCNT_CODE, ICHE_STATUS, POST_BILL_YN, STR_DATE,END_DATE,
     		DEPT, EMPL, PRV_DUE_DT, DJIRO_AMNT, USER_NAME, PRV_BILL_DT
      	)
      		SELECT
        		L.PRT_AT_CODE, GAM_GET_HTLD_FEE_TP(GAM_GET_HTLD_ARRRG_CHRGE_KND(L.CHRGE_KND)), GAM_GET_HTLD_ARRRG_CHRGE_KND(L.CHRGE_KND), L.ACCNUT_YEAR, L.NTICNO,
        		#dlySerNo#, TO_NUMBER(#dlyBillAmnt#), TO_DATE(#dlyBillDt#, 'YYYY-MM-DD'), TO_DATE(#dlyDueDt#, 'YYYY-MM-DD'), 'N', '1',
      			TO_DATE(#nticDt#, 'YYYY-MM-DD'), TO_NUMBER(#dbillAmnt#),
      			GAM_GETENTRPSNM(L.ENTRPSCD, '2'),
      			#dlyBillRsn#, #regUsr#, SYSDATE,
      			L.ENTRPSCD, '194', 'N', 'N', TO_DATE(#nticPdFrom#, 'YYYY-MM-DD'), TO_DATE(#nticPdTo#, 'YYYY-MM-DD'),
      			#deptCd#, #emplNo#, TO_DATE(#prvDueDt#, 'YYYY-MM-DD'), TRUNC(NVL(L.FEE,0) + NVL(L.INTR_AMNT,0) + NVL(L.ADD_AMNT,0),-1) + NVL(L.VAT,0) +#dlyBillAmnt#, #userName#, TO_DATE(#prvBillDt#, 'YYYY-MM-DD')
     		FROM LEV_REQEST_F L
      		WHERE PRT_AT_CODE=#prtAtCode#
      			AND MNG_YEAR=#mngYear#
      			AND MNG_NO=#mngNo#
      			AND MNG_CNT=#mngCnt#
      			AND NTIC_CNT=#nticCnt#
      			AND CHRGE_KND=#chrgeKnd#
    </insert>

	<!-- 연체고지 입력 후 원고지 정보 업데이트 -->
	<update id="gamHtldRentFeePaySttusMngtDao.updateLevReqestArrrgAmt_S" parameterClass="egovMap">
        UPDATE LEV_REQEST_F SET
        	NTIC_DT=TO_DATE(#dlyBillDt#, 'YYYY-MM-DD'),
        	PAY_TMLMT=TO_DATE(#dlyDueDt#, 'YYYY-MM-DD'),
      		ARRRG_NO=#dlySerNo#,
      		ARRRG_AMT=TRUNC(TO_NUMBER(#dlyBillAmnt#), 0),
      		ARRRG_TARIFF=TO_NUMBER(#arrrgTariff#),
      		ARRRG_PAY_DATES=#applyPayDates#,
      		NTIC_AMT=TRUNC(NVL(FEE,0)+NVL(INTR_AMNT,0)+NVL(ADD_AMNT,0),-1)+NVL(VAT,0)+TO_NUMBER(#dbillAmnt#),
      		<isNotNull property="rcivSe">
      		RCIV_SE=#rcivSe#,
      		</isNotNull>
      		UPD_USR=#regUsr#,
      		UPDT_DT=SYSDATE
     	WHERE
			PRT_AT_CODE=#prtAtCode#
	      	AND MNG_YEAR=#mngYear#
	      	AND MNG_NO=#mngNo#
	      	AND MNG_CNT=#mngCnt#
	      	AND NTIC_CNT=#nticCnt#
	      	AND CHRGE_KND=#chrgeKnd#
	</update>

	<!-- 배후단지임대료연체현황관리 연체목록  -->
    <select id="gamHtldRentFeePaySttusMngtDao.selectHtldRentFeePaySttusMngtDlyList_D" parameterClass="gamHtldRentFeePaySttusMngtVO" resultClass="egovMap">
			SELECT
				U.PRT_AT_CODE
				,U.FEE_TP
				,U.FISCAL_YR
				,U.BILL_NO
				,U.WORK_CODE
				,U.DLY_SER_NO
				,U.AGENT_CODE
				,U.BZ_RGST_ID
				,U.DLY_BILL_AMNT
				,U.DBILL_AMNT
				,U.DJIRO_AMNT
				,TO_CHAR(U.DLY_BILL_DT, 'YYYY-MM-DD') AS DLY_BILL_DT
				,U.DLY_BILL_PRT_YN
				,U.DLY_BILL_RSN
				,TO_CHAR(U.DLY_DUE_DT, 'YYYY-MM-DD') AS DLY_DUE_DT
				,TO_CHAR(U.FIRST_BILL_DT, 'YYYY-MM-DD') AS FIRST_BILL_DT
				,TO_CHAR(U.DLY_RCVD_DT, 'YYYY-MM-DD') AS DLY_RCVD_DT
				,U.DC_RATE
				,TO_CHAR(U.RECPT_EPDT, 'YYYY-MM-DD') AS RECPT_EPDT
				,U.STR_DATE
				,U.END_DATE
				,GAM_GETCODENAME('GAM019', U.PRT_AT_CODE) PRT_KOR_NM
				,GAM_GETCODENAME('GAM025', U.WORK_CODE) FEE_TP_KOR_NM
				,GAM_GETENTRPSNM(U.AGENT_CODE, '1') FIRM_KOR_NM
			FROM
				LEV_REQEST_F L, UNPAID_F U
			WHERE 1=1
	           AND L.PRT_AT_CODE=U.PRT_AT_CODE
	           AND L.ACCNUT_YEAR=U.FISCAL_YR
	           AND GAM_GET_HTLD_ARRRG_CHRGE_KND(L.CHRGE_KND)=U.WORK_CODE
	           AND L.NTICNO=U.BILL_NO
				<isNotEmpty property="prtAtCode">
                    AND U.PRT_AT_CODE = #prtAtCode#
                </isNotEmpty>
                <isNotEmpty property="chrgeKnd">
                    AND U.FEE_TP = GAM_GET_HTLD_FEE_TP(GAM_GET_HTLD_ARRRG_CHRGE_KND(#chrgeKnd#))
                				AND U.WORK_CODE = GAM_GET_HTLD_ARRRG_CHRGE_KND(#chrgeKnd#)
                </isNotEmpty>
                <isNotEmpty property="accnutYear">
                    AND U.FISCAL_YR = #accnutYear#
                </isNotEmpty>
                <isNotEmpty property="nticno">
                    AND U.BILL_NO = #nticno#
                </isNotEmpty>
			ORDER BY
				U.DLY_SER_NO				
    </select>

	<!-- 배후단지임대료연체현황관리 연체자료수 -->
    <select id="gamHtldRentFeePaySttusMngtDao.selectHtldRentFeePaySttusMngtDlyListTotCnt_S" parameterClass="gamHtldRentFeePaySttusMngtVO" resultClass="int">
            SELECT COUNT(*) totcnt
			FROM
				UNPAID_F U
			WHERE 1=1
				<isNotEmpty property="prtAtCode">
                    AND U.PRT_AT_CODE = #prtAtCode#
                </isNotEmpty>
                <isNotEmpty property="chrgeKnd">
                    AND U.FEE_TP = GAM_GET_HTLD_FEE_TP(GAM_GET_HTLD_ARRRG_CHRGE_KND(#chrgeKnd#))
                				AND U.WORK_CODE = GAM_GET_HTLD_ARRRG_CHRGE_KND(#chrgeKnd#)
                </isNotEmpty>
                <isNotEmpty property="accnutYear">
                    AND U.FISCAL_YR = #accnutYear#
                </isNotEmpty>
                <isNotEmpty property="nticno">
                    AND U.BILL_NO = #nticno#
                </isNotEmpty>
			ORDER BY
				U.DLY_SER_NO
    </select>

	<!-- 배후단지임대료연체현황관리 자료수 연체고지금액합계 -->
    <select id="gamHtldRentFeePaySttusMngtDao.selectHtldRentFeePaySttusMngtDlyListSum_D" parameterClass="gamHtldRentFeePaySttusMngtVO" resultClass="egovMap">
            SELECT
            	TRIM(TO_CHAR(COUNT(*), '999,999,999,999')) AS DP_TOT_CNT
            	,TRIM(TO_CHAR(NVL(SUM(U.DLY_BILL_AMNT),0), '999,999,999,999')) AS SUM_DLY_BILL_AMNT
			FROM
				UNPAID_F U
			WHERE 1=1
				<isNotEmpty property="prtAtCode">
                    AND U.PRT_AT_CODE = #prtAtCode#
                </isNotEmpty>
                <isNotEmpty property="chrgeKnd">
                    AND U.FEE_TP = GAM_GET_HTLD_FEE_TP(GAM_GET_HTLD_ARRRG_CHRGE_KND(#chrgeKnd#))
                				AND U.WORK_CODE = GAM_GET_HTLD_ARRRG_CHRGE_KND(#chrgeKnd#)
                </isNotEmpty>
                <isNotEmpty property="accnutYear">
                    AND U.FISCAL_YR = #accnutYear#
                </isNotEmpty>
                <isNotEmpty property="nticno">
                    AND U.BILL_NO = #nticno#
                </isNotEmpty>
			ORDER BY
				U.DLY_SER_NO
    </select>
	
	<!-- 배후단지임대료연체현황 목록 연체정보 -->
    <select id="gamHtldRentFeePaySttusMngtDao.selectHtldRentFeePaySttusMngtDlyInfo_S" resultClass="egovMap">
			SELECT
				U.PRT_AT_CODE
				,U.FEE_TP
				,U.FISCAL_YR
				,U.BILL_NO
				,U.DLY_SER_NO
				,U.AGENT_CODE
				,U.BZ_RGST_ID
				,TRUNC(NVL(L.FEE, 0) + NVL(L.INTR_AMNT, 0) + NVL(L.ADD_AMNT, 0), -1) AS SUPPLY_AMNT
				,L.VAT
				,U.DLY_BILL_AMNT
				,TO_CHAR(U.DLY_BILL_DT, 'YYYY-MM-DD') AS DLY_BILL_DT
				,U.DLY_BILL_PRT_YN
				,U.DLY_BILL_RSN
				,TO_CHAR(U.DLY_DUE_DT, 'YYYY-MM-DD') AS DLY_DUE_DT
				,TO_CHAR(U.FIRST_BILL_DT, 'YYYY-MM-DD') AS FIRST_BILL_DT
				,TO_CHAR(U.DLY_RCVD_DT, 'YYYY-MM-DD') AS DLY_RCVD_DT
				,U.DC_RATE
				,TO_CHAR(U.RECPT_EPDT, 'YYYY-MM-DD') AS RECPT_EPDT
				,U.STR_DATE
				,U.END_DATE
				,U.WORK_CODE CHRGE_KND
				,(SELECT F.FEE_TP_KOR_NM FROM FEE_TP_F F WHERE F.FEE_TP = U.WORK_CODE) FEE_TP_KOR_NM
				,GAM_GETCODENAME('GAM019', U.PRT_AT_CODE) PRT_KOR_NM
				,GAM_GETENTRPSNM(U.AGENT_CODE, '1') FIRM_KOR_NM
			FROM
				LEV_REQEST_F L, UNPAID_F U
			WHERE 1=1
	           AND L.PRT_AT_CODE=U.PRT_AT_CODE
	           AND L.ACCNUT_YEAR=U.FISCAL_YR
	           AND GAM_GET_HTLD_ARRRG_CHRGE_KND(L.CHRGE_KND)=U.WORK_CODE
	           AND L.NTICNO=U.BILL_NO
				<isNotEmpty property="prtAtCode">
                    AND U.PRT_AT_CODE = #prtAtCode#
                </isNotEmpty>
                <isNotEmpty property="chrgeKnd">
                    AND U.FEE_TP = GAM_GET_HTLD_FEE_TP(GAM_GET_HTLD_ARRRG_CHRGE_KND(#chrgeKnd#))
                				AND U.WORK_CODE = GAM_GET_HTLD_ARRRG_CHRGE_KND(#chrgeKnd#)
                </isNotEmpty>
                <isNotEmpty property="accnutYear">
                    AND U.FISCAL_YR = #accnutYear#
                </isNotEmpty>
                <isNotEmpty property="nticno">
                    AND U.BILL_NO = #nticno#
                </isNotEmpty>
                <isNotEmpty property="dlySerNo">
                    AND U.DLY_SER_NO = #dlySerNo#
                </isNotEmpty>
    </select>

	<select id="gamHtldRentFeePaySttusMngtDao.selectP2RevArrrgAnlrveLevMgtRevInfo" parameterClass="map" resultClass="egovMap">
            /*+ gamHtldRentFeePaySttusMngtDao.selectP2RevArrrgAnlrveLevMgtRevInfo */
            SELECT 1 row_count,
                   NVL(a.bill_amnt,0) bill_amnt,
                   TO_CHAR(a.due_date, 'YYYYMMDD') due_date,
                   a.agent_name,
                   a.vssl_kor_nm,
                   TO_CHAR(a.bill_dt, 'YYYYMMDD') bill_dt,
                   a.agent_code,
                   GAM_GETENTRPSNM(a.agent_code, '1') agent_nm,
                   a.bz_rgst_id,
                   a.accnt_code,
                   CRYPTIT.DECRYPT(a.ssn,'SSN') ssn,
                   NVL(a.iche_status,'N') iche_status,
                   TO_CHAR(a.rcvd_dt, 'YYYYMMDD') rcvd_dt,
                   a.rcvd_tp,
                   NVL(a.vat,0) vat,
                   NVL(a.vat_yn,'0') vat_yn,
                   NVL(a.bill_amnt,0) + NVL(a.vat,0) sum_bill_amnt,
                   TO_CHAR(sysdate,'YYYYMMDD') cur_date
              FROM REV_COLL_F a
             WHERE prt_at_code = #prt_at_code#
               AND fee_tp      = #fee_tp#
               AND fiscal_yr   = #fiscal_yr#
               AND bill_no     = #bill_no#
    </select>

    <select id="gamHtldRentFeePaySttusMngtDao.selectNticArrrgList_D" parameterClass="gamHtldRentFeePaySttusMngtVO" resultClass="egovMap">
    	SELECT Z.* FROM (
           SELECT ROWNUM RNUM,
           A.MNG_YEAR,
           A.MNG_NO,
           A.MNG_CNT,
           A.NTICNO,
           A.PRT_AT_CODE,
           A.CHRGE_KND,
           A.CHRGE_KND_NM,
           A.ACCNUT_YEAR,
           A.BILL_NO,
           A.ACCNT_CODE,
           A.ENTRPSCD,
           A.ENTRPS_NM,
           A.NTIC_AMT,
           A.NTIC_DT,
           A.PAY_TMLMT,
           A.ARRRG_DATES,
           TO_CHAR(A.NEW_PAY_TMLMT, 'YYYY-MM-DD') NEW_PAY_TMLMT,
           (A.ARRRG_DATES+15) APPLY_PAY_DATES,
           TO_CHAR(A.ARRRG_RATE*100, '999.00') ARRRG_RATE,
           TRUNC(A.NTIC_AMT+A.NTIC_AMT*(A.ARRRG_DATES+15)/365*(A.ARRRG_RATE),-1) ARRRG_AMT,
           A.ICHE_STATUS,
           A.ICHE_STATUS_NM,
           A.BIZRNO,
           A.RCIV_SE,
           A.RSLT_CODE,
           A.ORIGIN_FEE_TP,
           A.ORIGIN_FISCAL_YR,
           A.ORIGIN_BILL_NO
           FROM (
	     SELECT L.MNG_YEAR, L.MNG_NO, L.MNG_CNT,
		       L.NTICNO,
		       A.PRT_AT_CODE,
               A.FEE_TP CHRGE_KND,
               GAM_GET_FEE_TP_NM(A.PRT_AT_CODE, 'H', A.WORK_CODE) CHRGE_KND_NM,
               A.FISCAL_YR AS ACCNUT_YEAR,
               A.BILL_NO,
               A.ACCNT_CODE,
               A.AGENT_CODE ENTRPSCD,
               GAM_GETENTRPSNM(A.AGENT_CODE, '1') ENTRPS_NM,
               A.BILL_AMNT NTIC_AMT,
               TO_CHAR(A.BILL_DT,'YYYY-MM-DD') NTIC_DT,
               TO_CHAR(A.DUE_DATE,'YYYY-MM-DD') PAY_TMLMT,
               trunc(SYSDATE-PAY_TMLMT) ARRRG_DATES,
               (SYSDATE+15) NEW_PAY_TMLMT,
               TO_NUMBER(#arrrgTariff#)/100 ARRRG_RATE,
               A.ICHE_STATUS,
               '' ICHE_STATUS_NM,
               A.BZ_RGST_ID BIZRNO,
               A.RCVD_TP RCIV_SE,
               A.RSLT_CODE,
               A.ORIGIN_FEE_TP,
               A.ORIGIN_FISCAL_YR,
               A.ORIGIN_BILL_NO
    FROM REV_COLL_F A, ASSETS_RENT_F AR,
      LEV_REQEST_F L
    WHERE A.PRT_AT_CODE = #prtAtCode#
    AND A.PRT_AT_CODE   = L.PRT_AT_CODE
    AND A.FEE_TP        = GAM_GET_HTLD_FEE_TP(L.CHRGE_KND)
    AND A.WORK_CODE = L.CHRGE_KND
    AND A.FISCAL_YR     = L.ACCNUT_YEAR
    AND A.BILL_NO       = L.NTICNO
          AND AR.PRT_AT_CODE = L.PRT_AT_CODE
          AND AR.MNG_YEAR = L.MNG_YEAR
          AND AR.MNG_NO = L.MNG_NO
          AND AR.MNG_CNT = L.MNG_CNT
          AND AR.QUAY_GROUP_CD = 'H'
        <isNotEmpty property="payTmlmtFrom">
          AND A.DUE_DATE      &gt;= TO_DATE(#payTmlmtFrom#,'YYYY-MM-DD')
        </isNotEmpty>
        <isNotEmpty property="payTmlmtTo">
          AND A.DUE_DATE      &lt; TO_DATE(#payTmlmtTo#,'YYYY-MM-DD') + 1
        </isNotEmpty>
        <isEqual property="rcivSe" compareValue="0">
          AND (A.RCVD_TP      = '0' OR A.RCVD_TP IS NULL)
        </isEqual>
        <isNotEqual property="rcivSe" compareValue="0">
          AND A.RCVD_TP       = #rcivSe#
        </isNotEqual>
        <![CDATA[
             AND A.BILL_AMNT > 0
         ]]>
          AND A.BILL_AMNT     IS NOT NULL
<!--           AND A.BILL_PRT_YN   = 'Y' -->
          <isNotEmpty property="entrpscd">
          AND A.AGENT_CODE    = #entrpscd#
        </isNotEmpty>
        <isNotEmpty property="chrgeKnd">
          AND A.FEE_TP        = GAM_GET_HTLD_FEE_TP(#chrgeKnd#)
          AND A.WORK_CODE = #chrgeKnd#
    	</isNotEmpty>
        ORDER BY A.FEE_TP ASC, A.BILL_NO ASC
		) A
		) Z
    <![CDATA[
        WHERE RNUM <= #recordCountPerPage# and RNUM > #firstIndex#
      ]]>
    </select>

    <select id="gamHtldRentFeePaySttusMngtDao.selectNticArrrgListTotCnt_S" parameterClass="gamHtldRentArrrgMngtVO" resultClass="int">
          SELECT COUNT(*) totcnt
				FROM   REV_COLL_F A, ASSETS_RENT_F AR, LEV_REQEST_F L
        WHERE A.PRT_AT_CODE   = #prtAtCode#
          AND A.PRT_AT_CODE = L.PRT_AT_CODE
          AND A.FEE_TP = GAM_GET_HTLD_FEE_TP(L.CHRGE_KND)
          AND A.WORK_CODE = L.CHRGE_KND
          AND A.FISCAL_YR = L.ACCNUT_YEAR
          AND A.BILL_NO = L.NTICNO
          AND AR.PRT_AT_CODE = L.PRT_AT_CODE
          AND AR.MNG_YEAR = L.MNG_YEAR
          AND AR.MNG_NO = L.MNG_NO
          AND AR.MNG_CNT = L.MNG_CNT
          AND AR.QUAY_GROUP_CD = 'H'
        <isNotEmpty property="payTmlmtFrom">
          AND A.DUE_DATE      &gt;= TO_DATE(#payTmlmtFrom#,'YYYY-MM-DD')
        </isNotEmpty>
        <isNotEmpty property="payTmlmtTo">
          AND A.DUE_DATE      &lt; TO_DATE(#payTmlmtTo#,'YYYY-MM-DD') + 1
        </isNotEmpty>
        <isEqual property="rcivSe" compareValue="0">
          AND (A.RCVD_TP      = '0' OR A.RCVD_TP IS NULL)
        </isEqual>
        <isNotEqual property="rcivSe" compareValue="0">
          AND A.RCVD_TP       = #rcivSe#
        </isNotEqual>
        <![CDATA[
             AND A.BILL_AMNT > 0
         ]]>
          AND A.BILL_AMNT     IS NOT NULL
<!--           AND A.BILL_PRT_YN   = 'Y' -->
          <isNotEmpty property="entrpscd">
          AND A.AGENT_CODE    = #entrpscd#
        </isNotEmpty>
        <isNotEmpty property="chrgeKnd">
          AND A.FEE_TP        = GAM_GET_HTLD_FEE_TP(#chrgeKnd#)
          AND A.WORK_CODE        = #chrgeKnd#
    	</isNotEmpty>
    </select>

   	<update id="gamHtldRentFeePaySttusMngtDao.updateNticArrrgList">
       	<![CDATA[
			UPDATE LEV_REQEST_F L
			SET ARRRG_NO=#arrrgNo#,
				ARRRG_AMT=#arrrgAmt#,
				ARRRG_TARIFF=#arrrgTariff#
			WHERE
					L.PRT_AT_CODE = #prtAtCode#
					, L.ACCNUT_YEAR = #accnutYear#
					, L.NTICNO = #nticno#
					, L.CHRGE_KND = #chrgeKnd#
					, L.ENTRPSCD = #entrpscd#
       	]]>
	</update>


    <insert id="gamHtldRentFeePaySttusMngtDao.insertUnpaidArrrg_S" parameterClass="hashMap">

    </insert>


	<select id="gamHtldRentFeePaySttusMngtDao.selectArrrglevReqestPk_S" parameterClass="gamHtldRentFeePaySttusMngtVO" resultClass="egovMap">
		SELECT
		  PRT_AT_CODE,
		  MNG_YEAR,
		  MNG_NO,
		  MNG_CNT,
		  NTIC_CNT,
		  FCLTY_SE,
		  CHRGE_KND,
		  ENTRPSCD,
		  ENTRPS_NM,
		  TO_CHAR(NTIC_PD_FROM, 'YYYY-MM-DD') NTIC_PD_FROM,
		  TO_CHAR(NTIC_PD_TO, 'YYYY-MM-DD') NTIC_PD_TO,
		  ACCNUT_YEAR,
		  NTICNO,
		  NTIC_DT,
		  PAY_TMLMT,
		  TO_CHAR(p2mgr.sf_get_wrk_dt@ygpa_portmis(SYSDATE+15), 'YYYY-MM-DD') NEW_PAY_TMLMT,
		  FEE,
		  VAT_YN,
		  VAT,
		  NTIC_AMT,
		  RCIV_SE,
		  RCIV_DT,
		  NHT_ISUE_YN,
		  NHT_PRINT_YN,
		  ARRRG_NO,
		  ARRRG_AMT,
		  REQEST_SEQ,
		  DEPTCD,
		  NTIC_MTH,
		  REG_USR,
		  REGIST_DT,
		  UPD_USR,
		  UPDT_DT,
		  RDCXPT_FEE,
		  ARRRG_TARIFF,
		  ARRRG_PAY_DATES,
		  MNG_FEE,
		  FACIL_MNG_FEE,
		  ADIT_NTIC_YN,
		  SETOFF_YN,
		  PAYINST_INTRRATE,
		  INTR_AMNT,
		  INTR_CHRGE_KND,
		  INTR_FEE_NTICNO,
		  COFIX_OBJ_YRMT,
		  INTR_RATE
		FROM LEV_REQEST_F
		WHERE PRT_AT_CODE=#prtAtCode#
		and MNG_YEAR=#mngYear#
		and mng_no=#mngNo#
		and mng_cnt=#mngCnt#
		and ntic_cnt=#nticCnt#
    </select>
	
  <update id="gamHtldRentFeePaySttusMngtDao.updateUnpaidFBillPrintYn" parameterClass="hashMap">
    <![CDATA[
        UPDATE UNPAID_F SET
      		DLY_BILL_PRT_YN=#nhtPrintYn#
      		WHERE (PRT_AT_CODE, WORK_CODE, FISCAL_YR, BILL_NO, DLY_SER_NO)
            IN (
              SELECT PRT_AT_CODE, CHRGE_KND, ACCNUT_YEAR, NTICNO, ARRRG_NO
              FROM LEV_REQEST_F
              WHERE 1=1
              		AND PRT_AT_CODE=#prtAtCode#
			      	AND MNG_YEAR=#mngYear#
			      	AND MNG_NO=#mngNo#
			      	AND MNG_CNT=#mngCnt#
			      	AND NTIC_CNT=#nticCnt#
			      	AND CHRGE_KND=#chrgeKnd#
                AND ARRRG_NO IS NOT NULL
            )
            AND dly_rcvd_tp<>'3'
            ]]>
  </update>


	<select id="gamHtldRentFeePaySttusMngtDao.selectHtldShowFeePayPopup_S" parameterClass="GamPrtFcltyRentFeePaySttusMngtVO" resultClass="egovMap">
       SELECT L.NTIC_CNT
		 , L.FCLTY_SE
		 , L.CHRGE_KND
		 , L.ENTRPSCD
		 , L.ENTRPS_NM
		 , TO_CHAR(L.NTIC_PD_FROM, 'YYYY-MM-DD') NTIC_PD_FROM
		 , TO_CHAR(L.NTIC_PD_TO, 'YYYY-MM-DD') NTIC_PD_TO
		 , L.ACCNUT_YEAR
		 , L.NTICNO
		 , TO_CHAR(L.NTIC_DT, 'YYYY-MM-DD') NTIC_DT
		 , TO_CHAR(L.PAY_TMLMT, 'YYYY-MM-DD') PAY_TMLMT
		 , L.SANCTN_STTUS
		 , L.SANCTNER_EMPL_NO
		 , TO_CHAR(L.SANCTN_DT) SANCTN_DT
		 , GAM_GETCODENAME('GAM046', L.SANCTN_STTUS) SANCTN_STTUS_NM
		 , NVL(L.OLNLP,0) OLNLP
		 , NVL(L.FEE,0) FEE
		 , L.VAT_YN
		 , NVL(L.VAT,0) VAT
		 , NVL(L.NTIC_AMT,0) NTIC_AMT
		 , L.RM
		 , L.RCIV_SE
		 , TO_CHAR(L.RCIV_DT, 'YYYY-MM-DD') RCIV_DT
		 , L.ARRRG_NO
		 , NVL(L.ARRRG_AMT,0) ARRRG_AMT
		 , L.REQEST_SEQ
		 , L.DEPTCD
		 , L.NTIC_MTH
		 , L.REG_USR
		 , TO_CHAR(L.REGIST_DT, 'YYYY-MM-DD') REGIST_DT
		 , L.UPD_USR
		 , TO_CHAR(L.UPDT_DT, 'YYYY-MM-DD') UPDT_DT
		 , L.PRT_AT_CODE
		 , L.MNG_YEAR
		 , L.MNG_NO
		 , L.MNG_CNT
		 , (SELECT CD.CODE_NM FROM COMTCCMMNDETAILCODE CD WHERE CD.CODE_ID = 'GAM019' AND CD.CODE = L.PRT_AT_CODE AND ROWNUM = 1) PRT_AT_CODE_NM
		 , GAM_GET_FEE_TP_NM(L.PRT_AT_CODE, 'G', L.CHRGE_KND) CHRGE_KND_NM
		 , R.RCVD_TP
		 , R.RCVD_DT
		 , R.FEE_TP
		 , R.WORK_CODE
		FROM LEV_REQEST_F L, REV_COLL_F R
		WHERE 1          =1
		AND L.PRT_AT_CODE=#prtAtCode#
		AND L.MNG_YEAR   =#mngYear#
		AND L.MNG_NO     =#mngNo#
		AND L.MNG_CNT    =#mngCnt#
		AND L.NTIC_CNT   =#nticCnt#
		AND L.CHRGE_KND  =#chrgeKnd#
		AND R.PRT_AT_CODE=L.PRT_AT_CODE
		AND R.FISCAL_YR=L.ACCNUT_YEAR
		AND R.bill_no   =L.nticno
		AND R.work_code     =L.chrge_knd
		AND R.fee_tp    = GAM_GET_HTLD_FEE_TP(l.chrge_knd)
		AND R.OCR_DT IS NULL
	</select>

    <select id="gamHtldRentFeePaySttusMngtDao.selectLevReqestArrrgAmt" parameterClass="map" resultClass="egovMap">
			SELECT L.NTIC_AMT,
				L.FEE,
				L.PRT_AT_CODE,
				L.CHRGE_KND,
				L.ACCNUT_YEAR, 
				L.NTICNO,
				<![CDATA[
					CASE WHEN PAY_TMLMT<TO_DATE('20141106', 'YYYYMMDD') THEN 'O' ELSE 'P' END PAY_PASS_CHECK,
				]]>
			  NVL(L.ARRRG_AMT, 0) ARRRG_AMT,
			  U.DLY_BILL_PRT_YN,
			  U.PRT_AT_CODE,
			  U.FEE_TP,
			  U.WORK_CODE,
			  U.FISCAL_YR,
			  U.BILL_NO,
			  U.DLY_SER_NO,
			  U.FIRST_BILL_DT,
			  U.ARRRG_TARIFF,
			  U.ARRRG_PAY_DATES,
			  U.DLY_BILL_AMNT,
			  U.DBILL_AMNT,
			  TO_CHAR(U.PRV_DUE_DT, 'YYYY-MM-DD') PRV_DUE_DT,
			  TO_CHAR(U.PRV_BILL_DT, 'YYYY-MM-DD') PRV_BILL_DT,
			  TO_CHAR(U.FIRST_BILL_DT, 'YYYY-MM-DD') FIRST_BILL_DT
			FROM LEV_REQEST_F L, UNPAID_F U
             WHERE L.prt_at_code = #prtAtCode#
               AND L.MNG_YEAR = #mngYear#
               AND L.MNG_NO = #mngNo#
               AND L.MNG_CNT = #mngCnt#
               AND L.NTIC_CNT = #nticCnt#
	           AND L.PRT_AT_CODE=U.PRT_AT_CODE
	           AND L.ACCNUT_YEAR=U.FISCAL_YR
	           AND U.WORK_CODE=GAM_GET_HTLD_ARRRG_CHRGE_KND(L.CHRGE_KND)
	           AND L.NTICNO=U.BILL_NO
             ORDER BY U.DLY_SER_NO DESC
    </select>

    <update id="gamHtldRentFeePaySttusMngtDao.updateUnpaidPrintYn" parameterClass="map">
            UPDATE UNPAID_F
            SET DLY_BILL_PRT_YN='N'
            WHERE
            	PRT_AT_CODE=#prtAtCode#
            	AND FEE_TP=#feeTp#
            	AND WORK_CODE=#workCode#
            	AND FISCAL_YR=#fiscalYr#
            	AND BILL_NO=#billNo#
            	AND DLY_SER_NO=#dlySerNo#
    </update>
	
	<!-- 최초연체고지취소를 위한 원고지정보변경. -->
    <update id="gamHtldRentFeePaySttusMngtDao.updateLevReqestUnarrrgAmt" parameterClass="hashMap">
        UPDATE LEV_REQEST_F SET
      		RCIV_SE='0',
      		ARRRG_NO=NULL,
      		ARRRG_AMT=NULL,
      		ARRRG_TARIFF=NULL,
      		ARRRG_PAY_DATES=NULL,
      		<!-- NTIC_DT=#prvBillDt#, -->
      		NTIC_AMT=TRUNC(NVL(FEE,0)+NVL(INTR_AMNT,0)+NVL(ADD_AMNT,0),-1)+NVL(VAT,0),
      		PAY_TMLMT=TO_DATE(#dlyDueDt#, 'YYYY-MM-DD'),
      		UPD_USR=#updUsr#,
      		UPDT_DT=SYSDATE
     	WHERE
			PRT_AT_CODE=#prtAtCode#
	      	AND MNG_YEAR=#mngYear#
	      	AND MNG_NO=#mngNo#
	      	AND MNG_CNT=#mngCnt#
	      	AND NTIC_CNT=#nticCnt#
	      	AND CHRGE_KND=#chrgeKnd#
  </update>

	<!-- 최초연체가 아닌 연체고지취소를 위한 원고지정보변경. -->
  <update id="gamHtldRentFeePaySttusMngtDao.updateLevReqestArrrgAmt" parameterClass="hashMap">
        UPDATE LEV_REQEST_F SET
        	NTIC_DT=TO_DATE(#dlyBillDt#, 'YYYY-MM-DD'),
        	PAY_TMLMT=TO_DATE(#dlyDueDt#, 'YYYY-MM-DD'),
      		ARRRG_NO=#dlySerNo#,
      		ARRRG_AMT=TO_NUMBER(#dbillAmnt#),
      		ARRRG_TARIFF=TO_NUMBER(#arrrgTariff#),
      		ARRRG_PAY_DATES=TO_NUMBER(#applyPayDates#),
      		NTIC_AMT=TRUNC(NVL(FEE,0)+NVL(INTR_AMNT,0)+NVL(ADD_AMNT,0),-1)+NVL(VAT,0)+TO_NUMBER(#dlyBillAmnt#),
      		<isNotNull property="rcivSe">
	      		RCIV_SE=#rcivSe#,
      		</isNotNull>
      		UPD_USR=#updUsr#,
      		UPDT_DT=SYSDATE
     	WHERE
			PRT_AT_CODE=#prtAtCode#
	      	AND MNG_YEAR=#mngYear#
	      	AND MNG_NO=#mngNo#
	      	AND MNG_CNT=#mngCnt#
	      	AND NTIC_CNT=#nticCnt#
	      	AND CHRGE_KND=#chrgeKnd#
  </update>
	
	<!-- 연체정보 삭제 -->
    <delete id="gamHtldRentFeePaySttusMngtDao.deleteUnpaidByPk" parameterClass="hashMap" >
            DELETE FROM UNPAID_F WHERE (PRT_AT_CODE, FEE_TP, WORK_CODE, FISCAL_YR, BILL_NO) IN
     (
     	SELECT
              PRT_AT_CODE, GAM_GET_HTLD_FEE_TP(GAM_GET_HTLD_ARRRG_CHRGE_KND(CHRGE_KND)), GAM_GET_HTLD_ARRRG_CHRGE_KND(CHRGE_KND), ACCNUT_YEAR, NTICNO
		FROM LEV_REQEST_F
      	WHERE PRT_AT_CODE=#prtAtCode#
	      	AND MNG_YEAR=#mngYear#
	      	AND MNG_NO=#mngNo#
	      	AND MNG_CNT=#mngCnt#
	      	AND NTIC_CNT=#nticCnt#
	      	AND CHRGE_KND=#chrgeKnd#
      	)
      	AND DLY_SER_NO=#dlySerNo#
    </delete>

	<!-- 연체고지서 마스터 데이터 조회 -->
    <select id="gamHtldRentFeePaySttusMngtDao.selectNticPrintMaster_D" parameterClass="hashMap" resultClass="egovMap">
		SELECT Z.*
		FROM
		  (SELECT ROWNUM RNUM,
		    P2MGR.sf_makedigit@YGPA_P2MGR(A.PRT_AT_CODE
		    || ASCII(SUBSTR(A.FEE_TP,1,1))
		    || SUBSTR(A.FEE_TP,2,1)
		    || A.FISCAL_YR
		    || A.BILL_NO
		    || NVL(A.ARRRG_NO, '0'),'BILLNO') CSTMR_REF_CODE,
		    (SELECT DECODE(A.PRT_AT_CODE, '620', '1', '621', '2', '3')
		      || FEE_TP_MAP
		      || SUBSTR(A.FISCAL_YR, 3,2)
		      || A.BILL_NO
		      || NVL(A.ARRRG_NO, '00')
		    FROM P2MGR.FEE_TP_F@YGPA_P2MGR
		    WHERE PRT_AT_CODE = A.PRT_AT_CODE
		    AND FEE_TP        = A.FEE_TP
		    ) ELEC_PAY_NO,
		    DECODE(A.PRT_AT_CODE, '622', '6374594', '6374604') GIRO_NO,
		    P2MGR.sf_makedigit@YGPA_P2MGR(A.DJIRO_AMNT, 'AMT') ELEC_NTIC_AMT,
		    A.*
		  FROM
		    (
		    SELECT U.PRT_AT_CODE,
		      U.FISCAL_YR,
		      U.FEE_TP,
		      U.BILL_NO,
		      U.DJIRO_AMNT,
		      U.DLY_BILL_AMNT,
		      U.DLY_BILL_RSN,
		      L.FEE,
	          L.INTR_AMNT,
	          TRUNC(NVL(L.FEE, 0) + NVL(L.INTR_AMNT, 0) + NVL(L.ADD_AMNT, 0), -1) AS SUPPLY_AMNT,
	          L.ADD_AMNT,
	          L.ADD_AMNT_RM, 
		      L.NTIC_CNT,
              L.INTR_RATE*100 INTR_RATE,
              L.NTIC_AMT,
              L.RM,
              L.MNG_YEAR,
              L.MNG_NO,
              L.MNG_CNT,
		      U.AGENT_CODE,
		      (SELECT ENTRPS_NM FROM ENTRPS_INFO_F WHERE ENTRPSCD = U.AGENT_CODE) AGENT_NAME,
		      TO_CHAR(L.NTIC_PD_FROM, 'YYYY-MM-DD') NTIC_PD_FROM,
		      TO_CHAR(L.NTIC_PD_TO, 'YYYY-MM-DD') NTIC_PD_TO,
		      TO_CHAR(L.NTIC_DT, 'YYYY-MM-DD') NTIC_DT,
		      L.ARRRG_NO,
		      (SELECT RPRSNTV_NM FROM ENTRPS_INFO_F WHERE ENTRPSCD=L.ENTRPSCD) RPRSNTV_NM,
		      (SELECT ADRES FROM ENTRPS_INFO_F WHERE ENTRPSCD=L.ENTRPSCD) ADRES,
		      (SELECT ADRES2 FROM ENTRPS_INFO_F WHERE ENTRPSCD=L.ENTRPSCD) ADRES2,
		      (SELECT ZIP FROM ENTRPS_INFO_F WHERE ENTRPSCD=L.ENTRPSCD) ZIP,
		      GAM_GET_FEE_TP_NM(L.PRT_AT_CODE, 'H', DECODE(U.FEE_TP, 'V2', 'A3',U.WORK_CODE)) CHRGE_KND_NM,
		      U.BZ_RGST_ID,
		      L.VAT,
		      L.VAT_YN,
		      L.ASSESS_SE,
		      GAM_GETCODENAME('GAM016', L.VAT_YN) TAXT_SE_NM,
		      TO_CHAR(U.DLY_BILL_DT, 'YYYY-MM-DD') BILL_DT,
		      TO_CHAR(U.DLY_DUE_DT, 'YYYY-MM-DD') DUE_DATE
		   FROM LEV_REQEST_F L, UNPAID_F U
		    WHERE 1=1
	           AND L.PRT_AT_CODE=U.PRT_AT_CODE
	           AND L.ACCNUT_YEAR=U.FISCAL_YR
	           AND GAM_GET_HTLD_ARRRG_CHRGE_KND(L.CHRGE_KND)=U.WORK_CODE
	           AND L.NTICNO=U.BILL_NO
               AND U.PRT_AT_CODE = #prtAtCode#
               AND U.FEE_TP = GAM_GET_HTLD_FEE_TP(#workCode#)
               AND U.WORK_CODE = #workCode#
               AND U.FISCAL_YR = #fiscalYr#
               AND U.BILL_NO = #billNo#
			   AND U.DLY_SER_NO = #dlySerNo#				
		      ) A
		  ) Z
    </select>

    <select id="gamHtldRentFeePaySttusMngtDao.selectNticPrintDetail_D" parameterClass="hashMap" resultClass="egovMap">
    	SELECT
    		A.RM,
    		D.USAGE_AR,
			  D.APPLC_PRICE,
			  D.PRICE_SE,
    		TRUNC(D.USAGE_AR*D.APPLC_PRICE, -1) D_PRICE,
    		D.COMPUT_DTLS ,
	        (SELECT GIS_ASSETS_NM
	        FROM GIS_ASSETS_CD_F
	        WHERE ROWNUM              =1
	        AND GIS_ASSETS_PRT_AT_CODE=D.GIS_ASSETS_PRT_AT_CODE
	        AND GIS_ASSETS_CD         =D.GIS_ASSETS_CD
	        AND GIS_ASSETS_SUB_CD     =D.GIS_ASSETS_SUB_CD
	        ) GIS_ASSETS_NM ,
	        (SELECT GIS_ASSETS_LOCPLC
	        FROM GIS_ASSETS_CD_F
	        WHERE ROWNUM              =1
	        AND GIS_ASSETS_PRT_AT_CODE=D.GIS_ASSETS_PRT_AT_CODE
	        AND GIS_ASSETS_CD         =D.GIS_ASSETS_CD
	        AND GIS_ASSETS_SUB_CD     =D.GIS_ASSETS_SUB_CD
	        ) GIS_ASSETS_LOCPLC ,
	        (SELECT GIS_ASSETS_LNM
	        FROM GIS_ASSETS_CD_F
	        WHERE ROWNUM              =1
	        AND GIS_ASSETS_PRT_AT_CODE=D.GIS_ASSETS_PRT_AT_CODE
	        AND GIS_ASSETS_CD         =D.GIS_ASSETS_CD
	        AND GIS_ASSETS_SUB_CD     =D.GIS_ASSETS_SUB_CD
	        ) GIS_ASSETS_LNM ,
	        (SELECT GIS_ASSETS_LNM_SUB
	        FROM GIS_ASSETS_CD_F
	        WHERE ROWNUM              =1
	        AND GIS_ASSETS_PRT_AT_CODE=D.GIS_ASSETS_PRT_AT_CODE
	        AND GIS_ASSETS_CD         =D.GIS_ASSETS_CD
	        AND GIS_ASSETS_SUB_CD     =D.GIS_ASSETS_SUB_CD
	        ) GIS_ASSETS_LNM_SUB
      FROM
        ASSETS_RENT_F A,
        ASSETS_RENT_DETAIL_F D
      WHERE 1             = 1
      AND A.PRT_AT_CODE   = D.PRT_AT_CODE
      AND A.MNG_YEAR      = D.MNG_YEAR
      AND A.MNG_NO        = D.MNG_NO
      AND A.MNG_CNT       = D.MNG_CNT
      AND A.QUAY_GROUP_CD = 'H'
      AND A.PRT_AT_CODE   = #prtAtCode#
      AND A.MNG_YEAR      = #mngYear#
      AND A.MNG_NO        = #mngNo#
      AND A.MNG_CNT       = #mngCnt#
    ORDER BY D.ASSETS_USAGE_SEQ ASC
    </select>

	<!-- 연체고지서 인쇄 후 정보 업데이트 -->
	<update id="gamHtldRentFeePaySttusMngtDao.updateArrrgNticPrintState_S">
        UPDATE UNPAID_F SET
        	DLY_BILL_PRT_YN = 'Y',
      		UPDT_UID=#updUsr#,
      		UPDT_DATE=SYSDATE
     	WHERE
            PRT_AT_CODE = #prtAtCode#
            AND FEE_TP = GAM_GET_HTLD_FEE_TP(#workCode#)
            AND WORK_CODE = #workCode#
            AND FISCAL_YR = #fiscalYr#
            AND BILL_NO = #billNo#
			AND DLY_SER_NO = #dlySerNo#				
	</update>

    <select id="gamHtldRentFeePaySttusMngtDao.selectNticPrintDetailHist_D" parameterClass="hashMap" resultClass="egovMap">
    	SELECT 
          PRT_AT_CODE
          , MNG_YEAR
          , MNG_NO
          , MNG_CNT
          , ASSETS_USAGE_SEQ
          , NTIC_CNT
          , CHRGE_KND
          , USAGE_AR
          , APPLC_PRICE
          , PRICE_SE
          , FEE
          , INTR_AMNT
          , INTR_RATE
          , NTIC_PD_FROM
          , NTIC_PD_TO
         FROM
         	HTLD_RENT_DETAIL_FEE_HIST_F
         WHERE
				PRT_AT_CODE   = #prtAtCode#
				AND MNG_YEAR      = #mngYear#
				AND MNG_NO        = #mngNo#
				AND MNG_CNT       = #mngCnt#
				AND NTIC_CNT      = #nticCnt#         	
    </select>

</sqlMap>
