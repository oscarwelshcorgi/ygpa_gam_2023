<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="ygpa.gam.asset.rent">

    <typeAlias alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
    <typeAlias alias="hashMap" type="java.util.HashMap"/>
    <typeAlias alias="gamAssetRentFeePayDtlsMngtVO" type="egovframework.rte.ygpa.gam.asset.rent.service.GamAssetRentFeePayDtlsMngtVO"/>

    <resultMap id="gamAssetRentFeePayDtlsMngtSumMap" class="gamAssetRentFeePayDtlsMngtVO">
        <result property="sumCnt" column="SUM_CNT" columnIndex="4"/>
        <result property="sumFee" column="SUM_FEE" columnIndex="5"/>
        <result property="sumNhtIsueAmt" column="SUM_NHT_ISUE_AMT" columnIndex="6"/>
        <result property="sumVat" column="SUM_VAT" columnIndex="7"/>
        <result property="sumNticAmt" column="SUM_NTIC_AMT" columnIndex="8"/>
        <result property="sumFeeA3" column="SUM_FEE_A3" columnIndex="9"/>
        <result property="sumFeeA4" column="SUM_FEE_A4" columnIndex="10"/>
        <result property="sumFeeD1" column="SUM_FEE_D1" columnIndex="11"/>
        <result property="sumFeeD2" column="SUM_FEE_D2" columnIndex="12"/>
           </resultMap>

    <select id="gamAssetRentFeePayDtlsMngtDao.selectAssetRentFeePayDtlsList_D" parameterClass="gamAssetRentFeePayDtlsMngtVO" resultClass="egovMap">
    	SELECT Z.* FROM (
           SELECT ROWNUM RNUM, A.*
           FROM (
                   SELECT
                   	S.PRT_AT_CODE,
                   	S.MNG_YEAR,
                   	S.MNG_NO,
                   	S.MNG_CNT,
                   	S.MNG_YEAR || '-' || S.MNG_NO || '-' || S.MNG_CNT AS RENT_MNG_NO,
                   	S.ACCNUT_YEAR,
                   	S.NTIC_CNT,
			        S.ENTRPSCD,
			        S.ENTRPS_NM,
                   	MIN(S.NTIC_PD_FROM) NTIC_PD_FROM,
                   	MAX(S.NTIC_PD_TO) NTIC_PD_TO,
                   	MAX(S.NTICNO) NTICNO,
                   	MAX(DECODE(S.CHRGE_KND, 'A3', '', 'A4', '', 'D1', '', 'D2', '', S.CHRGE_KND)) CHRGE_KND,
    				GAM_GETCODENAME('GAM024', MAX(DECODE(S.CHRGE_KND, 'A3', '', 'A4', '', 'D1', '', 'D2', '', S.CHRGE_KND))) CHRGE_KND_NM,
                   	SUM(DECODE(S.CHRGE_KND, 'A3', 0, 'A4', 0, 'D1', 0, 'D2', 0, S.FEE)) FEE,
                   	SUM(DECODE(S.CHRGE_KND, 'A3', S.FEE, 0)) FEE_A3,
                   	SUM(DECODE(S.CHRGE_KND, 'A4', S.FEE, 0)) FEE_A4,
                   	SUM(DECODE(S.CHRGE_KND, 'D1', S.FEE, 0)) FEE_D1,
                   	SUM(DECODE(S.CHRGE_KND, 'D2', S.FEE, 0)) FEE_D2,
                   	MAX(S.SANCTN_STTUS_NM) SANCTN_STTUS_NM,
                   	MAX(S.SANCTN_STTUS) SANCTN_STTUS,
                   	SUM(S.NTIC_AMT) TOTAL_NTIC_AMOUNT,
                   	MAX(S.NTIC_DT) NTIC_DT,
                   	MAX(S.PAY_TMLMT) PAY_TMLMT,
                   	MAX(S.DEPTCD_NM) DEPTCD_NM,
                   	MAX(S.RCIV_SE) RCIV_SE,
                   	MAX(S.RCIV_DT) RCIV_DT,
                   	MAX(S.GR_AR) GR_AR,
                   	MAX(S.GR_USAGE_PD_FROM) GR_USAGE_PD_FROM,
                   	MAX(S.GR_USAGE_PD_TO) GR_USAGE_PD_TO,
                   	MAX(S.PRMISN_DT) PRMISN_DT
                     FROM (
                           SELECT
							         L.NTIC_CNT
							       , L.FCLTY_SE
							       , L.CHRGE_KND
							       , L.ENTRPSCD
							       , L.ENTRPS_NM
							       , TO_CHAR(L.NTIC_PD_FROM, 'YYYY-MM-DD') NTIC_PD_FROM
							       , TO_CHAR(L.NTIC_PD_TO, 'YYYY-MM-DD') NTIC_PD_TO
							       , L.ACCNUT_YEAR
							       , L.NTICNO
							       , TO_CHAR(L.NTIC_DT, 'YYYY-MM-DD') NTIC_DT
							       , TO_CHAR(L.PAY_TMLMT, 'YYYY-MM-DD') PAY_TMLMT
							       , L.SANCTN_STTUS
							       , L.SANCTNER_EMPL_NO
							       , TO_CHAR(L.SANCTN_DT) SANCTN_DT
							       , GAM_GETCODENAME('GAM046', L.SANCTN_STTUS) SANCTN_STTUS_NM
							       , NVL(L.OLNLP,0) OLNLP
							       , NVL(L.FEE,0) FEE
							       , L.VAT_YN
							       , NVL(L.VAT,0) VAT
							       , NVL(L.NTIC_AMT,0) NTIC_AMT
							       , L.RM
							       , L.RCIV_SE
							       , TO_CHAR(L.RCIV_DT, 'YYYY-MM-DD') RCIV_DT
							       , L.ARRRG_NO
							       , NVL(L.ARRRG_AMT,0) ARRRG_AMT
							       , L.REQEST_SEQ
							       , L.DEPTCD
							       , L.NTIC_MTH
							       , L.REG_USR
							       , TO_CHAR(L.REGIST_DT, 'YYYY-MM-DD') REGIST_DT
							       , L.UPD_USR
							       , TO_CHAR(L.UPDT_DT, 'YYYY-MM-DD') UPDT_DT
							       , L.PRT_AT_CODE
							       , L.MNG_YEAR
							       , L.MNG_NO
							       , L.MNG_CNT
							       , (SELECT CD.CODE_NM FROM COMTCCMMNDETAILCODE CD WHERE CD.CODE_ID = 'GAM019' AND CD.CODE = L.PRT_AT_CODE AND ROWNUM = 1) PRT_AT_CODE_NM
    						       , GAM_GETDEPTNAME(L.DEPTCD) DEPTCD_NM
    						       , NVL(A.GR_AR,0) GR_AR
    						       , TO_CHAR(A.GR_USAGE_PD_FROM, 'YYYY-MM-DD') GR_USAGE_PD_FROM
    						       , TO_CHAR(A.GR_USAGE_PD_TO, 'YYYY-MM-DD') GR_USAGE_PD_TO
    						       , TO_CHAR(A.PRMISN_DT, 'YYYY-MM-DD') PRMISN_DT
    						       , NVL(A.GR_RDCXPT_FEE,0) GR_RDCXPT_FEE
							  FROM ASSETS_RENT_F A,
							       LEV_REQEST_F L
							 WHERE 1 = 1
							   AND A.PRT_AT_CODE = L.PRT_AT_CODE
                               AND A.MNG_YEAR = L.MNG_YEAR
                               AND A.MNG_NO = L.MNG_NO
                               AND A.MNG_CNT = L.MNG_CNT
							   AND A.QUAY_GROUP_CD='P'
							   AND L.NHT_ISUE_YN='Y'
							   <isNotEmpty property="sPrtAtCode">
							       AND L.PRT_AT_CODE = #sPrtAtCode#
							   </isNotEmpty>

							   <isNotEmpty property="sReqstSeCd">
								   AND (
								         (L.PRT_AT_CODE, L.MNG_YEAR, L.MNG_NO, L.MNG_CNT) IN (
								                                                              SELECT   R.PRT_AT_CODE
								                                                                     , R.MNG_YEAR
								                                                                     , R.MNG_NO
								                                                                     , R.MNG_CNT
								                                                                FROM ASSETS_RENT_F R
								                                                               WHERE R.REQST_SE_CD = #sReqstSeCd#
								                                                             )
								       )
							   </isNotEmpty>

							   <isNotEmpty property="sEntrpscd">
							       AND L.entrpscd = #sEntrpscd#
							   </isNotEmpty>

						         <isNotEmpty property="nticPdFrom">
									<![CDATA[
						         		AND L.NTIC_PD_FROM > TO_DATE(#nticPdFrom#, 'YYYY-MM-DD')
						         	]]>
						         </isNotEmpty>

						         <isNotEmpty property="nticPdTo">
									<![CDATA[
							         	AND L.NTIC_PD_FROM < TO_DATE(#nticPdTo#, 'YYYY-MM-DD')+1
						         	]]>
						         </isNotEmpty>

							   <isNotEmpty property="sUsagePrposCd">
								   AND (
								         (L.PRT_AT_CODE, L.MNG_YEAR, L.MNG_NO, L.MNG_CNT) IN (
								                                                              SELECT  D.PRT_AT_CODE
								                                                                    , D.MNG_YEAR
								                                                                    , D.MNG_NO
								                                                                    , D.MNG_CNT
								                                                                FROM ASSETS_RENT_DETAIL_F D
								                                                               WHERE D.USAGE_PRPOS_CD = #sUsagePrposCd#
								                                                               GROUP BY D.PRT_AT_CODE, D.MNG_YEAR, D.MNG_NO, D.MNG_CNT
								                                                             )
								       )
							   </isNotEmpty>

							   <isNotEmpty property="sMngYear">
							       AND L.MNG_YEAR    = #sMngYear#
							   </isNotEmpty>

							   <isNotEmpty property="sMngNo">
							       AND L.MNG_NO      = #sMngNo#
							   </isNotEmpty>

							   <isNotEmpty property="sMngCnt">
							       AND L.MNG_CNT     = #sMngCnt#
							   </isNotEmpty>

							   <isNotEmpty property="sPrmisnYn">
								   AND (
								         (L.PRT_AT_CODE, L.MNG_YEAR, L.MNG_NO, L.MNG_CNT) IN (
								                                                              SELECT   R.PRT_AT_CODE
								                                                                     , R.MNG_YEAR
								                                                                     , R.MNG_NO
								                                                                     , R.MNG_CNT
								                                                                FROM ASSETS_RENT_F R
								                                                               WHERE R.PRMISN_YN = #sPrmisnYn#
								                                                             )
								       )
	                              </isNotEmpty>

               <isNotEmpty property="sRrArFrom">
				<![CDATA[
               	AND A.GR_AR > #sRrArFrom#
               	]]>
               </isNotEmpty>
          	    <isNotEmpty property="sRrArTo">
				<![CDATA[
               	AND A.GR_AR < #sRrArTo#
               	]]>
               </isNotEmpty>



                ) S
                GROUP BY S.PRT_AT_CODE, S.MNG_YEAR, S.MNG_NO, S.MNG_CNT, S.NTIC_CNT, S.ACCNUT_YEAR, S.ENTRPSCD, S.ENTRPS_NM
                ORDER BY S.ENTRPS_NM ASC, S.NTIC_CNT ASC
             ) A
             ) Z
        <![CDATA[
        	WHERE Z.RNUM <= #recordCountPerPage# and Z.RNUM > #firstIndex#
        ]]>
    </select>

    <select id="gamAssetRentFeePayDtlsMngtDao.selectAssetRentFeePayDtlsListTotCnt_S" parameterClass="gamAssetRentFeePayDtlsMngtVO" resultClass="int">
            SELECT COUNT(*) totcnt FROM
            	(SELECT *
              FROM ASSETS_RENT_F A, LEV_REQEST_F L
             WHERE A.QUAY_GROUP_CD='P'
             	AND A.PRT_AT_CODE=L.PRT_AT_CODE
             	AND A.MNG_YEAR=L.MNG_YEAR
             	AND A.MNG_NO=L.MNG_NO
             	AND A.MNG_CNT=L.MNG_CNT
							   AND L.NHT_ISUE_YN='Y'

               <isNotEmpty property="sPrtAtCode">
                   AND L.PRT_AT_CODE = #sPrtAtCode#
               </isNotEmpty>

               <isNotEmpty property="sReqstSeCd">
                   AND (
                         (L.PRT_AT_CODE, L.MNG_YEAR, L.MNG_NO, L.MNG_CNT) IN (
                                                                              SELECT   R.PRT_AT_CODE
                                                                                     , R.MNG_YEAR
                                                                                     , R.MNG_NO
                                                                                     , R.MNG_CNT
                                                                                FROM ASSETS_RENT_F R
                                                                               WHERE R.REQST_SE_CD = #sReqstSeCd#
                                                                             )
                       )
               </isNotEmpty>

               <isNotEmpty property="sEntrpscd">
                   AND L.entrpscd = #sEntrpscd#
               </isNotEmpty>

         <isNotEmpty property="nticPdFrom">
			<![CDATA[
         		AND L.NTIC_PD_FROM > TO_DATE(#nticPdFrom#, 'YYYY-MM-DD')
         	]]>
         </isNotEmpty>

         <isNotEmpty property="nticPdTo">
			<![CDATA[
	         	AND L.NTIC_PD_FROM < TO_DATE(#nticPdTo#, 'YYYY-MM-DD')+1
         	]]>
         </isNotEmpty>

               <isNotEmpty property="sUsagePrposCd">
                   AND (
                         (L.PRT_AT_CODE, L.MNG_YEAR, L.MNG_NO, L.MNG_CNT) IN (
                                                                              SELECT  D.PRT_AT_CODE
                                                                                    , D.MNG_YEAR
                                                                                    , D.MNG_NO
                                                                                    , D.MNG_CNT
                                                                                FROM ASSETS_RENT_DETAIL_F D
                                                                               WHERE D.USAGE_PRPOS_CD = #sUsagePrposCd#
                                                                               GROUP BY D.PRT_AT_CODE, D.MNG_YEAR, D.MNG_NO, D.MNG_CNT
                                                                             )
                       )
               </isNotEmpty>

               <isNotEmpty property="sMngYear">
                   AND L.MNG_YEAR    = #sMngYear#
               </isNotEmpty>

               <isNotEmpty property="sMngNo">
                   AND L.MNG_NO      = #sMngNo#
               </isNotEmpty>

               <isNotEmpty property="sMngCnt">
                   AND L.MNG_CNT     = #sMngCnt#
               </isNotEmpty>

               <isNotEmpty property="sRrArFrom">
				<![CDATA[
               	AND A.GR_AR > #sRrArFrom#
               	]]>
               </isNotEmpty>
          	    <isNotEmpty property="sRrArTo">
				<![CDATA[
               	AND A.GR_AR < #sRrArTo#
               	]]>
               </isNotEmpty>

          GROUP BY L.PRT_AT_CODE, L.MNG_YEAR, L.MNG_NO, L.MNG_CNT, L.NTIC_CNT, L.ENTRPSCD
          ) Z
    </select>

    <select id="gamAssetRentFeePayDtlsMngtDao.selectAssetRentFeePayDtlsMngtDetailList_D" parameterClass="gamAssetRentFeePayDtlsMngtVO" resultClass="egovMap">
           SELECT ROWNUM RNUM, A.*
           FROM (
                           SELECT
							         L.NTIC_CNT
							       , L.FCLTY_SE
							       , L.CHRGE_KND
							       , L.ENTRPSCD
							       , L.ENTRPS_NM
							       , TO_CHAR(L.NTIC_PD_FROM, 'YYYY-MM-DD') NTIC_PD_FROM
							       , TO_CHAR(L.NTIC_PD_TO, 'YYYY-MM-DD') NTIC_PD_TO
							       , L.ACCNUT_YEAR
							       , L.NTICNO
							       , TO_CHAR(L.NTIC_DT, 'YYYY-MM-DD') NTIC_DT
							       , TO_CHAR(L.PAY_TMLMT, 'YYYY-MM-DD') PAY_TMLMT
							       , L.SANCTN_STTUS
							       , L.SANCTNER_EMPL_NO
							       , TO_CHAR(L.SANCTN_DT) SANCTN_DT
							       , GAM_GETCODENAME('GAM046', L.SANCTN_STTUS) SANCTN_STTUS_NM
							       , NVL(L.OLNLP,0) OLNLP
							       , NVL(L.FEE,0) FEE
							       , L.VAT_YN
							       , NVL(L.VAT,0) VAT
							       , NVL(L.NTIC_AMT,0) NTIC_AMT
							       , L.RM
							       , L.RCIV_SE
							       , TO_CHAR(L.RCIV_DT, 'YYYY-MM-DD') RCIV_DT
							       , L.ARRRG_NO
							       , NVL(L.ARRRG_AMT,0) ARRRG_AMT
							       , L.REQEST_SEQ
							       , L.DEPTCD
							       , L.NTIC_MTH
							       , L.REG_USR
							       , TO_CHAR(L.REGIST_DT, 'YYYY-MM-DD') REGIST_DT
							       , L.UPD_USR
							       , TO_CHAR(L.UPDT_DT, 'YYYY-MM-DD') UPDT_DT
							       , L.PRT_AT_CODE
							       , L.MNG_YEAR
							       , L.MNG_NO
							       , L.MNG_CNT
							       , (SELECT CD.CODE_NM FROM COMTCCMMNDETAILCODE CD WHERE CD.CODE_ID = 'GAM019' AND CD.CODE = L.PRT_AT_CODE AND ROWNUM = 1) PRT_AT_CODE_NM
    						       , GAM_GETDEPTNAME(L.DEPTCD) DEPTCD_NM
    						       , NVL(A.GR_AR,0) GR_AR
    						       , TO_CHAR(A.GR_USAGE_PD_FROM, 'YYYY-MM-DD') GR_USAGE_PD_FROM
    						       , TO_CHAR(A.GR_USAGE_PD_TO, 'YYYY-MM-DD') GR_USAGE_PD_TO
    						       , TO_CHAR(A.PRMISN_DT, 'YYYY-MM-DD') PRMISN_DT
    						       , NVL(A.GR_RDCXPT_FEE,0) GR_RDCXPT_FEE
							  FROM ASSETS_RENT_F A,
							       LEV_REQEST_F L
							 WHERE 1 = 1
							   AND A.PRT_AT_CODE = L.PRT_AT_CODE
                               AND A.MNG_YEAR = L.MNG_YEAR
                               AND A.MNG_NO = L.MNG_NO
                               AND A.MNG_CNT = L.MNG_CNT
							   AND A.QUAY_GROUP_CD='P'
							   AND L.NHT_ISUE_YN='Y'
							   <isNotEmpty property="sPrtAtCode">
							       AND L.PRT_AT_CODE = #sPrtAtCode#
							   </isNotEmpty>

							   <isNotEmpty property="sReqstSeCd">
								   AND (
								         (L.PRT_AT_CODE, L.MNG_YEAR, L.MNG_NO, L.MNG_CNT) IN (
								                                                              SELECT   R.PRT_AT_CODE
								                                                                     , R.MNG_YEAR
								                                                                     , R.MNG_NO
								                                                                     , R.MNG_CNT
								                                                                FROM ASSETS_RENT_F R
								                                                               WHERE R.REQST_SE_CD = #sReqstSeCd#
								                                                             )
								       )
							   </isNotEmpty>

							   <isNotEmpty property="sEntrpscd">
							       AND L.entrpscd = #sEntrpscd#
							   </isNotEmpty>

						         <isNotEmpty property="nticPdFrom">
									<![CDATA[
						         		AND L.NTIC_PD_FROM > TO_DATE(#nticPdFrom#, 'YYYY-MM-DD')
						         	]]>
						         </isNotEmpty>

						         <isNotEmpty property="nticPdTo">
									<![CDATA[
							         	AND L.NTIC_PD_FROM < TO_DATE(#nticPdTo#, 'YYYY-MM-DD')+1
						         	]]>
						         </isNotEmpty>

							   <isNotEmpty property="sUsagePrposCd">
								   AND (
								         (L.PRT_AT_CODE, L.MNG_YEAR, L.MNG_NO, L.MNG_CNT) IN (
								                                                              SELECT  D.PRT_AT_CODE
								                                                                    , D.MNG_YEAR
								                                                                    , D.MNG_NO
								                                                                    , D.MNG_CNT
								                                                                FROM ASSETS_RENT_DETAIL_F D
								                                                               WHERE D.USAGE_PRPOS_CD = #sUsagePrposCd#
								                                                               GROUP BY D.PRT_AT_CODE, D.MNG_YEAR, D.MNG_NO, D.MNG_CNT
								                                                             )
								       )
							   </isNotEmpty>

							   <isNotEmpty property="sMngYear">
							       AND L.MNG_YEAR    = #sMngYear#
							   </isNotEmpty>

							   <isNotEmpty property="sMngNo">
							       AND L.MNG_NO      = #sMngNo#
							   </isNotEmpty>

							   <isNotEmpty property="sMngCnt">
							       AND L.MNG_CNT     = #sMngCnt#
							   </isNotEmpty>

							   <isNotEmpty property="sPrmisnYn">
								   AND (
								         (L.PRT_AT_CODE, L.MNG_YEAR, L.MNG_NO, L.MNG_CNT) IN (
								                                                              SELECT   R.PRT_AT_CODE
								                                                                     , R.MNG_YEAR
								                                                                     , R.MNG_NO
								                                                                     , R.MNG_CNT
								                                                                FROM ASSETS_RENT_F R
								                                                               WHERE R.PRMISN_YN = #sPrmisnYn#
								                                                             )
								       )
	                              </isNotEmpty>

               <isNotEmpty property="sRrArFrom">
				<![CDATA[
               	AND A.GR_AR > #sRrArFrom#
               	]]>
               </isNotEmpty>
          	    <isNotEmpty property="sRrArTo">
				<![CDATA[
               	AND A.GR_AR < #sRrArTo#
               	]]>
               </isNotEmpty>
             ) A
    </select>

    <select id="gamAssetRentFeePayDtlsMngtDao.selectAssetRentFeePayDtlsMngtSum_S" parameterClass="gamAssetRentFeePayDtlsMngtVO" resultMap="gamAssetRentFeePayDtlsMngtSumMap">
         SELECT
                 COUNT(*) SUM_CNT
               , SUM(DECODE(L.CHRGE_KND, 'A3', 0, 'A4', 0, 'D1', 0, 'D2', 0, L.FEE)) SUM_FEE
                   	,SUM(DECODE(L.CHRGE_KND, 'A3', L.FEE, 0)) SUM_FEE_A3
                   	,SUM(DECODE(L.CHRGE_KND, 'A4', L.FEE, 0)) SUM_FEE_A4
                   	,SUM(DECODE(L.CHRGE_KND, 'D1', L.FEE, 0)) SUM_FEE_D1
                   	,SUM(DECODE(L.CHRGE_KND, 'D2', L.FEE, 0)) SUM_FEE_D2
                , SUM(NVL(L.NTIC_AMT, 0)) SUM_NHT_ISUE_AMT
               , SUM(NVL(L.VAT, 0)) SUM_VAT
               , SUM(NVL(L.NTIC_AMT,0)) SUM_NTIC_AMT
          FROM ASSETS_RENT_F A, LEV_REQEST_F L
         WHERE 1 = 1
             AND A.QUAY_GROUP_CD='P'
             	AND A.PRT_AT_CODE=L.PRT_AT_CODE
             	AND A.MNG_YEAR=L.MNG_YEAR
             	AND A.MNG_NO=L.MNG_NO
             	AND A.MNG_CNT=L.MNG_CNT
		   AND L.NHT_ISUE_YN='Y'

         <isNotEmpty property="sPrtAtCode">
             AND L.PRT_AT_CODE = #sPrtAtCode#
         </isNotEmpty>

         <isNotEmpty property="sReqstSeCd">
             AND (
                   (L.PRT_AT_CODE, L.MNG_YEAR, L.MNG_NO, L.MNG_CNT) IN (
                                                                        SELECT   R.PRT_AT_CODE
                                                                               , R.MNG_YEAR
                                                                               , R.MNG_NO
                                                                               , R.MNG_CNT
                                                                          FROM ASSETS_RENT_F R
                                                                         WHERE R.REQST_SE_CD = #sReqstSeCd#
                                                                       )
                 )
         </isNotEmpty>

         <isNotEmpty property="sEntrpscd">
             AND L.entrpscd = #sEntrpscd#
         </isNotEmpty>

         <isNotEmpty property="sUsagePrposCd">
             AND (
                   (L.PRT_AT_CODE, L.MNG_YEAR, L.MNG_NO, L.MNG_CNT) IN (
                                                                        SELECT  D.PRT_AT_CODE
                                                                              , D.MNG_YEAR
                                                                              , D.MNG_NO
                                                                              , D.MNG_CNT
                                                                          FROM ASSETS_RENT_DETAIL_F D
                                                                         WHERE D.USAGE_PRPOS_CD = #sUsagePrposCd#
                                                                         GROUP BY D.PRT_AT_CODE, D.MNG_YEAR, D.MNG_NO, D.MNG_CNT
                                                                       )
                 )
         </isNotEmpty>

         <isNotEmpty property="sMngYear">
             AND L.MNG_YEAR    = #sMngYear#
         </isNotEmpty>

         <isNotEmpty property="sMngNo">
             AND L.MNG_NO      = #sMngNo#
         </isNotEmpty>

         <isNotEmpty property="sMngCnt">
             AND L.MNG_CNT     = #sMngCnt#
         </isNotEmpty>

         <isNotEmpty property="nticPdFrom">
			<![CDATA[
         		AND L.NTIC_PD_FROM > TO_DATE(#nticPdFrom#, 'YYYY-MM-DD')
         	]]>
         </isNotEmpty>

         <isNotEmpty property="nticPdTo">
			<![CDATA[
	         	AND L.NTIC_PD_FROM < TO_DATE(#nticPdTo#, 'YYYY-MM-DD')+1
         	]]>
         </isNotEmpty>

               <isNotEmpty property="sRrArFrom">
				<![CDATA[
               	AND A.GR_AR > #sRrArFrom#
               	]]>
               </isNotEmpty>
          	    <isNotEmpty property="sRrArTo">
				<![CDATA[
               	AND A.GR_AR < #sRrArTo#
               	]]>
               </isNotEmpty>


    </select>


    <select id="gamAssetRentFeePayDtlsMngtDao.selectNticArrrgList_D" parameterClass="gamAssetRentFeePayDtlsMngtVO" resultClass="egovMap">
           SELECT A.*
           FROM (
                   SELECT  ROWNUM RNUM, S.*
                     FROM (
                           SELECT
E.PRT_AT_CODE,
      E.FEE_TP,
      E.FISCAL_YR,
      E.BILL_NO,
      E.BZ_RGST_ID,
      E.SSN,
      E.RCVD_TP,
      E.BILL_DT,
      E.DUE_DATE,
      E.RCVD_DT,
      E.BILL_PRT_YN,
      E.VSSL_KEY,
      E.BILL_AMNT,
      E.AMNT_RSN,
      E.AGENT_NAME,
      E.UPDT_UID,
      E.UPDT_DATE,
      E.SALIMI_NO,
      E.AGENT_CODE,
      E.DC_CODE,
      E.DC_RATE,
      E.ACCNT_CODE,
      E.ICHE_STATUS,
      E.RSLT_CODE,
      E.IO_TP,
      E.EXMP_AMNT,
      E.OVER_AMNT,
      E.DC_AMNT,
      E.RECPT_EPDT,
      E.POST_BILL_YN,
      E.NOPAY_LOSS_REAS_CD,
      E.ELCT_BILL_RSLT,
      E.BULL_INFO_INQR_DTIME,
      E.LAST,
      E.FIRST_BILL_DT,
      E.RCVD_NM,
      E.VAT_YN,
      E.VAT,
      E.STR_DATE,
      E.END_DATE,
      E.CALL_LETTER,
      E.CNV_YN
					        FROM  REV_COLL_F@YGPA_PORTMIS E
					             ,LEV_REQEST_F L
					       WHERE E.PRT_AT_CODE=L.PRT_AT_CODE
					       	AND E.FISCAL_YR = L.ACCNUT_YEAR
					       	AND E.FEE_TP = L.CHRGE_KND
					       	AND E.BILL_NO = L.NTICNO
					       	<![CDATA[
					       	AND L.PAY_TMLMT < SYSDATE
					       	]]>
					       	AND L.RCIV_SE = 'N'
					       <isNotEmpty property="sPrtAtCode">
			                   AND L.PRT_AT_CODE = #sPrtAtCode#
			               </isNotEmpty>

                ) S
             ) A
        <![CDATA[ WHERE ROWNUM <= #recordCountPerPage# and RNUM > #firstIndex# ]]>
    </select>

    <select id="gamAssetRentFeePayDtlsMngtDao.selectNticArrrgListTotCnt_S" parameterClass="gamAssetRentFeePayDtlsMngtVO" resultClass="int">
            SELECT COUNT(*) totcnt
              FROM  REV_COLL_F@YGPA_PORTMIS E
                   ,LEV_REQEST_F L
		       WHERE E.PRT_AT_CODE=L.PRT_AT_CODE
		       	AND E.FISCAL_YR = L.ACCNUT_YEAR
		       	AND E.FEE_TP = L.CHRGE_KND
		       	AND E.BILL_NO = L.NTICNO
		       	<![CDATA[
		       	AND L.PAY_TMLMT < SYSDATE
		       	AND L.RCIV_SE <> 'N'
		       	]]>
		       <isNotEmpty property="sPrtAtCode">
                   AND L.PRT_AT_CODE = #sPrtAtCode#
               </isNotEmpty>
    </select>

	<update id="gamAssetRentFeePayDtlsMngtDao.updateAssetRentFeePayDtlsMngtList">
       	<![CDATA[
			UPDATE LEV_REQEST_F L
			SET RCIV_DT=(SELECT RCVD_DT FROM REV_COLL_F@YGPA_PORTMIS R WHERE L.PRT_AT_CODE=R.PRT_AT_CODE
			  AND L.CHRGE_KND    =R.FEE_TP
			  AND L.ACCNUT_YEAR  =R.FISCAL_YR
			  AND L.NTICNO       =R.BILL_NO),
			  RCIV_SE  =DECODE((SELECT RCVD_TP FROM REV_COLL_F@YGPA_PORTMIS R WHERE L.PRT_AT_CODE=R.PRT_AT_CODE
			  AND L.CHRGE_KND    =R.FEE_TP
			  AND L.ACCNUT_YEAR  =R.FISCAL_YR
			  AND L.NTICNO       =R.BILL_NO), '3', 'Y', 'N')
			WHERE EXISTS
			  (SELECT 1
			  FROM REV_COLL_F@YGPA_PORTMIS R
			  WHERE L.PRT_AT_CODE=R.PRT_AT_CODE
			  AND L.CHRGE_KND    =R.FEE_TP
			  AND L.ACCNUT_YEAR  =R.FISCAL_YR
			  AND L.NTICNO       =R.BILL_NO
			  AND L.NHT_ISUE_YN  ='Y'
			  AND L.RCIV_SE NOT LIKE 'Y'
			  )
       	]]>
	</update>

    <insert id="gamAssetRentFeePayDtlsMngtDao.insertUnpaidArrrg_S" parameterClass="hashMap">

    </insert>

</sqlMap>
