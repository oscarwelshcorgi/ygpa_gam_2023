<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="ygpa.gam.oper.htld">

	<typeAlias alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
    <typeAlias alias="hashMap" type="java.util.HashMap"/>
    <typeAlias alias="gamHtldRentDetailVO" type="egovframework.rte.ygpa.gam.oper.htld.service.GamHtldRentDefaultVO"/>
    <typeAlias alias="gamHtldRentMngtVO" type="egovframework.rte.ygpa.gam.oper.htld.service.GamHtldRentMngtVO"/>
    <typeAlias alias="gamHtldRentMngtDetailVO" type="egovframework.rte.ygpa.gam.oper.htld.service.GamHtldRentMngtDetailVO"/>
    <typeAlias alias="gamHtldRentMngtLevReqestVO" type="egovframework.rte.ygpa.gam.oper.htld.service.GamHtldRentMngtLevReqestVO"/>
    <typeAlias alias="gamHtldRentAttachFileVO" type="egovframework.rte.ygpa.gam.oper.htld.service.GamHtldRentAttachFileVO"/>

    <typeAlias alias="gamHtldAssessVO" type="egovframework.rte.ygpa.gam.oper.htld.service.GamHtldAssessVO"/>

    <resultMap id="gamHtldRentMngtInfoMap" class="egovframework.rte.ygpa.gam.oper.htld.service.GamHtldRentMngtVO">
		<result property="prtAtCode" column="PRT_AT_CODE" columnIndex="1"/>
		<result property="quayGroupCd" column="QUAY_GROUP_CD" columnIndex="2"/>
		<result property="mngYear" column="MNG_YEAR" columnIndex="3"/>
		<result property="mngNo" column="MNG_NO" columnIndex="4"/>
		<result property="mngCnt" column="MNG_CNT" columnIndex="5"/>
		<result property="rentAreaCd" column="RENT_AREA_CD" columnIndex="6"/>
		<result property="rentArea" column="RENT_AREA" columnIndex="7"/>
		<result property="entrpscd" column="ENTRPSCD" columnIndex="8"/>
		<result property="entrpsNm" column="ENTRPS_NM" columnIndex="9"/>
		<result property="reqstSeCd" column="REQST_SE_CD" columnIndex="10"/>
		<result property="grAr" column="GR_AR" columnIndex="11"/>
		<result property="grFee" column="GR_FEE" columnIndex="12"/>
		<result property="grUsagePdFrom" column="GR_USAGE_PD_FROM" columnIndex="13"/>
		<result property="grUsagePdTo" column="GR_USAGE_PD_TO" columnIndex="14"/>
		<result property="regUsr" column="REG_USR" columnIndex="15"/>
		<result property="registDt" column="REGIST_DT" columnIndex="16"/>
		<result property="updUsr" column="UPD_USR" columnIndex="17"/>
		<result property="updtDt" column="UPDT_DT" columnIndex="18"/>
		<result property="gisCd" column="GIS_CD" columnIndex="19"/>
		<result property="frstReqstDt" column="FRST_REQST_DT" columnIndex="20"/>
		<result property="sanctnSttus" column="SANCTN_STTUS" columnIndex="21"/>
		<result property="sanctnSttusNm" column="SANCTN_STTUS_NM" columnIndex="22"/>
		<result property="sanctnerEmplNo" column="SANCTNER_EMPL_NO" columnIndex="23"/>
		<result property="sanctnDt" column="SANCTN_DT" columnIndex="24"/>
		<result property="reqstDt" column="REQST_DT" columnIndex="25"/>
		<result property="deptcd" column="DEPTCD" columnIndex="26"/>
		<result property="deptcdNm" column="DEPTCD_NM" columnIndex="27"/>
		<result property="operYrMt" column="OPER_YR_MT" columnIndex="28"/>
		<result property="compTp" column="COMP_TP" columnIndex="29"/>
		<result property="frghtTp" column="FRGHT_TP" columnIndex="30"/>
		<result property="taxtSe" column="TAXT_SE" columnIndex="31"/>
		<result property="taxtSeNm" column="TAXT_SE_NM" columnIndex="32"/>
		<result property="nticMth" column="NTIC_MTH" columnIndex="33"/>
		<result property="nticMthNm" column="NTIC_MTH_NM" columnIndex="34"/>
		<result property="frstPrmisnDt" column="FRST_PRMISN_DT" columnIndex="35"/>
		<result property="prmisnDt" column="PRMISN_DT" columnIndex="36"/>
		<result property="prmisnYn" column="PRMISN_YN" columnIndex="37"/>
		<result property="docNo" column="DOC_NO" columnIndex="38"/>
		<result property="rm" column="RM" columnIndex="39"/>
		<result property="cmt" column="CMT" columnIndex="40"/>
		<result property="etc" column="ETC" columnIndex="41"/>
		<result property="grRdcxptFee" column="GR_RDCXPT_FEE" columnIndex="42"/>
		<result property="payMth" column="PAY_MTH" columnIndex="43"/>
		<result property="payMthNm" column="PAY_MTH_NM" columnIndex="44"/>
		<result property="payinstIntrrate" column="PAYINST_INTRRATE" columnIndex="45"/>
		<result property="chargerNo" column="CHARGER_NO" columnIndex="46"/>
		<result property="chrgeKnd" column="CHRGE_KND" columnIndex="47"/>
	</resultMap>

    <resultMap id="gamHtldRentMngtInfoMaxKeyMap" class="egovframework.rte.ygpa.gam.oper.htld.service.GamHtldRentMngtVO">
        <result property="mngYear" column="MNG_YEAR" columnIndex="1"/>
        <result property="mngNo" column="MNG_NO" columnIndex="2"/>
        <result property="mngCnt" column="MNG_CNT" columnIndex="3"/>
    </resultMap>

    <resultMap id="gamHtldRentMngtInfoDetailMap" class="egovframework.rte.ygpa.gam.oper.htld.service.GamHtldRentMngtDetailVO">
		<result property="assetsUsageSeq" column="ASSETS_USAGE_SEQ" columnIndex="1"/>
		<result property="prtAtCode" column="PRT_AT_CODE" columnIndex="2"/>
		<result property="mngYear" column="MNG_YEAR" columnIndex="3"/>
		<result property="mngNo" column="MNG_NO" columnIndex="4"/>
		<result property="mngCnt" column="MNG_CNT" columnIndex="5"/>
		<result property="quayGroupCd" column="QUAY_GROUP_CD" columnIndex="6"/>
		<result property="quayCd" column="QUAY_CD" columnIndex="7"/>
		<result property="gisAssetsPrtAtCode" column="GIS_ASSETS_PRT_AT_CODE" columnIndex="8"/>
		<result property="gisAssetsCd" column="GIS_ASSETS_CD" columnIndex="9"/>
		<result property="gisAssetsSubCd" column="GIS_ASSETS_SUB_CD" columnIndex="10"/>
		<result property="usageAr" column="USAGE_AR" columnIndex="11"/>
		<result property="usagePdFrom" column="USAGE_PD_FROM" columnIndex="12"/>
		<result property="usagePdTo" column="USAGE_PD_TO" columnIndex="13"/>
		<result property="usagePurps" column="USAGE_PURPS" columnIndex="14"/>
		<result property="usageDtls" column="USAGE_DTLS" columnIndex="15"/>
		<result property="usagePrposCd" column="USAGE_PRPOS_CD" columnIndex="16"/>
		<result property="exemptSe" column="EXEMPT_SE" columnIndex="17"/>
		<result property="exemptRsnCd" column="EXEMPT_RSN_CD" columnIndex="18"/>
		<result property="exemptRsn" column="EXEMPT_RSN" columnIndex="19"/>
		<result property="exemptPdFrom" column="EXEMPT_PD_FROM" columnIndex="20"/>
		<result property="exemptPdTo" column="EXEMPT_PD_TO" columnIndex="21"/>
		<result property="computDtls" column="COMPUT_DTLS" columnIndex="22"/>
		<result property="olnlp" column="OLNLP" columnIndex="23"/>
		<result property="applcPrice" column="APPLC_PRICE" columnIndex="24"/>
		<result property="applcTariff" column="APPLC_TARIFF" columnIndex="25"/>
		<result property="applcMth" column="APPLC_MTH" columnIndex="26"/>
		<result property="packSe" column="PACK_SE" columnIndex="27"/>
		<result property="entrpsSe" column="ENTRPS_SE" columnIndex="28"/>
		<result property="feeCalcSe" column="FEE_CALC_SE" columnIndex="29"/>
		<result property="rdcxptFeeCalcSe" column="RDCXPT_FEE_CALC_SE" columnIndex="30"/>
		<result property="rdcxptFee" column="RDCXPT_FEE" columnIndex="31"/>
		<result property="fee" column="FEE" columnIndex="32"/>
		<result property="trmnatDt" column="TRMNAT_DT" columnIndex="33"/>
		<result property="trmnatRsn" column="TRMNAT_RSN" columnIndex="34"/>
		<result property="gisCd" column="GIS_CD" columnIndex="35"/>
		<result property="regUsr" column="REG_USR" columnIndex="36"/>
		<result property="registDt" column="REGIST_DT" columnIndex="37"/>
		<result property="updUsr" column="UPD_USR" columnIndex="38"/>
		<result property="updtDt" column="UPDT_DT" columnIndex="39"/>
	</resultMap>

    <select id="gamHtldRentMngtDao.selectHtldRentMngtList_D" parameterClass="gamHtldRentMngtVO" resultClass="egovMap">
           SELECT A.*
           FROM (
                   SELECT  ROWNUM RNUM, S.*
                     FROM (
                           SELECT
                                    A.PRT_AT_CODE
                                  , A.QUAY_GROUP_CD
                                  , A.MNG_YEAR
                                  , A.MNG_NO
                                  , A.MNG_CNT
                                  , A.RENT_AREA_CD
                                  , GAM_GETCODENAME('GAM062', A.RENT_AREA_CD) RENT_AREA
                                  , A.ENTRPSCD
                                  , ENTRPS_NM
                                  , A.REQST_SE_CD
                                  , NVL(A.GR_AR,0) GR_AR
                                  , NVL(A.GR_FEE,0) GR_FEE
                                  , A.PRMISN_YN
                                  , A.NTIC_MTH
                                  , TO_CHAR(A.GR_USAGE_PD_FROM, 'YYYY-MM-DD') GR_USAGE_PD_FROM
                                  , TO_CHAR(A.GR_USAGE_PD_TO, 'YYYY-MM-DD') GR_USAGE_PD_TO
                                  , A.REG_USR
                                  , TO_CHAR(A.REGIST_DT, 'YYYY-MM-DD') REGIST_DT
                                  , A.UPD_USR
                                  , TO_CHAR(A.UPDT_DT, 'YYYY-MM-DD') UPDT_DT
                                  , A.GIS_CD
                                  , TO_CHAR(A.FRST_REQST_DT, 'YYYY-MM-DD') FRST_REQST_DT
                                  , A.SANCTN_STTUS
                                  , GAM_GETCODENAME('GAM046', A.SANCTN_STTUS) SANCTN_STTUS_NM
                                  , A.SANCTNER_EMPL_NO
                                  , TO_CHAR(A.SANCTN_DT, 'YYYY-MM-DD HH24:MI:SS') SANCTN_DT
                                  , TO_CHAR(A.REQST_DT, 'YYYY-MM-DD') REQST_DT
                                  , GAM_GETDEPTNAME(A.DEPTCD) DEPTCD_NM
                                  , A.OPER_YR_MT
                                  , A.COMP_TP
                                  , A.FRGHT_TP
                                  , GAM_GETCODENAME('GAM043', A.PAY_MTH) AS PAY_MTH_NM
								  , GAM_GETCODENAME('GAM008', A.NTIC_MTH) AS NTIC_MTH_NM
								  , GAM_GETCODENAME('GAM016', A.TAXT_SE) AS TAXT_SE_NM
								  , GAM_GETCODENAME('GAM053', A.CHRGE_KND) AS CHRGE_KND_NM
                                  , F.APPLC_PRICE
								  , (SELECT GIS_ASSETS_LOCPLC||' '|| NVL2(GIS_ASSETS_LNM_SUB, GIS_ASSETS_LNM|| '-' ||GIS_ASSETS_LNM_SUB, GIS_ASSETS_LNM) ASSETS_LOCPLC
									FROM GIS_ASSETS_CD_F
									WHERE GIS_ASSETS_PRT_AT_CODE = F.GIS_ASSETS_PRT_AT_CODE AND GIS_ASSETS_CD = F.GIS_ASSETS_CD AND GIS_ASSETS_SUB_CD = F.GIS_ASSETS_SUB_CD) AS GIS_ASSETS_LOCPLC
								  FROM ASSETS_RENT_F A
								  LEFT OUTER JOIN ASSETS_RENT_DETAIL_F F
								  ON
								  	F.PRT_AT_CODE=A.PRT_AT_CODE AND F.MNG_YEAR=A.MNG_YEAR AND F.MNG_NO=A.MNG_NO AND F.MNG_CNT=A.MNG_CNT
								  WHERE A.QUAY_GROUP_CD='H'

							<isNotEmpty property="sRentAreaCd" prepend="AND">
				                A.RENT_AREA_CD = #sRentAreaCd#
				            </isNotEmpty>

                              <isNotEmpty property="sEntrpscd" prepend="AND">
				                 A.ENTRPSCD LIKE #sEntrpscd# || '%'
				             </isNotEmpty>

				             <isNotEmpty property="sEntrpsNm" prepend="AND">
				                 A.ENTRPSCD IN (SELECT ENTRPSCD FROM ENTRPS_INFO_F WHERE ENTRPS_NM LIKE '%' || #sEntrpsNm# || '%')
				             </isNotEmpty>

				             <isNotEmpty property="sGrUsagePdFrom" prepend="AND">
				             <![CDATA[
				                 A.GR_USAGE_PD_TO >= TO_DATE(#sGrUsagePdFrom#,'YYYY-MM-DD')
				                 ]]>
				             </isNotEmpty>

				             <isNotEmpty property="sGrUsagePdTo" prepend="AND">
				             <![CDATA[
				                 A.GR_USAGE_PD_FROM < TO_DATE(#sGrUsagePdTo#, 'YYYY-MM-DD')
				                 ]]>
				             </isNotEmpty>

                             ORDER BY A.RENT_AREA_CD ASC, ENTRPS_NM, GR_AR DESC
                ) S
             ) A
        <![CDATA[ WHERE ROWNUM <= #recordCountPerPage# and RNUM > #firstIndex# ]]>

    </select>

    <select id="gamHtldRentMngtDao.selectHtldRentMngtListTotCnt_S" parameterClass="gamHtldRentMngtVO" resultClass="int">
			SELECT COUNT(*) totcnt
			FROM ASSETS_RENT_F A
			WHERE A.QUAY_GROUP_CD='H'

			<isNotEmpty property="sRentAreaCd" prepend="AND">
				A.RENT_AREA_CD = #sRentAreaCd#
			</isNotEmpty>

			<isNotEmpty property="sEntrpscd" prepend="AND">
				A.ENTRPSCD LIKE #sEntrpscd# || '%'
			</isNotEmpty>

			<isNotEmpty property="sEntrpsNm" prepend="AND">
				A.ENTRPSCD IN (SELECT ENTRPSCD FROM ENTRPS_INFO_F WHERE ENTRPS_NM LIKE '%' ||
				#sEntrpsNm# || '%')
			</isNotEmpty>

			<isNotEmpty property="sGrUsagePdFrom" prepend="AND">
		          <![CDATA[
		  A.GR_USAGE_PD_TO >= TO_DATE(#sGrUsagePdFrom#,'YYYY-MM-DD')
		  ]]>
			</isNotEmpty>

			<isNotEmpty property="sGrUsagePdTo" prepend="AND">
		<![CDATA[
		  A.GR_USAGE_PD_FROM < TO_DATE(#sGrUsagePdTo#, 'YYYY-MM-DD')
		  ]]>
			</isNotEmpty>
    </select>

    <select id="gamHtldRentMngtDao.selectHtldRentMngtSum_S" parameterClass="gamHtldRentMngtVO" resultClass="egovMap">
         SELECT
                 TRIM(TO_CHAR(COUNT(*), '999,999,999,999')) SUM_CNT
               , TRIM(TO_CHAR(NVL(SUM(A.GR_AR),0), '999,999,999,999')) SUM_GR_AR
               , TRIM(TO_CHAR(NVL(SUM(A.GR_FEE),0), '999,999,999,999')) SUM_GR_FEE
               , TRIM(TO_CHAR(NVL(SUM(A.GR_RDCXPT_FEE),0), '999,999,999,999')) SUM_GR_RDCXPT_FEE
          FROM ASSETS_RENT_F A
			WHERE A.QUAY_GROUP_CD='H'

			<isNotEmpty property="sRentAreaCd" prepend="AND">
				A.RENT_AREA_CD = #sRentAreaCd#
			</isNotEmpty>

			<isNotEmpty property="sEntrpscd" prepend="AND">
				A.ENTRPSCD LIKE #sEntrpscd# || '%'
			</isNotEmpty>

			<isNotEmpty property="sEntrpsNm" prepend="AND">
				A.ENTRPSCD IN (SELECT ENTRPSCD FROM ENTRPS_INFO_F WHERE ENTRPS_NM LIKE '%' ||
				#sEntrpsNm# || '%')
			</isNotEmpty>

			<isNotEmpty property="sGrUsagePdFrom" prepend="AND">
		          <![CDATA[
		  A.GR_USAGE_PD_TO >= TO_DATE(#sGrUsagePdFrom#,'YYYY-MM-DD')
		  ]]>
			</isNotEmpty>

			<isNotEmpty property="sGrUsagePdTo" prepend="AND">
		<![CDATA[
		  A.GR_USAGE_PD_FROM < TO_DATE(#sGrUsagePdTo#, 'YYYY-MM-DD')
		  ]]>
			</isNotEmpty>
    </select>

    <select id="gamHtldRentMngtDao.selectHtldRentMngtByPk_S" parameterClass="gamHtldRentMngtVO" resultMap="gamHtldRentMngtInfoMap">
          SELECT
            A.PRT_AT_CODE
            , A.QUAY_GROUP_CD
            , A.MNG_YEAR
            , A.MNG_NO
            , A.MNG_CNT
            , A.RENT_AREA_CD
            , GAM_GETCODENAME('GAM062', A.RENT_AREA_CD) RENT_AREA
            , A.ENTRPSCD
            , GAM_GETENTRPSNM(A.ENTRPSCD, '1') ENTRPS_NM
            , A.REQST_SE_CD
            , NVL(A.GR_AR,0) GR_AR
            , NVL(A.GR_FEE,0) GR_FEE
            , (SELECT APPLC_PRICE FROM HTLD_RENT_ASSESS_F WHERE PRT_AT_CODE=A.PRT_AT_CODE AND MNG_YEAR=A.MNG_YEAR AND MNG_NO=A.MNG_NO AND MNG_CNT=A.MNG_CNT AND ASSESS_NO='0') APPLC_PRICE
            , A.PRMISN_YN
            , TO_CHAR(A.GR_USAGE_PD_FROM, 'YYYY-MM-DD') GR_USAGE_PD_FROM
            , TO_CHAR(A.GR_USAGE_PD_TO, 'YYYY-MM-DD') GR_USAGE_PD_TO
            , A.REG_USR
            , TO_CHAR(A.REGIST_DT, 'YYYY-MM-DD') REGIST_DT
            , A.UPD_USR
            , TO_CHAR(A.UPDT_DT, 'YYYY-MM-DD') UPDT_DT
            , A.GIS_CD
            , TO_CHAR(A.FRST_REQST_DT, 'YYYY-MM-DD') FRST_REQST_DT
            , A.SANCTN_STTUS
            , GAM_GETCODENAME('GAM046', A.SANCTN_STTUS) SANCTN_STTUS_NM
            , A.SANCTNER_EMPL_NO
            , TO_CHAR(A.SANCTN_DT, 'YYYY-MM-DD HH24:MI:SS') SANCTN_DT
            , TO_CHAR(A.REQST_DT, 'YYYY-MM-DD') REQST_DT
			, A.DEPTCD
            , GAM_GETDEPTNAME(A.DEPTCD) DEPTCD_NM
            , A.OPER_YR_MT
            , A.COMP_TP
            , A.FRGHT_TP
			, A.TAXT_SE
			, GAM_GETCODENAME('GAM016', A.TAXT_SE) AS TAXT_SE_NM
			, A.NTIC_MTH
			, GAM_GETCODENAME('GAM008', A.NTIC_MTH) AS NTIC_MTH_NM
			, TO_CHAR(A.FRST_PRMISN_DT, 'YYYY-MM-DD') FRST_PRMISN_DT
			, TO_CHAR(A.PRMISN_DT, 'YYYY-MM-DD') PRMISN_DT
			, A.PRMISN_YN
			, A.DOC_NO
			, A.RM
			, A.CMT
			, A.ETC
			, NVL(A.GR_RDCXPT_FEE,0) GR_RDCXPT_FEE
			, A.PAY_MTH
			, GAM_GETCODENAME('GAM043', A.PAY_MTH) PAY_MTH_NM
			, TO_CHAR(NVL(A.PAYINST_INTRRATE,0) * 100) AS PAYINST_INTRRATE
			, CHARGER_NO
			, A.CHRGE_KND
		FROM ASSETS_RENT_F A
		WHERE A.QUAY_GROUP_CD='H'
			AND A.PRT_AT_CODE = #prtAtCode#
			AND A.MNG_YEAR = #mngYear#
			AND A.MNG_NO = #mngNo#
			AND A.MNG_CNT = #mngCnt#
    </select>

    <select id="gamHtldRentMngtDao.selectHtldRentMngtExist_S" parameterClass="gamHtldRentMngtVO" resultClass="java.lang.Integer">
    	SELECT count(*)
		FROM ASSETS_RENT_F A
		WHERE A.QUAY_GROUP_CD='H'
			AND A.PRT_AT_CODE = #prtAtCode#
			AND A.MNG_YEAR = #mngYear#
			AND A.MNG_NO = #mngNo#
			AND A.MNG_CNT = #mngCnt#
    </select>

    <select id="gamHtldRentMngtDao.selectHtldRentMngtExtend_S" parameterClass="gamHtldRentMngtVO" resultMap="gamHtldRentMngtInfoMap">
          SELECT
              A.PRT_AT_CODE
            , A.QUAY_GROUP_CD
            , A.MNG_YEAR
            , A.MNG_NO
			, LPAD(TO_NUMBER(A.MNG_CNT, '99')+1, 2, '0') MNG_CNT
            , A.RENT_AREA_CD
            , GAM_GETCODENAME('GAM062', A.RENT_AREA_CD) RENT_AREA
            , A.ENTRPSCD
            , GAM_GETENTRPSNM(A.ENTRPSCD, '1') ENTRPS_NM
            , '2' REQST_SE_CD
            , NVL(A.GR_AR,0) GR_AR
            , NVL(A.GR_FEE,0) GR_FEE
            , A.PRMISN_YN
			, TO_CHAR(A.GR_USAGE_PD_FROM+(A.GR_USAGE_PD_TO-A.GR_USAGE_PD_FROM)+1, 'YYYY-MM-DD') GR_USAGE_PD_FROM
			, TO_CHAR(A.GR_USAGE_PD_TO+(A.GR_USAGE_PD_TO-A.GR_USAGE_PD_FROM)+1, 'YYYY-MM-DD') GR_USAGE_PD_TO
            , #regUsr# REG_USR
            , TO_CHAR(SYSDATE, 'YYYY-MM-DD') REGIST_DT
            , '' UPD_USR
            , '' UPDT_DT
            , A.GIS_CD
            , TO_CHAR(A.FRST_REQST_DT, 'YYYY-MM-DD') FRST_REQST_DT
            , '' SANCTN_STTUS
            , '' SANCTN_STTUS_NM
            , '' SANCTNER_EMPL_NO
            , '' SANCTN_DT
            , TO_CHAR(SYSDATE, 'YYYY-MM-DD') REQST_DT
			, #deptcd# DEPTCD
            , GAM_GETDEPTNAME(#deptcd#) DEPTCD_NM
            , A.OPER_YR_MT
            , A.COMP_TP
            , A.FRGHT_TP
			, A.TAXT_SE
			, GAM_GETCODENAME('GAM016', A.TAXT_SE) AS TAXT_SE_NM
			, A.NTIC_MTH
			, GAM_GETCODENAME('GAM008', A.NTIC_MTH) AS NTIC_MTH_NM
			, TO_CHAR(A.FRST_PRMISN_DT, 'YYYY-MM-DD') FRST_PRMISN_DT
			, '' PRMISN_DT
			, '' PRMISN_YN
			, A.DOC_NO
			, A.RM
			, A.CMT
			, A.ETC
			, NVL(A.GR_RDCXPT_FEE,0) GR_RDCXPT_FEE
			, A.PAY_MTH
			, GAM_GETCODENAME('GAM043', A.PAY_MTH) PAY_MTH_NM
			, TO_CHAR(NVL(A.PAYINST_INTRRATE,0) * 100) AS PAYINST_INTRRATE
			, A.CHARGER_NO
		FROM ASSETS_RENT_F A
		WHERE A.QUAY_GROUP_CD='H'
			AND A.PRT_AT_CODE = #prtAtCode#
			AND A.MNG_YEAR = #mngYear#
			AND A.MNG_NO = #mngNo#
			AND A.MNG_CNT = #mngCnt#
    </select>

    <select id="gamHtldRentMngtDao.selectHtldRentMngtExtendDetailList_D" parameterClass="gamHtldRentMngtVO" resultMap="gamHtldRentMngtInfoDetailMap">
		SELECT
			A.ASSETS_USAGE_SEQ
			, A.PRT_AT_CODE
			, A.MNG_YEAR
			, A.MNG_NO
			, LPAD(TO_NUMBER(A.MNG_CNT, '99')+1, 2, '0') MNG_CNT
			, A.QUAY_GROUP_CD
			, A.QUAY_CD
			, A.GIS_ASSETS_PRT_AT_CODE
			, A.GIS_ASSETS_CD
			, A.GIS_ASSETS_SUB_CD
			, NVL(A.USAGE_AR,0) USAGE_AR
			, TO_CHAR(A.USAGE_PD_FROM+(A.USAGE_PD_TO-A.USAGE_PD_FROM)+1,'YYYY-MM-DD') USAGE_PD_FROM
			, TO_CHAR(A.USAGE_PD_TO+(A.USAGE_PD_TO-A.USAGE_PD_FROM)+1,'YYYY-MM-DD') USAGE_PD_TO
			, A.USAGE_PURPS
			, A.USAGE_DTLS
			, A.USAGE_PRPOS_CD
			, A.EXEMPT_SE
			, A.EXEMPT_RSN_CD
			, A.EXEMPT_RSN
			, TO_CHAR(A.EXEMPT_PD_FROM+(A.EXEMPT_PD_TO-A.EXEMPT_PD_FROM)+1,'YYYY-MM-DD') EXEMPT_PD_FROM
			, TO_CHAR(A.EXEMPT_PD_TO+(A.EXEMPT_PD_TO-A.EXEMPT_PD_FROM)+1,'YYYY-MM-DD') EXEMPT_PD_TO
			, A.COMPUT_DTLS
			, A.OLNLP
			, A.APPLC_PRICE
			, A.APPLC_TARIFF
			, A.APPLC_MTH
			, A.PACK_SE
			, A.ENTRPS_SE
			, A.FEE_CALC_SE
			, A.RDCXPT_FEE_CALC_SE
			, NVL(A.RDCXPT_FEE,0) RDCXPT_FEE
			, NVL(A.FEE,0) FEE
			, '' TRMNAT_DT
			, '' TRMNAT_RSN
			, A.GIS_CD
			, #regUsr# REG_USR
			, SYSDATE REGIST_DT
			, '' UPD_USR
			, '' UPDT_DT
		FROM ASSETS_RENT_DETAIL_F A
		WHERE 1=1
			AND A.PRT_AT_CODE = #prtAtCode#
			AND A.MNG_YEAR = #mngYear#
			AND A.MNG_NO = #mngNo#
			AND A.MNG_CNT = #mngCnt#
			ORDER BY ASSETS_USAGE_SEQ
    </select>


    <select id="gamHtldRentMngtDao.selectHtldRentMngtMaxKey_S" parameterClass="gamHtldRentMngtVO" resultMap="gamHtldRentMngtInfoMaxKeyMap">
		SELECT
			TO_CHAR(SYSDATE, 'YYYY') MNG_YEAR,
			LPAD(NVL(MAX(MNG_NO),0) + 1,'3','0') MNG_NO,
			'01' MNG_CNT
		FROM ASSETS_RENT_F
		WHERE PRT_AT_CODE=#prtAtCode#
		AND MNG_YEAR = TO_CHAR(SYSDATE, 'YYYY')
    </select>

    <insert id="gamHtldRentMngtDao.insertHtldRentMngt_S">
	    INSERT
		INTO ASSETS_RENT_F
		  (
		    PRT_AT_CODE ,
		    MNG_YEAR ,
		    MNG_NO ,
		    MNG_CNT ,
		    ENTRPSCD ,
		    ENTRPS_NM,
		    REQST_DT ,
		    REQST_SE_CD ,
		    GR_AR ,
		    GR_FEE ,
		    TAXT_SE ,
		    NTIC_MTH ,
		    FRST_PRMISN_DT ,
		    PRMISN_DT ,
		    DOC_NO ,
		    GR_USAGE_PD_FROM ,
		    GR_USAGE_PD_TO ,
		    PRMISN_YN ,
		    RM ,
		    CMT ,
		    ETC ,
		    REG_USR ,
		    REGIST_DT ,
		    UPD_USR ,
		    UPDT_DT ,
		    GR_RDCXPT_FEE ,
		    GIS_CD ,
		    DEPTCD ,
		    PAY_MTH ,
		    QUAY_GROUP_CD ,
		    FRST_REQST_DT ,
		    SANCTN_STTUS ,
		    PAYINST_INTRRATE ,
		    CHARGER_NO,
		    RENT_AREA_CD,
		    OPER_YR_MT,
		    COMP_TP,
		    FRGHT_TP,
		    CHRGE_KND
		  )
		  VALUES
		  (
		    #prtAtCode# ,
		    #mngYear# ,
		    #mngNo# ,
		    #mngCnt# ,
		    #entrpscd# ,
		    (SELECT ENTRPS_NM FROM ENTRPS_INFO_F WHERE ENTRPSCD=#entrpscd#) ,
		    TO_DATE(#reqstDt#,'YYYY-MM-DD') ,
		    #reqstSeCd# ,
		    #grAr# ,
		    #grFee# ,
		    #taxtSe# ,
		    #nticMth# ,
		    '' ,
		    '' ,
		    #docNo# ,
		    TO_DATE(#grUsagePdFrom#, 'YYYY-MM-DD') ,
		    TO_DATE(#grUsagePdTo#, 'YYYY-MM-DD') ,
		    '' ,
		    #rm# ,
		    #cmt# ,
		    #etc# ,
		    #regUsr# ,
		    SYSDATE ,
		    '' ,
		    '' ,
		    #grRdcxptFee# ,
		    #gisCd# ,
		    #deptcd# ,
		    #payMth# ,
		    'H' ,
		    TO_DATE(#frstReqstDt#, 'YYYY-MM-DD') ,
		    'N' ,
		    TO_NUMBER(NVL(#payinstIntrrate#, 0)) / 100 ,
		    #chargerNo#,
		    #rentAreaCd#,
		    #operYrMt#,
		    #compTp#,
		    #frghtTp#,
		    #chrgeKnd#
		     )
    </insert>

    <update id="gamHtldRentMngtDao.updateHtldRentMngt_S">
        UPDATE ASSETS_RENT_F SET
	         ENTRPSCD         = #entrpscd#
	       , ENTRPS_NM         = (SELECT ENTRPS_NM FROM ENTRPS_INFO_F WHERE ENTRPSCD=#entrpscd#)
	       , RENT_AREA_CD = #rentAreaCd#
	       , OPER_YR_MT = #operYrMt#
	       , FRGHT_TP = #frghtTp#
	       , COMP_TP = #compTp#
	       , REQST_DT    = TO_DATE(#reqstDt#, 'YYYY-MM-DD')
	       , REQST_SE_CD      = '3'
	       , GR_AR            = #grAr#
	       , GR_FEE           = #grFee#
	       , NTIC_MTH         = #nticMth#
	       , GR_USAGE_PD_FROM = TO_DATE(#grUsagePdFrom#, 'YYYY-MM-DD')
	       , GR_USAGE_PD_TO   = TO_DATE(#grUsagePdTo#, 'YYYY-MM-DD')
	       , DOC_NO           = #docNo#
	       , RM               = #rm#
	       , CMT              = #cmt#
	       , ETC              = #etc#
	       , UPD_USR          = #updUsr#
	       , UPDT_DT          = SYSDATE
	       , GR_RDCXPT_FEE    = #grRdcxptFee#
	       , GIS_CD           = #gisCd#
	       , DEPTCD           = #deptcd#
	       , PAY_MTH          = #payMth#
	       , TAXT_SE	= #taxtSe#
	       <isEmpty property="payinstIntrrate">
	       , PAYINST_INTRRATE = 0
	       </isEmpty>

          <isNotEmpty property="payinstIntrrate">
             , PAYINST_INTRRATE = TO_NUMBER(#payinstIntrrate#) / 100
             </isNotEmpty>
		, CHARGER_NO = #chargerNo#
		, CHRGE_KND = #chrgeKnd#

		WHERE  PRT_AT_CODE        = #prtAtCode#
		AND    MNG_YEAR           = #mngYear#
		AND    MNG_NO             = #mngNo#
		AND    MNG_CNT            = #mngCnt#
    </update>

    <delete id="gamHtldRentMngtDao.deleteHtldRentMngt_S">
        DELETE FROM ASSETS_RENT_F
         WHERE PRT_AT_CODE = #prtAtCode#
           AND MNG_YEAR    = #mngYear#
           AND MNG_NO      = #mngNo#
           AND MNG_CNT     = #mngCnt#
           AND QUAY_GROUP_CD='H'
    </delete>

    <select id="gamHtldRentMngtDao.selectHtldRentMngtDetailList_D" parameterClass="gamHtldRentMngtVO" resultClass="egovMap">
		SELECT
			A.ASSETS_USAGE_SEQ
			, A.PRT_AT_CODE
			, A.MNG_YEAR
			, A.MNG_NO
			, A.MNG_CNT
			, GAM_GETCODENAME('GAM019', A.PRT_AT_CODE) PRT_AT_CODE_NM
			, A.GIS_ASSETS_PRT_AT_CODE
			, A.GIS_ASSETS_CD
			, A.GIS_ASSETS_SUB_CD
			, GAM_GETCODENAME('GAM019', A.GIS_ASSETS_PRT_AT_CODE) GIS_ASSETS_PRT_AT_CODE_NM
			, F.GIS_ASSETS_NM
			, F.GIS_ASSETS_LOCPLC
			, F.GIS_ASSETS_LNM
			, F.GIS_ASSETS_LNM_SUB
			, F.GIS_ASSETS_AR
			, F.GIS_ASSETS_REAL_RENT_AR
			, NVL(A.USAGE_AR,0) USAGE_AR
			, TO_CHAR(A.USAGE_PD_FROM,'YYYY-MM-DD') USAGE_PD_FROM
			, TO_CHAR(A.USAGE_PD_TO,'YYYY-MM-DD') USAGE_PD_TO
			, A.USAGE_PURPS
			, A.USAGE_DTLS
			, A.USAGE_PRPOS_CD
			, A.EXEMPT_SE
			, GAM_GETCODENAME('GAM009', A.EXEMPT_SE) EXEMPT_SE_NM
			, A.EXEMPT_RSN_CD
			, GAM_GETCODENAME('GAM017', A.EXEMPT_RSN_CD) EXEMPT_RSN_CD_STR
			, A.EXEMPT_RSN
			, TO_CHAR(A.EXEMPT_PD_FROM,'YYYY-MM-DD') EXEMPT_PD_FROM
			, TO_CHAR(A.EXEMPT_PD_TO,'YYYY-MM-DD') EXEMPT_PD_TO
			, A.COMPUT_DTLS
			, A.OLNLP
			, A.APPLC_PRICE
			, A.APPLC_TARIFF
			, GAM_GETCODENAME('GAM023', A.APPLC_TARIFF) APPLC_TARIFF_NM
			, A.APPLC_MTH
			, A.PACK_SE
			, A.ENTRPS_SE
			, A.FEE_CALC_SE
			, A.RDCXPT_FEE_CALC_SE
			, NVL(A.RDCXPT_FEE,0) RDCXPT_FEE
			, NVL(A.FEE,0) FEE
			, TO_CHAR(A.TRMNAT_DT,'YYYY-MM-DD') TRMNAT_DT
			, A.TRMNAT_RSN
			, A.GIS_CD
			, A.REG_USR
			, TO_CHAR(A.REGIST_DT,'YYYY-MM-DD') REGIST_DT
			, A.UPD_USR
			, TO_CHAR(A.UPDT_DT,'YYYY-MM-DD') UPDT_DT
		FROM ASSETS_RENT_DETAIL_F A
		LEFT OUTER JOIN GIS_ASSETS_CD_F F ON
			F.GIS_ASSETS_PRT_AT_CODE = A.GIS_ASSETS_PRT_AT_CODE AND F.GIS_ASSETS_CD = A.GIS_ASSETS_CD AND F.GIS_ASSETS_SUB_CD = A.GIS_ASSETS_SUB_CD
		WHERE 1=1
			AND A.PRT_AT_CODE = #prtAtCode#
			AND A.MNG_YEAR = #mngYear#
			AND A.MNG_NO = #mngNo#
			AND A.MNG_CNT = #mngCnt#
			ORDER BY ASSETS_USAGE_SEQ
    </select>

    <insert id="gamHtldRentMngtDao.insertHtldRentMngtDetail_S">
		INSERT
		INTO ASSETS_RENT_DETAIL_F
		  (
		    ASSETS_USAGE_SEQ ,
		    MNG_YEAR ,
		    MNG_NO ,
		    MNG_CNT ,
		    PRT_AT_CODE ,
		    USAGE_PD_FROM ,
		    USAGE_PD_TO ,
		    OLNLP ,
		    APPLC_PRICE ,
		    APPLC_TARIFF ,
		    APPLC_MTH ,
		    EXEMPT_SE ,
		    EXEMPT_PD_FROM ,
		    EXEMPT_PD_TO ,
		    EXEMPT_RSN_CD ,
		    EXEMPT_RSN ,
		    RDCXPT_FEE ,
		    FEE ,
		    COMPUT_DTLS ,
		    USAGE_PURPS ,
		    USAGE_DTLS ,
		    QUAY_CD ,
		    REG_USR ,
		    REGIST_DT ,
		    UPD_USR ,
		    UPDT_DT ,
		    GIS_ASSETS_PRT_AT_CODE ,
		    GIS_ASSETS_CD ,
		    GIS_ASSETS_SUB_CD ,
		    USAGE_AR,
		    QUAY_GROUP_CD
		  )
		  VALUES
		  (
		    (SELECT (NVL(MAX(TO_NUMBER(ASSETS_USAGE_SEQ)),0)+1)
			    FROM ASSETS_RENT_DETAIL_F
			    WHERE MNG_YEAR  = #mngYear#
			    AND MNG_NO      = #mngNo#
			    AND MNG_CNT     = #mngCnt#
			    AND PRT_AT_CODE = #prtAtCode#
		    ) ,
		    #mngYear# ,
		    #mngNo# ,
		    #mngCnt# ,
		    #prtAtCode# ,
		    TO_DATE(#usagePdFrom#, 'YYYY-MM-DD') ,
		    TO_DATE(#usagePdTo#, 'YYYY-MM-DD') ,
		    REPLACE(#olnlp#,',','') ,
		    REPLACE(#applcPrice#,',','') ,
		    REPLACE(#applcTariff#,',','') ,
		    #applcMth# ,
		    #exemptSe# ,
		    TO_DATE(#exemptPdFrom#, 'YYYY-MM-DD') ,
		    TO_DATE(#exemptPdTo#, 'YYYY-MM-DD') ,
		    #exemptRsnCd# ,
		    #exemptRsn# ,
		    REPLACE(#rdcxptFee#,',','') ,
		    REPLACE(#fee#,',','') ,
		    #computDtls# ,
		    #usagePurps# ,
		    #usageDtls# ,
		    #quayCd# ,
		    #regUsr# ,
		    SYSDATE ,
		    '' ,
		    '' ,
		    #gisAssetsPrtAtCode# ,
		    #gisAssetsCd# ,
		    #gisAssetsSubCd# ,
		    REPLACE(#usageAr#,',',''),
		    #quayGroupCd#
		  )
    </insert>

    <update id="gamHtldRentMngtDao.updateHtldRentMngtDetail_S">
        UPDATE ASSETS_RENT_DETAIL_F SET
		         GIS_ASSETS_CD          = #gisAssetsCd#
		       , GIS_ASSETS_SUB_CD      = #gisAssetsSubCd#
		       , USAGE_AR               = REPLACE(#usageAr#,',','')
		       , USAGE_PD_FROM          = TO_DATE(#usagePdFrom#, 'YYYY-MM-DD')
		       , USAGE_PD_TO            = TO_DATE(#usagePdTo#, 'YYYY-MM-DD')
		       , USAGE_PURPS            = #usagePurps#
		       , USAGE_DTLS             = #usageDtls#
		       , EXEMPT_SE              = #exemptSe#
		       , EXEMPT_RSN_CD          = #exemptRsnCd#
		       , EXEMPT_RSN             = #exemptRsn#
		       , EXEMPT_PD_FROM         = TO_DATE(#exemptPdFrom#, 'YYYY-MM-DD')
		       , EXEMPT_PD_TO           = TO_DATE(#exemptPdTo#, 'YYYY-MM-DD')
		       , COMPUT_DTLS            = #computDtls#
		       , OLNLP                  = REPLACE(#olnlp#,',','')
		       , APPLC_PRICE	= REPLACE(#applcPrice#,',','')
		       , APPLC_TARIFF           = REPLACE(#applcTariff#,',','')
		       , APPLC_MTH              = #applcMth#
		       , RDCXPT_FEE             = REPLACE(#rdcxptFee#,',','')
		       , FEE                    = REPLACE(#fee#,',','')
		       , UPD_USR                = #updUsr#
		       , UPDT_DT                = SYSDATE
		       , GIS_ASSETS_PRT_AT_CODE = #gisAssetsPrtAtCode#
		       , QUAY_CD                = #quayCd#
		  WHERE  ASSETS_USAGE_SEQ       = #assetsUsageSeq#
		    AND  MNG_YEAR               = #mngYear#
		    AND  MNG_NO                 = #mngNo#
		    AND  MNG_CNT                = #mngCnt#
		    AND  PRT_AT_CODE            = #prtAtCode#
    </update>

    <delete id="gamHtldRentMngtDao.deleteHtldRentMngtDetail_S">
        DELETE FROM ASSETS_RENT_DETAIL_F
         WHERE PRT_AT_CODE = #prtAtCode#
           AND MNG_YEAR    = #mngYear#
           AND MNG_NO      = #mngNo#
           AND MNG_CNT     = #mngCnt#
           AND ASSETS_USAGE_SEQ     = #assetsUsageSeq#
    </delete>

    <select id="gamHtldRentMngtDao.selectHtldRentMngtFileList_D" parameterClass="gamHtldRentMngtVO" resultClass="egovMap">
        SELECT A.*
           FROM (
                   SELECT  ROWNUM RNUM, S.*
                     FROM (

                           SELECT
					                A.PHOTO_SEQ
					              , A.PHOTO_SJ
					              , A.FILENM_PHYSICL
					              , A.FILENM_LOGIC
					              , TO_CHAR(A.SHOT_DT, 'YYYY-MM-DD') SHOT_DT
					              , A.REG_USR
					              , TO_CHAR(A.REGIST_DT, 'YYYY-MM-DD') REGIST_DT
					              , A.PRT_AT_CODE
					              , A.MNG_YEAR
					              , A.MNG_NO
					              , A.MNG_CNT
					              , A.PHOTO_DESC
					         FROM ASSETS_RENT_PHOTO_F A
					        WHERE PRT_AT_CODE = #prtAtCode#
					          AND MNG_YEAR    = #mngYear#
					          AND MNG_NO      = #mngNo#
					          AND MNG_CNT     = #mngCnt#
					        ORDER BY A.PHOTO_SEQ DESC
                ) S
             ) A
        <![CDATA[ WHERE ROWNUM <= #recordCountPerPage# and RNUM > #firstIndex# ]]>

    </select>

    <insert id="gamHtldRentMngtDao.insertHtldRentMngtFile_S">
        INSERT INTO ASSETS_RENT_PHOTO_F (
                                             PHOTO_SEQ
                                           , PHOTO_SJ
                                           , FILENM_PHYSICL
                                           , FILENM_LOGIC
                                           , SHOT_DT
                                           , REG_USR
                                           , REGIST_DT
                                           , PRT_AT_CODE
                                           , MNG_YEAR
                                           , MNG_NO
                                           , MNG_CNT
                                           , PHOTO_DESC
                                        )
                                 VALUES (
                                             (SELECT LPAD(NVL(MAX(PHOTO_SEQ),0) + 1,'2','0')
												FROM ASSETS_RENT_PHOTO_F AF
												WHERE  PRT_AT_CODE = '622'
												AND    MNG_YEAR    = #mngYear#
												AND    MNG_NO      = #mngNo#
												AND    MNG_CNT     = #mngCnt#)
                                           , #photoSj#
                                           , #filenmPhysicl#
                                           , #filenmLogic#
                                           , TO_DATE(#shotDt#,'YYYY-MM-DD')
                                           , #regUsr#
                                           , SYSDATE
                                           , #prtAtCode#
                                           , #mngYear#
                                           , #mngNo#
                                           , #mngCnt#
                                           , #photoDesc#
                                        )
    </insert>

    <update id="gamHtldRentMngtDao.updateHtldRentMngtFile_S">
        UPDATE ASSETS_RENT_PHOTO_F SET
		       PHOTO_SJ       = #photoSj#,
		       <!-- FILENM_PHYSICL = :FILENM_PHYSICL,
		       FILENM_LOGIC   = :FILENM_LOGIC, -->
		       SHOT_DT        = TO_DATE(#shotDt#,'YYYY-MM-DD'),
		       <!-- REG_USR        = :REG_USR,
		       REGIST_DT      = :REGIST_DT,-->
		       PHOTO_DESC     = #photoDesc#
		WHERE  PHOTO_SEQ      = #photoSeq#
		AND    PRT_AT_CODE    = #prtAtCode#
		AND    MNG_YEAR       = #mngYear#
		AND    MNG_NO         = #mngNo#
		AND    MNG_CNT        = #mngCnt#
    </update>

    <delete id="gamHtldRentMngtDao.deleteHtldRentMngtPhotoSingle_S">
        DELETE FROM ASSETS_RENT_PHOTO_F
         WHERE PHOTO_SEQ   = #photoSeq#
           AND PRT_AT_CODE = #prtAtCode#
           AND MNG_YEAR    = #mngYear#
           AND MNG_NO      = #mngNo#
           AND MNG_CNT     = #mngCnt#
    </delete>

    <insert id="gamHtldRentMngtDao.insertHtldRentMngtExtend_S">
  	    <selectKey keyProperty="mngCnt" resultClass="java.lang.String">
	       SELECT
	              LPAD(TO_NUMBER(A.MNG_CNT, '99')+1, 2, '0') mngCnt
             FROM ASSETS_RENT_F
            WHERE PRT_AT_CODE = #prtAtCode#
           		AND MNG_YEAR    = #mngYear#
              AND MNG_NO      = #mngNo#
              AND MNG_CNT     = #mngCnt#
	    </selectKey>
        INSERT INTO ASSETS_RENT_F (
                                     PRT_AT_CODE
                                   , MNG_YEAR
                                   , MNG_NO
                                   , MNG_CNT
                                   , ENTRPSCD
                                   , REQST_SE_CD
                                   , GR_AR
                                   , GR_FEE
                                   , NTIC_MTH
                                   , PRMISN_YN
                                   , TAXT_SE
                                   , DOC_NO
                                   , RM
                                   , CMT
                                   , ETC
                                   , REG_USR
                                   , REGIST_DT
                                   , UPD_USR
                                   , UPDT_DT
                                   , GR_RDCXPT_FEE
                                   , GIS_CD
                                   , DEPTCD
                                   , PAY_MTH
                                   , FRST_PRMISN_DT
                                   , GR_USAGE_PD_FROM
                                   , GR_USAGE_PD_TO
                                   , SANCTN_STTUS
                                   , SANCTNER_EMPL_NO
                                   , QUAY_CD
                                   , FRST_REQST_DT
                                   , QUAY_GROUP_CD
                                   , REQST_DT
                                   , PAYINST_INTRRATE
                               )
                         SELECT
                         	A.PRT_AT_CODE
                                 , A.MNG_YEAR
                                 , A.MNG_NO
                                 , LPAD(TO_NUMBER(A.MNG_CNT, '99')+1, 2, '0')
                                 , A.ENTRPSCD
                                 , '2'
                                 , A.GR_AR
                                 , A.GR_FEE
                                 , A.NTIC_MTH
                                 , 'N'
                                 , A.TAXT_SE
                                 , A.DOC_NO
                                 , A.RM
                                 , A.CMT
                                 , A.ETC
                                 , #regUsr#
                                 , SYSDATE
                                 , #updUsr#
                                 , SYSDATE
                                 , A.GR_RDCXPT_FEE
                                 , A.GIS_CD
                                 , A.DEPTCD
                                 , A.PAY_MTH
                                 , A.FRST_PRMISN_DT
                                 , A.GR_USAGE_PD_FROM+(A.GR_USAGE_PD_TO-A.GR_USAGE_PD_FROM)
                                 , A.GR_USAGE_PD_TO+(A.GR_USAGE_PD_TO-A.GR_USAGE_PD_FROM)
                                 , 'N'
                                 , A.SANCTNER_EMPL_NO
                                 , A.QUAY_CD
                                 , A.FRST_REQST_DT
                                 , A.QUAY_GROUP_CD
                                 , SYSDATE
                                 , A.PAYINST_INTRRATE
				           FROM ASSETS_RENT_F A
				          WHERE A.PRT_AT_CODE = #prtAtCode#
				            AND A.MNG_YEAR    = #mngYear#
				            AND A.MNG_NO      = #mngNo#
				            AND A.MNG_CNT     = #mngCnt#
    </insert>

    <insert id="gamHtldRentMngtDao.insertHtldRentMngtExtendDetail_D">
        INSERT INTO ASSETS_RENT_DETAIL_F (
		                                     ASSETS_USAGE_SEQ
		                                   , MNG_YEAR
                                           , MNG_NO
                                           , MNG_CNT
		                                   , PRT_AT_CODE
		                                   , USAGE_PD_FROM
                                           , USAGE_PD_TO
                                           , OLNLP
                                           , APPLC_PRICE
                                           , APPLC_TARIFF
                                           , APPLC_MTH
                                           , EXEMPT_SE
                                           , EXEMPT_PD_FROM
                                           , EXEMPT_PD_TO
                                           , EXEMPT_RSN_CD
                                           , EXEMPT_RSN
                                           , RDCXPT_FEE
                                           , FEE
                                           , COMPUT_DTLS
                                           , USAGE_PURPS
                                           , USAGE_DTLS
                                           , QUAY_CD
                                           , REG_USR
                                           , REGIST_DT
                                           , UPD_USR
                                           , UPDT_DT
                                           , GIS_ASSETS_CD
                                           , GIS_ASSETS_SUB_CD
                                           , GIS_ASSETS_PRT_AT_CODE
                                           , USAGE_AR
		                                 )
                         SELECT
											A.ASSETS_USAGE_SEQ
		                                   , A.MNG_YEAR
                                           , A.MNG_NO
                                           , LPAD(TO_NUMBER(A.MNG_CNT, '99')+1, 2, '0')
		                                   , A.PRT_AT_CODE
		                                   , A.USAGE_PD_FROM+(A.USAGE_PD_TO-A.USAGE_PD_FROM)
                                           , A.USAGE_PD_TO+(A.USAGE_PD_TO-A.USAGE_PD_FROM)
                                           , A.OLNLP
                                           , A.APPLC_PRICE
                                           , A.APPLC_TARIFF
                                           , A.APPLC_MTH
                                           , A.EXEMPT_SE
                                           , A.EXEMPT_PD_FROM+(A.EXEMPT_PD_TO-A.EXEMPT_PD_FROM)
                                           , A.EXEMPT_PD_TO+(A.EXEMPT_PD_TO-A.EXEMPT_PD_FROM)
                                           , A.EXEMPT_RSN_CD
                                           , A.EXEMPT_RSN
                                           , A.RDCXPT_FEE
                                           , A.FEE
                                           , A.COMPUT_DTLS
                                           , A.USAGE_PURPS
                                           , A.USAGE_DTLS
                                           , A.QUAY_CD
                                			, #regUsr#
                                           , A.REGIST_DT
                                 			, #updUsr#
                                           , A.UPDT_DT
                                           , A.GIS_ASSETS_CD
                                           , A.GIS_ASSETS_SUB_CD
                                           , A.GIS_ASSETS_PRT_AT_CODE
                                           , A.USAGE_AR
				           FROM ASSETS_RENT_DETAIL_F A
				          WHERE A.PRT_AT_CODE = #prtAtCode#
				            AND A.MNG_YEAR    = #mngYear#
				            AND A.MNG_NO      = #mngNo#
				            AND A.MNG_CNT     = #mngCnt#
    </insert>

    <select id="gamHtldRentMngtDao.selectHtldRentMngtNticLevReqestCnt_S" parameterClass="gamHtldRentMngtVO" resultClass="int">
	    SELECT COUNT(*) LEV_REQEST_CNT
	      FROM LEV_REQEST_F A
	     WHERE A.PRT_AT_CODE = #prtAtCode#
           AND A.MNG_YEAR    = #mngYear#
           AND A.MNG_NO      = #mngNo#
           AND A.MNG_CNT     = #mngCnt#
           AND A.NHT_ISUE_YN='Y'
    </select>


    <select id="gamHtldRentMngtDao.selectHtldRentMngtLevReqestCnt_S" parameterClass="gamHtldRentMngtVO" resultClass="int">
	    SELECT COUNT(*) LEV_REQEST_CNT
	      FROM LEV_REQEST_F A
	     WHERE A.PRT_AT_CODE = #prtAtCode#
           AND A.MNG_YEAR    = #mngYear#
           AND A.MNG_NO      = #mngNo#
           AND A.MNG_CNT     = #mngCnt#
           AND A.QUAY_GROUP_CD='H'
    </select>

    <delete id="gamHtldRentMngtDao.deleteHtldRentMngtDetails_D">
        DELETE FROM ASSETS_RENT_DETAIL_F
         WHERE PRT_AT_CODE = #prtAtCode#
           AND MNG_YEAR    = #mngYear#
           AND MNG_NO      = #mngNo#
           AND MNG_CNT     = #mngCnt#
           AND QUAY_GROUP_CD='H'
    </delete>

    <delete id="gamHtldRentMngtDao.deleteHtldRentMngtPhoto_S">
        DELETE FROM ASSETS_RENT_PHOTO_F
         WHERE PRT_AT_CODE = #prtAtCode#
           AND MNG_YEAR    = #mngYear#
           AND MNG_NO      = #mngNo#
           AND MNG_CNT     = #mngCnt#
           AND QUAY_GROUP_CD='H'
    </delete>

    <select id="gamHtldRentMngtDao.selectHtldRentMngtPrmisnInfo_S" parameterClass="gamHtldRentMngtVO" resultMap="gamHtldRentMngtInfoMap">
        SELECT   A.PRT_AT_CODE
               , A.MNG_YEAR
               , A.MNG_NO
               , A.MNG_CNT
               , A.ENTRPSCD
               , ( SELECT E.ENTRPS_NM FROM ENTRPS_INFO_F E WHERE E.ENTRPSCD = A.ENTRPSCD AND ROWNUM = 1 ) ENTRPS_NM
               , A.REQST_SE_CD
               , A.GR_AR
               , A.GR_FEE
               , A.NTIC_MTH
               , A.TAXT_SE
               , TO_CHAR(A.FRST_PRMISN_DT, 'YYYY-MM-DD') FRST_PRMISN_DT
               , TO_CHAR(A.PRMISN_DT, 'YYYY-MM-DD') PRMISN_DT
               , A.PRMISN_YN
               , TO_CHAR(A.GR_USAGE_PD_FROM, 'YYYY-MM-DD') GR_USAGE_PD_FROM
               , TO_CHAR(A.GR_USAGE_PD_TO, 'YYYY-MM-DD') GR_USAGE_PD_TO
               , A.DOC_NO
               , A.RM
               , A.CMT
               , A.ETC
               , A.REG_USR
               , A.REGIST_DT
               , A.UPD_USR
               , A.UPDT_DT
               , A.GR_RDCXPT_FEE
               , A.GIS_CD
               , A.DEPTCD
               , A.PAY_MTH
          FROM ASSETS_RENT_F A
         WHERE 1=1
           AND A.MNG_YEAR         = #mngYear#
           AND A.MNG_NO           = #mngNo#
           AND A.MNG_CNT          = #mngCnt#
           AND A.PRT_AT_CODE      = #prtAtCode#
           AND A.QUAY_GROUP_CD='H'
    </select>

    <update id="gamHtldRentMngtDao.updateHtldRentMngtComment_S">
        UPDATE ASSETS_RENT_F SET
		       CMT = #cmt#
		WHERE PRT_AT_CODE = '622'
		 AND MNG_YEAR    = #mngYear#
		 AND MNG_NO      = #mngNo#
		 AND MNG_CNT     = #mngCnt#
    </update>

    <select id="gamHtldRentMngtDao.selectCofixInfo_S" resultClass="egovMap">
            SELECT
			        '' CODE_ID
			      , TRIM(TO_CHAR(NEW_MANIP_AMT_STDR_INTRRATE, '0.0000')) CODE
			      , (TO_CHAR(TO_DATE(OBJ_YRMT, 'YYYY-MM'), 'YYYY-MM') || ' : ' || (NEW_MANIP_AMT_STDR_INTRRATE * 100) || '% [' || TO_CHAR(ANNODT,'YYYY-MM-DD') || ']') CODE_NM
			      , '' CODE_DC
			  FROM COFIX_INTRRATE_F
			 ORDER BY OBJ_YRMT DESC
    </select>

    <select id="gamHtldRentMngtDao.selectHtldRentMngtCofixInfo_S" parameterClass="hashMap" resultClass="egovMap">
		   SELECT
                   OBJ_YRMT
                 , TRIM(TO_CHAR(BLCE_STDR_INTRRATE, '0.0000')) BLCE_STDR_INTRRATE
                 , TRIM(TO_CHAR(BLCE_STDR_INTRRATE * 100, '0.00')) BLCE_STDR_INTRRATE_SHOW
                 , NEW_MANIP_AMT_STDR_INTRRATE
                 , TO_CHAR(ANNODT,'YYYYMMDD') ANNODT
              FROM (
                    SELECT
                             OBJ_YRMT
                           , BLCE_STDR_INTRRATE
                           , NEW_MANIP_AMT_STDR_INTRRATE
                           , ANNODT
                       FROM COFIX_INTRRATE_F
                    WHERE SUBSTR(OBJ_YRMT,1,4) = #thisYear# <!-- '2013' -->
                    AND SUBSTR(OBJ_YRMT,5,2) BETWEEN #divSt# AND #divEnd# <!-- '10' AND '12' -->
                    ORDER BY OBJ_YRMT DESC
                  ) WHERE ROWNUM = 1
    </select>

    <select id="gamHtldRentMngtDao.selectHtldRentMngtCofixInfoMax_S" parameterClass="hashMap" resultClass="egovMap">
        SELECT
		        A.OBJ_YRMT
		      , TRIM(TO_CHAR(A.BLCE_STDR_INTRRATE, '0.0000')) BLCE_STDR_INTRRATE
		      , TRIM(TO_CHAR(A.BLCE_STDR_INTRRATE * 100, '0.00')) BLCE_STDR_INTRRATE_SHOW
		      , A.NEW_MANIP_AMT_STDR_INTRRATE
		      , TO_CHAR(A.ANNODT,'YYYYMMDD') ANNODT
		  FROM COFIX_INTRRATE_F A
		 WHERE A.OBJ_YRMT = ( SELECT MAX(B.OBJ_YRMT) FROM COFIX_INTRRATE_F B )
    </select>

	<select id="gamHtldRentMngtDao.selectChargeKndList_D" parameterClass="gamHtldRentMngtVO" resultClass="egovMap">
            		<![CDATA[
			SELECT
			PRT_AT_CODE, FEE_TP, FEE_TP_KOR_NM
			FROM
			FEE_TP_F
			WHERE
			PRT_AT_CODE=#prtAtCode#
			AND QUAY_GROUP_CD = 'H'
				AND FEE_TP NOT IN ('A3', 'A4', 'UG', 'DA')
			ORDER BY FEE_TP
		]]>
    </select>

   <select id="gamHtldRentMngtDao.selectHtldAssessSeNmList_D" resultClass="egovMap">
   	select CODE "NAME", CODE_NM "VALUE" from comtccmmndetailcode
	where code_id='GAM071'
   </select>

   <select id="gamHtldRentMngtDao.selectHtldAssessList_D" parameterClass="gamHtldRentMngtVO" resultClass="egovMap">
		SELECT A.*
		FROM (
			SELECT ROWNUM RNUM, S.*
			FROM (
				SELECT
					PRT_AT_CODE,
					MNG_YEAR,
					MNG_NO,
					MNG_CNT,
					ASSESS_NO,
					ASSESS_NO OLD_ASSESS_NO,
					ASSESS_SE,
					GAM_GETCODENAME('GAM071', ASSESS_SE) ASSESS_SE_NM,
					TO_CHAR(DT_FROM, 'YYYY-MM-DD') DT_FROM,
					TO_CHAR(DT_TO, 'YYYY-MM-DD') DT_TO,
					ASSESS_RESULT,
					APPLC_PRICE,
					TO_CHAR(ASSESS_DT, 'YYYY-MM-DD') ASSESS_DT
				FROM HTLD_RENT_ASSESS_F A
				WHERE 1=1
					AND A.PRT_AT_CODE = #prtAtCode#
					AND A.MNG_YEAR = #mngYear#
					AND A.MNG_NO = #mngNo#
					AND A.MNG_CNT = #mngCnt#
				ORDER BY ASSESS_NO
			) S
		) A
        <![CDATA[ WHERE ROWNUM <= #recordCountPerPage# and RNUM > #firstIndex# ]]>
    </select>

    <select id="gamHtldRentMngtDao.selectHtldAssessSum_S" parameterClass="gamHtldRentMngtVO" resultClass="egovMap">
		SELECT
			COUNT(*) RESULT_COUNT
		FROM HTLD_RENT_ASSESS_F A
		WHERE 1=1
			AND A.PRT_AT_CODE = #prtAtCode#
			AND A.MNG_YEAR = #mngYear#
			AND A.MNG_NO = #mngNo#
			AND A.MNG_CNT = #mngCnt#
			AND A.ASSESS_RESULT IS NOT NULL
    </select>

   <insert id="gamHtldRentMngtDao.insertHtldAssess_S" parameterClass="gamHtldAssessVO">
	   	INSERT INTO HTLD_RENT_ASSESS_F (
			PRT_AT_CODE,
			MNG_YEAR,
			MNG_NO,
			MNG_CNT,
			ASSESS_NO,
			ASSESS_SE,
			ASSESS_RESULT,
			APPLC_PRICE,
			DT_FROM,
			DT_TO,
			ASSESS_DT
	   	)
	   	VALUES (
	   		#prtAtCode#,
			#mngYear#,
			#mngNo#,
			#mngCnt#,
			#assessNo#,
			#assessSe#,
			#assessResult#,
			#applcPrice#,
			TO_DATE(#dtFrom#, 'YYYY-MM-DD'),
			TO_DATE(#dtTo#, 'YYYY-MM-DD'),
			TO_DATE(#assessDt#, 'YYYY-MM-DD')
	   	)
    </insert>

   <update id="gamHtldRentMngtDao.updateHtldAssess_S" parameterClass="gamHtldAssessVO">
	   	UPDATE HTLD_RENT_ASSESS_F SET
	   		ASSESS_NO=#assessNo#,
	   		ASSESS_SE=#assessSe#,
			ASSESS_RESULT=#assessResult#,
			APPLC_PRICE=#applcPrice#,
			DT_FROM=TO_DATE(#dtFrom#, 'YYYY-MM-DD'),
			DT_TO=TO_DATE(#dtTo#, 'YYYY-MM-DD'),
			ASSESS_DT=TO_DATE(#assessDt#, 'YYYY-MM-DD')
		WHERE
			PRT_AT_CODE=#prtAtCode#
			AND MNG_YEAR=#mngYear#
			AND MNG_NO=#mngNo#
			AND MNG_CNT=#mngCnt#
			AND ASSESS_NO=#oldAssessNo#
    </update>

   <update id="gamHtldRentMngtDao.deleteHtldAssess_S" parameterClass="gamHtldAssessVO">
	   	DELETE HTLD_RENT_ASSESS_F
	   	WHERE
			PRT_AT_CODE=#prtAtCode#
			AND MNG_YEAR=#mngYear#
			AND MNG_NO=#mngNo#
			AND MNG_CNT=#mngCnt#
			AND ASSESS_NO=#oldAssessNo#
    </update>

    <update id="gamHtldRentMngtDao.applyHtldAssess_D" parameterClass="gamHtldAssessVO">
    <![CDATA[
        UPDATE lev_reqest_f l
		SET ( fee, vat, ntic_amt ) = (select fee, fee*0.1 vat, fee*1.1 ntic_amt
		    from (
		       select aL.PRT_AT_CODE,aL.MNG_YEAR, aL.MNG_NO, aL.MNG_CNT, al.ntic_cnt, trunc((SELECT SUM(usage_ar*(applc_price+nvl(a.assess_result,0))*MONTHS_BETWEEN(al.ntic_pd_to+1, al.ntic_pd_from))
				  FROM assets_rent_detail_f
				  WHERE prt_at_code=al.prt_at_code
				  AND mng_year     =al.mng_year
				  AND mng_no       =al.mng_no
				  AND mng_cnt      =al.mng_cnt), -1) fee
		    from lev_reqest_f al left outer join htld_rent_assess_f a
		      on 		A.prt_at_code   =aL.PRT_AT_CODE
				AND A.MNG_YEAR      =aL.MNG_YEAR
				AND A.MNG_NO        =aL.MNG_NO
				AND A.MNG_CNT       =aL.MNG_CNT
		    AND al.NTIC_PD_FROM > a.DT_FROM
		    AND al.NTIC_PD_TO < a.DT_TO+1
		      ) bl
		      WHERE 1             =1
		      and l.prt_at_code=bl.prt_at_code
		      and l.mng_year=bl.mng_year
		      and l.mng_No=bl.mng_No
		      and l.mng_Cnt=bl.mng_Cnt
		      and l.ntic_cnt=bl.ntic_cnt)
		WHERE 1             =1
		      and l.prt_at_code=#prtAtCode#
		      and l.mng_year=#mngYear#
		      and l.mng_No=#mngNo#
		      and l.mng_Cnt=#mngCnt#
	          AND l.nht_isue_yn='N'
	          ]]>
    </update>

   <select id="gamHtldRentMngtDao.selectHtldNticRcivList_D" parameterClass="gamHtldRentMngtVO" resultClass="egovMap">
	SELECT A.*
	FROM (
		SELECT ROWNUM RNUM, S.*
		FROM (
			select
				L.PRT_AT_CODE,
				L.MNG_YEAR,
				L.MNG_NO,
				L.MNG_CNT,
				L.NTIC_CNT,
				L.CHRGE_KND,
				GAM_GET_FEE_TP_NM(L.PRT_AT_CODE,'H',L.CHRGE_KND) CHRGE_KND_NM,
				TO_CHAR(L.ntic_pd_from, 'YYYY-MM-DD') ntic_pd_from,
        		TO_CHAR(L.ntic_pd_to, 'YYYY-MM-DD') ntic_pd_to,
				'00' NTIC_SER_NO,
				r.bill_amnt,
				to_char(r.bill_dt, 'YYYY-MM-DD') bill_dt,
				to_char(r.ocr_dt, 'YYYY-MM-DD') ocr_dt,
				to_char(r.rcvd_dt, 'YYYY-MM-DD') rcvd_dt,
				r.rcvd_tp
			from lev_reqest_f l, REV_COLL_F r
			where
				l.prt_at_code=r.prt_at_code
				and l.accnut_year=r.fiscal_yr
				and l.nticno=r.bill_no
				AND L.PRT_AT_CODE = #prtAtCode#
				AND L.MNG_YEAR = #mngYear#
				AND L.MNG_NO = #mngNo#
				AND L.MNG_CNT = #mngCnt#
			union
			select
				L.PRT_AT_CODE,
				L.MNG_YEAR,
				L.MNG_NO,
				L.MNG_CNT,
				L.NTIC_CNT,
				L.CHRGE_KND,
				GAM_GET_FEE_TP_NM(L.PRT_AT_CODE,'H',L.CHRGE_KND) CHRGE_KND_NM,
				TO_CHAR(L.ntic_pd_from, 'YYYY-MM-DD') ntic_pd_from,
        		TO_CHAR(L.ntic_pd_to, 'YYYY-MM-DD') ntic_pd_to,
				u.dly_ser_no ntic_ser_no,
				u.dly_bill_amnt bill_amnt,
				to_char(u.dly_bill_dt, 'YYYY-MM-DD') bill_dt,
				to_char(u.ocr_dt, 'YYYY-MM-DD') ocr_dt,
				to_char(u.dly_rcvd_dt, 'YYYY-MM-DD') rcvd_dt,
				u.dly_rcvd_tp rcvd_tp
			from lev_reqest_f l, unpaid_f u
			where
				l.prt_at_code=u.prt_at_code
				and l.accnut_year=u.fiscal_yr
				and l.nticno=u.bill_no
				AND L.PRT_AT_CODE = #prtAtCode#
				AND L.MNG_YEAR = #mngYear#
				AND L.MNG_NO = #mngNo#
				AND L.MNG_CNT = #mngCnt#
		) S
		order by S.bill_dt desc

	) A
        <![CDATA[ WHERE ROWNUM <= #recordCountPerPage# and RNUM > #firstIndex# ]]>
    </select>

    <select id="gamHtldRentMngtDao.selectHtldNticRcivSum_S" parameterClass="gamHtldRentMngtVO" resultClass="egovMap">
		select
  			SUM(DECODE(rcvd_tp, '2', bill_amnt_sum, '3', bill_amnt_sum, 0)) rcvd_amnt_sum,
			SUM(DECODE(rcvd_tp, '2', 0, '3', 0, bill_amnt_sum)) not_rcvd_amnt_sum
		from (
			  SELECT
			    rcvd_tp,
			    SUM(bill_amnt) bill_amnt_sum
			      from (
			select
			  r.bill_amnt,
			  r.rcvd_tp
			from lev_reqest_f l, REV_COLL_F r
			where
			  l.prt_at_code=r.prt_at_code
			  and l.accnut_year=r.fiscal_yr
			  and l.nticno=r.bill_no
			AND L.PRT_AT_CODE = #prtAtCode#
			AND L.MNG_YEAR = #mngYear#
			AND L.MNG_NO = #mngNo#
			AND L.MNG_CNT = #mngCnt#
			union
			  select
			  u.dly_bill_amnt bill_amnt,
			  u.dly_rcvd_tp rcvd_tp
			from lev_reqest_f l, unpaid_f u
			where
			  l.prt_at_code=u.prt_at_code
			  and l.accnut_year=u.fiscal_yr
			  and l.nticno=u.bill_no
			AND L.PRT_AT_CODE = #prtAtCode#
			AND L.MNG_YEAR = #mngYear#
			AND L.MNG_NO = #mngNo#
			AND L.MNG_CNT = #mngCnt#
			)
			group by rcvd_tp
		)
    </select>

     <insert id="gamHtldRentMngtDao.insertBillCreate" parameterClass="gamHtldRentMngtLevReqestVO">
		INSERT INTO LEV_REQEST_F (
				PRT_AT_CODE, MNG_YEAR, MNG_NO, MNG_CNT, NTIC_CNT, CHRGE_KND, ENTRPSCD, ENTRPS_NM,
				NTIC_PD_FROM, NTIC_PD_TO,
				PAY_TMLMT, NTICNO, NTIC_DT, RCIV_SE, NHT_ISUE_YN,
				FEE, VAT, VAT_YN, NTIC_AMT, NTIC_MTH, REG_USR, REGIST_DT,DEPTCD, FCLTY_SE
		)
		VALUES
		(
				#prtAtCode#, #mngYear#, #mngNo#, #mngCnt#, LPAD(#nticCnt#, 2, '0'), #chrgeKnd#, #entrpscd#, #entrpsNm#,
				#nticPdFrom#, #nticPdTo#,
				'', '', '', '0', 'N',
				#fee#, #vat#, #vatYn#, #nticAmt#, #nticMth#, #regUsr#, #registDt#, #deptcd#, #fcltySe#
		)
    </insert>

    <delete id="gamHtldRentMngtDao.deleteBillByRentMngtVO_D">
        DELETE FROM LEV_REQEST_F
         WHERE PRT_AT_CODE = #prtAtCode#
           AND MNG_YEAR    = #mngYear#
           AND MNG_NO      = #mngNo#
           AND MNG_CNT     = #mngCnt#
           AND (NHT_ISUE_YN IS NULL OR NHT_ISUE_YN = 'N')
    </delete>



    <!-- 승낙 처리 (징수의뢰 일괄생성 insert) -->
     <insert id="gamHtldRentMngtDao.insertBillCreateOnce" parameterClass="hashMap">
		INSERT INTO LEV_REQEST_F (
				PRT_AT_CODE, MNG_YEAR, MNG_NO, MNG_CNT, NTIC_CNT, FCLTY_SE, CHRGE_KND, ENTRPSCD, ENTRPS_NM,
				NTIC_PD_FROM, NTIC_PD_TO, PAY_TMLMT, NTICNO, NTIC_DT, RCIV_SE, NHT_ISUE_YN,
				 OLNLP, FEE, VAT, VAT_YN, NTIC_AMT, RM, NTIC_MTH, REG_USR, REGIST_DT,DEPTCD
		)
		SELECT
			AR.PRT_AT_CODE, AR.MNG_YEAR, AR.MNG_NO, AR.MNG_CNT, '01',  '1',
		  #chrgeKnd#,
		  MAX(AR.ENTRPSCD),
		  MAX(EI.ENTRPS_NM),
			  MIN(AR.GR_USAGE_PD_FROM),
			  MAX(AR.GR_USAGE_PD_TO),
			  <!--
		  <isEqual property="payMth" compareValue="Aft">
		  	MAX(AR.GR_USAGE_PD_TO),
		  </isEqual>
		  <isEqual property="payMth" compareValue="Pre">
		  	MIN(AR.GR_USAGE_PD_FROM),
		  </isEqual>
		   -->
		   null,
		  (SELECT MAX(NTICNO)+1 FROM LEV_REQEST_F) NTICNO,
		  '',
		  '0',
		  'N',
		  MAX(PFUD.OLNLP),
		  MAX(AR.GR_FEE),
		  case
		  when MAX(AR.TAXT_SE)='2' THEN trunc(MAX(AR.GR_FEE)/10, -1)
		  else 0
		  END,
		  MAX(AR.TAXT_SE),
		  case
		  when MAX(AR.TAXT_SE)='2' THEN MAX(AR.GR_FEE)+trunc(MAX(AR.GR_FEE)/10, -1)
		  else MAX(AR.GR_FEE)
		  END,
		  MAX(AR.RM),
		  MAX(AR.NTIC_MTH), #regUsr#, SYSDATE,#deptcd#
		FROM   ASSETS_RENT_F AR, ASSETS_RENT_DETAIL_F PFUD, ENTRPS_INFO_F EI
		WHERE AR.PRT_AT_CODE=PFUD.PRT_AT_CODE
			AND AR.MNG_YEAR=PFUD.MNG_YEAR
			AND AR.MNG_NO=PFUD.MNG_NO
			AND AR.MNG_CNT=PFUD.MNG_CNT
			AND AR.ENTRPSCD=EI.ENTRPSCD
			AND AR.PRT_AT_CODE=#prtAtCode#
			AND AR.MNG_YEAR=#mngYear#
			AND AR.MNG_NO=#mngNo#
			AND AR.MNG_CNT=#mngCnt#
		GROUP BY AR.PRT_AT_CODE, AR.MNG_YEAR, AR.MNG_NO, AR.MNG_CNT
    </insert>

    <!-- 승낙 처리 (징수의뢰 분납생성 insert) -->
    <insert id="gamHtldRentMngtDao.insertBillCreateMore" parameterClass="hashMap">
		<![CDATA[
		INSERT INTO LEV_REQEST_F (
				PRT_AT_CODE, MNG_YEAR, MNG_NO, MNG_CNT, NTIC_CNT, FCLTY_SE, CHRGE_KND, ENTRPSCD,ENTRPS_NM,
				NTIC_PD_FROM, NTIC_PD_TO,
				NTICNO, RCIV_SE, NHT_ISUE_YN, PAY_TMLMT,
				 OLNLP, FEE, VAT, VAT_YN, NTIC_AMT, RM,
				  NTIC_MTH, REG_USR, REGIST_DT
		)
		SELECT
		#prtAtCode#, #mngYear#, #mngNo#, #mngCnt#, LPAD(NTIC_CNT, 2, '0'), '1', FEE_TP, #entrpscd# ENTRPSCD, (SELECT ENTRPS_NM FROM ENTRPS_INFO_F WHERE ENTRPSCD=#entrpscd#),
		START_DATE NTIC_PD_FROM, END_DATE NTIC_PD_TO,
		(SELECT MAX(NTICNO)+1 FROM LEV_REQEST_F) NTICNO, '0', 'N',
		]]>
			null,
		<!--
		  <isEqual property="payMth" compareValue="Pre">
			START_DATE,
			</isEqual>
		  <isEqual property="payMth" compareValue="Aft">
			END_DATE,
			</isEqual>
			 -->
		<![CDATA[
		(SELECT MAX(OLNLP) FROM ASSETS_RENT_DETAIL_F WHERE PRT_AT_CODE=#prtAtCode# AND MNG_YEAR=#mngYear# AND MNG_NO=#mngNo# AND MNG_CNT=#mngCnt#) OLNLP, RNTFEE, TRUNC(RNTFEE/10, -1), #taxtSe#,RNTFEE + TRUNC(RNTFEE / 10, -1), #rm#,
		#nticMth#, #regUsr#, SYSDATE
		from (
			SELECT FEE_TP, NTIC_CNT, DECODE(FEE_TP, #chrgeKnd#, RNTFEE, 'A3', TRUNC(REFE*(#blTpNum#)/12*RATE, -1)) RNTFEE, REFE, START_DATE, PREV_DUE_DATE, DUE_DATE, END_DATE
			FROM (
			SELECT ROWNUM  as NTIC_CNT, #chrgeKnd# FEE_TP, 1 RATE,
				  TRUNC(#grFee# / (TRUNC(MONTHS_BETWEEN(TO_DATE(#grUsagePdTo#,'YYYY-MM-DD'), TO_DATE(#grUsagePdFrom#,'YYYY-MM-DD')) / #blTpNum#)+1), -1) as RNTFEE,
				  TRUNC(#grFee# - ((#grFee#/(TRUNC(MONTHS_BETWEEN(TO_DATE(#grUsagePdTo#,'YYYY-MM-DD'), TO_DATE(#grUsagePdFrom#,'YYYY-MM-DD')) / #blTpNum#)+1)) * (ROWNUM)), -1) as REFE,
				  ADD_MONTHS(TO_DATE(#grUsagePdFrom#,'YYYY-MM-DD'), #blTpNum#     * (ROWNUM-1))                            AS START_DATE,
	        DECODE(ROWNUM, 1, 0, ADD_MONTHS(TO_DATE(#grUsagePdFrom#,'YYYY-MM-DD'), #blTpNum#     * (ROWNUM-1))-ADD_MONTHS(TO_DATE(#grUsagePdFrom#,'YYYY-MM-DD'), #blTpNum#     * (ROWNUM-1)-1)) AS RATE_DAY,
	          LAG(ADD_MONTHS(TO_DATE(#grUsagePdFrom#,'YYYY-MM-DD'), #blTpNum# * (ROWNUM-1))+14) OVER (ORDER BY ROWNUM) AS PREV_DUE_DATE,
				  ADD_MONTHS(TO_DATE(#grUsagePdFrom#,'YYYY-MM-DD'), #blTpNum#     * (ROWNUM-1))+14 AS DUE_DATE,
				  (
				    CASE
				      WHEN TO_DATE(#grUsagePdTo#,'YYYY-MM-DD') < ADD_MONTHS(TO_DATE(#grUsagePdFrom#,'YYYY-MM-DD'), #blTpNum# * ROWNUM) - 1 THEN
				          TO_DATE(#grUsagePdTo#,'YYYY-MM-DD')
				    ELSE
				          ADD_MONTHS(TO_DATE(#grUsagePdFrom#,'YYYY-MM-DD'), #blTpNum# * ROWNUM) - 1
				     END
				   ) as END_DATE
				FROM COMTCCMMNDETAILCODE
				WHERE ROWNUM <= (TRUNC(MONTHS_BETWEEN(TO_DATE(#grUsagePdTo#,'YYYY-MM-DD'), TO_DATE(#grUsagePdFrom#,'YYYY-MM-DD')) / #blTpNum#)+1)
	      )
		)
		WHERE RNTFEE<>0
		]]>
    </insert>

</sqlMap>
