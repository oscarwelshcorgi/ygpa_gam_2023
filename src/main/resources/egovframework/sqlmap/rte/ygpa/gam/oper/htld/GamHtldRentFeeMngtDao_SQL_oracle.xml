<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="ygpa.gam.oper.htld">

	<typeAlias alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
    <typeAlias alias="hashMap" type="java.util.HashMap"/>
    <typeAlias alias="gamHtldRentFeeMngtVO" type="egovframework.rte.ygpa.gam.oper.htld.service.GamHtldRentFeeMngtVO"/>
    <typeAlias alias="gamHtldRentFeeDefaultVO" type="egovframework.rte.ygpa.gam.oper.htld.service.GamHtldRentFeeDefaultVO"/>

    <resultMap id="gamHtldRentFeeMngtInfoMap" class="egovframework.rte.ygpa.gam.oper.htld.service.GamHtldRentFeeMngtVO">
        <result property="nticCnt" column="NTIC_CNT" columnIndex="1"/>
		<result property="fcltySe" column="FCLTY_SE" columnIndex="2"/>
		<result property="chrgeKnd" column="CHRGE_KND" columnIndex="3"/>
		<result property="entrpscd" column="ENTRPSCD" columnIndex="4"/>
		<result property="entrpsNm" column="ENTRPS_NM" columnIndex="5"/>
		<result property="nticPdFrom" column="NTIC_PD_FROM" columnIndex="6"/>
		<result property="nticPdTo" column="NTIC_PD_TO" columnIndex="7"/>
		<result property="accnutYear" column="ACCNUT_YEAR" columnIndex="8"/>
		<result property="nticno" column="NTICNO" columnIndex="9"/>
		<result property="nticDt" column="NTIC_DT" columnIndex="10"/>
		<result property="payTmlmt" column="PAY_TMLMT" columnIndex="11"/>
		<result property="sanctnSttus" column="SANCTN_STTUS"/>
		<result property="sanctnerEmplNo" column="SANCTNER_EMPL_NO"/>
		<result property="sanctnDt" column="SANCTN_DT"/>
		<result property="olnlp" column="OLNLP" columnIndex="12"/>
		<result property="fee" column="FEE" columnIndex="13"/>
		<result property="vatYn" column="VAT_YN" columnIndex="14"/>
		<result property="vat" column="VAT" columnIndex="15"/>
		<result property="nticAmt" column="NTIC_AMT" columnIndex="16"/>
		<result property="rm" column="RM" columnIndex="17"/>
		<result property="rcivSe" column="RCIV_SE" columnIndex="18"/>
		<result property="rcivDt" column="RCIV_DT" columnIndex="19"/>
		<result property="nhtIsueYn" column="NHT_ISUE_YN" columnIndex="20"/>
		<result property="arrrgNo" column="ARRRG_NO" columnIndex="21"/>
		<result property="arrrgAmt" column="ARRRG_AMT" columnIndex="22"/>
		<result property="reqestSeq" column="REQEST_SEQ" columnIndex="23"/>
		<result property="deptcd" column="DEPTCD" columnIndex="24"/>
		<result property="nticMth" column="NTIC_MTH" columnIndex="25"/>
		<result property="regUsr" column="REG_USR" columnIndex="26"/>
		<result property="registDt" column="REGIST_DT" columnIndex="27"/>
		<result property="updUsr" column="UPD_USR" columnIndex="28"/>
		<result property="updtDt" column="UPDT_DT" columnIndex="29"/>
		<result property="prtAtCode" column="PRT_AT_CODE" columnIndex="30"/>
		<result property="mngYear" column="MNG_YEAR" columnIndex="31"/>
		<result property="mngNo" column="MNG_NO" columnIndex="32"/>
		<result property="mngCnt" column="MNG_CNT" columnIndex="33"/>
    </resultMap>

	<select id="gamHtldRentFeeMngtDao.selectHtldRentFeeMngtList_D" parameterClass="gamHtldRentFeeDefaultVO" resultClass="egovMap">
		<![CDATA[
			SELECT A.RENT_AREA_CD,
		  GAM_GETCODENAME('GAM062', A.RENT_AREA_CD) RENT_AREA,
		  A.MNG_YEAR
		    || '-'
		    || A.MNG_NO
		    || '-'
		    || A.MNG_CNT AS RENT_MNG_NO,
		  L.NTIC_CNT,
		  L.FCLTY_SE ,
		  L.CHRGE_KND ,
		  GAM_GET_FEE_TP_NM(A.PRT_AT_CODE, 'H', L.CHRGE_KND) CHRGE_KND_NM,
		  A.ENTRPSCD ,
		  A.ENTRPS_NM ,
		  L.NTIC_MTH,
		  TO_CHAR(A.GR_USAGE_PD_TO, 'YYYY-MM-DD') GR_USAGE_PD_TO ,
		  GAM_GETCODENAME('GAM008', L.NTIC_MTH) NTIC_MTH_NM,
		  TO_CHAR(L.NTIC_PD_FROM, 'YYYY-MM-DD') NTIC_PD_FROM ,
		  TO_CHAR(L.NTIC_PD_TO, 'YYYY-MM-DD') NTIC_PD_TO ,
		  L.ACCNUT_YEAR ,
		  L.NTICNO ,
		  TO_CHAR(L.NTIC_DT, 'YYYY-MM-DD') NTIC_DT ,
		  TO_CHAR(L.PAY_TMLMT, 'YYYY-MM-DD') PAY_TMLMT ,
		  L.SANCTN_STTUS ,
		  L.SANCTNER_EMPL_NO ,
		  TO_CHAR(L.SANCTN_DT) SANCTN_DT ,
		  GAM_GETCODENAME('GAM046', L.SANCTN_STTUS) SANCTN_STTUS_NM ,
		  NVL(L.OLNLP,0) OLNLP ,
		  NVL(L.FEE, 0) FEE ,
		  NVL(L.VAT_YN, A.TAXT_SE) VAT_YN,
		  NVL(L.VAT,0) VAT,
		  NVL(L.NTIC_AMT,0) NTIC_AMT ,
		  NVL(L.INTR_AMNT, 0) INTR_AMNT,
		  NVL(L.ADD_AMNT, 0) ADD_AMNT,
		  L.ADD_AMNT_RM,
		  NVL(L.INTR_RATE, GAM_GET_COFIX_INTRRATE(L.NTIC_PD_FROM))*100 INTR_RATE,
		  NVL(L.cofix_obj_yrmt, GAM_GET_COFIX_OBJ_YRMT(L.NTIC_PD_FROM)) cofix_obj_yrmt,
		  L.RM ,
		  L.RCIV_SE ,
		  TO_CHAR(L.RCIV_DT, 'YYYY-MM-DD') RCIV_DT ,
		  L.NHT_ISUE_YN ,
		  NVL(L.NHT_PRINT_YN,'N') AS NHT_PRINT_YN ,
		  L.ARRRG_NO ,
		  NVL(L.ARRRG_AMT,0) ARRRG_AMT ,
		  L.ARRRG_TARIFF ,
		  L.ARRRG_PAY_DATES ,
		  L.REQEST_SEQ ,
		  L.DEPTCD ,
		  L.REG_USR ,
		  TO_CHAR(L.REGIST_DT, 'YYYY-MM-DD') REGIST_DT ,
		  L.UPD_USR ,
		  L.ASSESS_SE , 
		  TO_CHAR(L.UPDT_DT, 'YYYY-MM-DD') UPDT_DT ,
		  A.PRT_AT_CODE ,
		  A.MNG_YEAR ,
		  A.MNG_NO ,
		  A.MNG_CNT ,
		  A.TAXT_SE,
		  GAM_GETCODENAME('GAM019', A.PRT_AT_CODE) PRT_AT_CODE_NM ,
		  GAM_GETDEPTNAME(L.DEPTCD) DEPTCD_NM ,
		  NVL(A.GR_AR,0) GR_AR ,
		  TO_CHAR(A.GR_USAGE_PD_FROM, 'YYYY-MM-DD') GR_USAGE_PD_FROM ,
		  TO_CHAR(A.GR_USAGE_PD_TO, 'YYYY-MM-DD') GR_USAGE_PD_TO ,
		  L.ADIT_NTIC_YN
		  ]]>
		FROM ASSETS_RENT_F A,
		  lev_reqest_f L
		WHERE 1             =1
		AND A.prt_at_code   =L.PRT_AT_CODE
		AND A.MNG_YEAR      =L.MNG_YEAR
		AND A.MNG_NO        =L.MNG_NO
		AND A.MNG_CNT       =L.MNG_CNT
		AND A.quay_group_cd = 'H'
		<isNotEmpty property="nticPdFrom" prepend="AND">
		<![CDATA[
			L.NTIC_PD_FROM >= TO_DATE(#nticPdFrom#, 'YYYY-MM-DD')
			]]>
		</isNotEmpty>
		<isNotEmpty property="nticPdTo" prepend="AND">
		<![CDATA[
			L.NTIC_PD_FROM < TO_DATE(#nticPdTo#, 'YYYY-MM-DD')+1
			]]>
		</isNotEmpty>
		<isNotEmpty property="sPrtAtCode" prepend="AND">
		<![CDATA[
			A.PRT_AT_CODE=#sPrtAtCode#
			]]>
		</isNotEmpty>
		<isNotEmpty property="sMngYear" prepend="AND">
		<![CDATA[
			A.MNG_YEAR=#sMngYear#
			]]>
		</isNotEmpty>
		<isNotEmpty property="sMngNo" prepend="AND">
		<![CDATA[
			A.MNG_NO=#sMngNo#
			]]>
		</isNotEmpty>
				<isNotEmpty property="sMngCnt" prepend="AND">
		<![CDATA[
			A.MNG_CNT=#sMngCnt#
			]]>
		</isNotEmpty>
		<isNotEmpty property="sEntrpscd" prepend="AND">
		<![CDATA[
			A.ENTRPSCD LIKE #sEntrpscd# || '%'
			]]>
		</isNotEmpty>
		<isNotEmpty property="sEntrpsNm" prepend="AND">
		<![CDATA[
			A.ENTRPS_NM LIKE '%' || #sEntrpsNm# || '%'
			]]>
		</isNotEmpty>
		<isEqual property="sNhtIsueYn" compareValue="Y" prepend="AND">
		<![CDATA[
			(L.NHT_ISUE_YN IS NOT NULL AND L.NHT_ISUE_YN='Y')
			]]>
		</isEqual>
		ORDER BY A.RENT_AREA_CD ASC, A.ENTRPS_NM ASC, L.NTIC_CNT ASC
    </select>

    <select id="gamHtldRentFeeMngtDao.selectHtldRentFeeMngtListTotCnt_S" parameterClass="gamHtldRentFeeDefaultVO" resultClass="int">
    	SELECT count(*)
    	FROM ASSETS_RENT_F A,
		  lev_reqest_f L
		WHERE 1             =1
		AND A.prt_at_code   =L.PRT_AT_CODE
		AND A.MNG_YEAR      =L.MNG_YEAR
		AND A.MNG_NO        =L.MNG_NO
		AND A.MNG_CNT       =L.MNG_CNT
		AND A.quay_group_cd = 'H'
		<isNotEmpty property="nticPdFrom" prepend="AND">
		<![CDATA[
			L.NTIC_PD_FROM >= TO_DATE(#nticPdFrom#, 'YYYY-MM-DD')
			]]>
		</isNotEmpty>
		<isNotEmpty property="nticPdTo" prepend="AND">
		<![CDATA[
			L.NTIC_PD_FROM < TO_DATE(#nticPdTo#, 'YYYY-MM-DD')
			]]>
		</isNotEmpty>
		<isNotEmpty property="sPrtAtCode" prepend="AND">
		<![CDATA[
			A.PRT_AT_CODE=#sPrtAtCode#
			]]>
		</isNotEmpty>
		<isNotEmpty property="sMngYear" prepend="AND">
		<![CDATA[
			A.MNG_YEAR=#sMngYear#
			]]>
		</isNotEmpty>
				<isNotEmpty property="sMngNo" prepend="AND">
		<![CDATA[
			A.MNG_NO=#sMngNo#
			]]>
		</isNotEmpty>
				<isNotEmpty property="sMngCnt" prepend="AND">
		<![CDATA[
			A.MNG_CNT=#sMngCnt#
			]]>
		</isNotEmpty>
				<isNotEmpty property="sEntrpscd" prepend="AND">
		<![CDATA[
			A.ENTRPSCD LIKE #sEntrpscd# || '%'
			]]>
		</isNotEmpty>
				<isNotEmpty property="sEntrpsNm" prepend="AND">
		<![CDATA[
			A.ENTRPS_NM LIKE '%' || #sEntrpsNm# || '%'
			]]>
		</isNotEmpty>
		<isEqual property="sNhtIsueYn" compareValue="Y" prepend="AND">
		<![CDATA[
			(L.NHT_ISUE_YN IS NOT NULL AND L.NHT_ISUE_YN='Y')
			]]>
		</isEqual>
   	</select>

	<select id="gamHtldRentFeeMngtDao.selectHtldAssetsDetailList_D" parameterClass="gamHtldRentFeeDefaultVO" resultClass="egovMap">
		SELECT
			D.ASSETS_USAGE_SEQ,
			D.PRT_AT_CODE,
			D.MNG_YEAR,
			D.MNG_NO,
			D.MNG_CNT,
			D.USAGE_AR,
			D.APPLC_PRICE,
			NVL(D.PRICE_SE, '1') PRICE_SE      
		FROM
			ASSETS_RENT_DETAIL_F D,
      		ASSETS_RENT_F A
    	WHERE D.PRT_AT_CODE = A.PRT_AT_CODE 
     		AND D.MNG_YEAR = A.MNG_YEAR
      		AND D.MNG_NO = A.MNG_NO
      		AND D.MNG_CNT = A.MNG_CNT
      		AND A.QUAY_GROUP_CD = 'H'
			<isNotEmpty property="sPrtAtCode" prepend="AND">
			<![CDATA[
				D.PRT_AT_CODE=#sPrtAtCode#
				]]>
			</isNotEmpty>
			<isNotEmpty property="sMngYear" prepend="AND">
			<![CDATA[
				D.MNG_YEAR=#sMngYear#
				]]>
			</isNotEmpty>
			<isNotEmpty property="sMngNo" prepend="AND">
			<![CDATA[
				D.MNG_NO=#sMngNo#
				]]>
			</isNotEmpty>
			<isNotEmpty property="sMngCnt" prepend="AND">
			<![CDATA[
				D.MNG_CNT=#sMngCnt#
				]]>
			</isNotEmpty>			
	</select>
	
    <select id="gamHtldRentFeeMngtDao.selectHtldRentFeeMngtList_D_backup" parameterClass="gamHtldRentFeeDefaultVO" resultClass="egovMap">
		SELECT Z.* FROM (
           SELECT ROWNUM RNUM, A.*
           FROM (
                   SELECT
                      S.RENT_AREA_CD,
                      GAM_GETCODENAME('GAM062', S.RENT_AREA_CD) RENT_AREA,
                   	  S.PRT_AT_CODE,
					  S.MNG_YEAR,
					  S.MNG_NO,
					  S.MNG_CNT,
					  S.PRT_AT_CODE_NM,
					  S.MNG_YEAR || '-' || S.MNG_NO || '-' || S.MNG_CNT AS RENT_MNG_NO,
					  S.NTIC_CNT,
					  S.ENTRPSCD,
					  S.ENTRPS_NM,
					  S.NTIC_MTH,
					  S.NTIC_MTH_NM,
					  S.GR_AR,
					  S.GR_USAGE_PD_FROM,
					  S.GR_USAGE_PD_TO,
					  S.NTIC_PD_FROM,
					  S.NTIC_PD_TO,
					  S.NTICNO,
					  S.CHRGE_KND,
					  GAM_GET_FEE_TP_NM(S.PRT_AT_CODE, 'H', S.CHRGE_KND) CHRGE_KND_NM,
			        TRUNC(
					      CASE
					        WHEN S.NTIC_PD_FROM IS NULL
					        THEN
					          CASE
					            WHEN S.ntic_mth='1'
					            THEN S.TOTAL_PRICE
					            WHEN S.ntic_mth='2'
					            THEN S.YEAR_PRICE/2
					            WHEN S.ntic_mth='3'
					            THEN S.YEAR_PRICE/3
					            WHEN S.ntic_mth='4'
					            THEN S.YEAR_PRICE/4
					            WHEN S.NTIC_MTH='5'
					            THEN S.YEAR_PRICE/12
					            ELSE S.YEAR_PRICE
					          END
					        ELSE S.FEE
					      END, -1) FEE ,
					      CASE
					        WHEN S.NTIC_PD_FROM IS NULL
					        THEN TRUNC(
					          CASE
					            WHEN S.TAXT_SE='1'
					            OR S.TAXT_SE  ='2'
					            THEN
					              CASE
					                WHEN S.ntic_mth='1'
					                THEN TRUNC(S.TOTAL_PRICE, -1)/10
					                WHEN S.ntic_mth='2'
					                THEN TRUNC(S.YEAR_PRICE/2, -1)/10
					                WHEN S.ntic_mth='3'
					                THEN TRUNC(S.YEAR_PRICE/3, -1)/10
					                WHEN S.ntic_mth='4'
					                THEN TRUNC(S.YEAR_PRICE/4, -1)/10
					                WHEN S.ntic_mth='5'
					                THEN TRUNC(S.YEAR_PRICE/12, -1)/10
					                ELSE S.YEAR_PRICE      /10
					              END
					            ELSE 0
					          END , -1)
					        ELSE S.VAT
					      END VAT ,
					  S.VAT_YN,
					  S.NTIC_AMT,
					  S.INTR_AMNT INTR_AMNT,
					  S.INTR_RATE,
					  S.COFIX_OBJ_YRMT,
					  S.SANCTN_STTUS_NM,
					  S.SANCTN_STTUS,
					  S.NTIC_DT,
					  S.PAY_TMLMT,
					  S.NHT_ISUE_YN,
					  S.NHT_PRINT_YN,
					  S.ARRRG_NO,
					  S.ARRRG_AMT,
					  S.ARRRG_TARIFF,
					  S.ARRRG_PAY_DATES,
					  S.DEPTCD_NM,
					  S.ADIT_NTIC_YN,
					  S.YEAR_PRICE
					FROM
					  (select
					  A.RENT_AREA_CD,
					  NVL(L.NTIC_CNT, lpad((select nvl(max(ntic_cnt),0)+1 from lev_reqest_f where prt_at_code=a.prt_at_code and mng_year=a.mng_year and mng_no=a.mng_no and mng_cnt=a.mng_cnt), 2, '0')) NTIC_CNT,
					  L.FCLTY_SE ,
					  L.CHRGE_KND ,
					  A.ENTRPSCD ,
					  A.ENTRPS_NM ,
					  A.NTIC_MTH,
					  GAM_GETCODENAME('GAM008', A.NTIC_MTH) NTIC_MTH_NM,
					  TO_CHAR(L.NTIC_PD_FROM, 'YYYY-MM-DD') NTIC_PD_FROM ,
					  TO_CHAR(L.NTIC_PD_TO, 'YYYY-MM-DD') NTIC_PD_TO ,
					  L.ACCNUT_YEAR ,
					  L.NTICNO ,
					  TO_CHAR(L.NTIC_DT, 'YYYY-MM-DD') NTIC_DT ,
					  TO_CHAR(L.PAY_TMLMT, 'YYYY-MM-DD') PAY_TMLMT ,
					  L.SANCTN_STTUS ,
					  L.SANCTNER_EMPL_NO ,
					  TO_CHAR(L.SANCTN_DT) SANCTN_DT ,
					  GAM_GETCODENAME('GAM046', L.SANCTN_STTUS) SANCTN_STTUS_NM ,
					  NVL(L.OLNLP,0) OLNLP ,
					  NVL(L.FEE, 0) FEE ,
					  NVL(L.VAT_YN, A.TAXT_SE) VAT_YN,
					  NVL(L.VAT,0) VAT ,
					  NVL(L.NTIC_AMT,0) NTIC_AMT ,
					  NVL(L.INTR_AMNT, 0) INTR_AMNT,
					  <isNotEmpty property="grUsagePdFrom">
					  <![CDATA[
					  	NVL(L.INTR_RATE, (select BLCE_STDR_INTRRATE
							from cofix_intrrate_f
							where obj_yrmt=(select case
							  when to_char(to_date(#grUsagePdFrom#, 'YYYY-MM-DD'), 'MM')<4 then to_char(to_date(#grUsagePdFrom#, 'YYYY-MM-DD')-365, 'YYYY')||'12'
							  when to_char(to_date(#grUsagePdFrom#, 'YYYY-MM-DD'), 'MM')<7 then to_char(to_date(#grUsagePdFrom#, 'YYYY-MM-DD'), 'YYYY')||'03'
							  when to_char(to_date(#grUsagePdFrom#, 'YYYY-MM-DD'), 'MM')<10 then to_char(to_date(#grUsagePdFrom#, 'YYYY-MM-DD'), 'YYYY')||'06'
							  else to_char(to_date(#grUsagePdFrom#, 'YYYY-MM-DD'), 'YYYY')||'09'
							  end
							from dual)))*100 INTR_RATE,
						  NVL(L.cofix_obj_yrmt, (select case
							  when to_char(to_date(#grUsagePdFrom#, 'YYYY-MM-DD'), 'MM')<4 then to_char(to_date(#grUsagePdFrom#, 'YYYY-MM-DD')-365, 'YYYY')||'12'
							  when to_char(to_date(#grUsagePdFrom#, 'YYYY-MM-DD'), 'MM')<7 then to_char(to_date(#grUsagePdFrom#, 'YYYY-MM-DD'), 'YYYY')||'03'
							  when to_char(to_date(#grUsagePdFrom#, 'YYYY-MM-DD'), 'MM')<10 then to_char(to_date(#grUsagePdFrom#, 'YYYY-MM-DD'), 'YYYY')||'06'
							  else to_char(to_date(#grUsagePdFrom#, 'YYYY-MM-DD'), 'YYYY')||'09'
							  end
							from dual)) cofix_obj_yrmt,
						]]>
					  </isNotEmpty>
					  <isEmpty property="grUsagePdFrom">
					  <![CDATA[
						  NVL(L.INTR_RATE, (select BLCE_STDR_INTRRATE
							from cofix_intrrate_f
							where obj_yrmt=(select case
							  when to_char(SYSDATE, 'MM')<4 then to_char(SYSDATE-365, 'YYYY')||'12'
							  when to_char(SYSDATE, 'MM')<7 then to_char(SYSDATE, 'YYYY')||'03'
							  when to_char(SYSDATE, 'MM')<10 then to_char(SYSDATE, 'YYYY')||'06'
							  else to_char(SYSDATE, 'YYYY')||'09'
							  end
							from dual)))*100 INTR_RATE,
						  NVL(L.cofix_obj_yrmt, (select case
							  when to_char(SYSDATE, 'MM')<4 then to_char(SYSDATE-365, 'YYYY')||'12'
							  when to_char(SYSDATE, 'MM')<7 then to_char(SYSDATE, 'YYYY')||'03'
							  when to_char(SYSDATE, 'MM')<10 then to_char(SYSDATE, 'YYYY')||'06'
							  else to_char(SYSDATE, 'YYYY')||'09'
							  end
							from dual)) cofix_obj_yrmt,
						]]>
					  </isEmpty>
					  L.RM ,
					  L.RCIV_SE ,
					  TO_CHAR(L.RCIV_DT, 'YYYY-MM-DD') RCIV_DT ,
					  L.NHT_ISUE_YN ,
					  NVL(L.NHT_PRINT_YN,'N') AS NHT_PRINT_YN ,
					  L.ARRRG_NO ,
					  NVL(L.ARRRG_AMT,0) ARRRG_AMT ,
					  L.ARRRG_TARIFF ,
					  L.ARRRG_PAY_DATES ,
					  L.REQEST_SEQ ,
					  L.DEPTCD ,
					  L.REG_USR ,
					  TO_CHAR(L.REGIST_DT, 'YYYY-MM-DD') REGIST_DT ,
					  L.UPD_USR ,
					  TO_CHAR(L.UPDT_DT, 'YYYY-MM-DD') UPDT_DT ,
					  A.PRT_AT_CODE ,
					  A.MNG_YEAR ,
					  A.MNG_NO ,
					  A.MNG_CNT ,
					  A.TAXT_SE,
					  GAM_GETCODENAME('GAM019', A.PRT_AT_CODE) PRT_AT_CODE_NM ,
					  GAM_GETDEPTNAME(L.DEPTCD) DEPTCD_NM ,
					  NVL(A.GR_AR,0) GR_AR ,
					  TO_CHAR(A.GR_USAGE_PD_FROM, 'YYYY-MM-DD') GR_USAGE_PD_FROM ,
					  TO_CHAR(A.GR_USAGE_PD_TO, 'YYYY-MM-DD') GR_USAGE_PD_TO ,
					  ADIT_NTIC_YN,
					  (select sum(usage_ar*applc_price) from assets_rent_detail_f where prt_at_code=a.prt_at_code and mng_year=a.mng_year and mng_no=a.mng_no and mng_cnt=a.mng_cnt) year_price,
					  (SELECT
				          SUM(usage_ar*applc_price*MONTHS_BETWEEN(usage_pd_to, usage_pd_from))
				        FROM assets_rent_detail_f
				        WHERE prt_at_code=a.prt_at_code
				        AND mng_year     =a.mng_year
				        AND mng_no       =a.mng_no
				        AND mng_cnt      =a.mng_cnt
				        ) total_price
					FROM (SELECT * FROM ASSETS_RENT_F WHERE QUAY_GROUP_CD ='H') A LEFT OUTER JOIN
					  LEV_REQEST_F L
					  ON A.PRT_AT_CODE  = L.PRT_AT_CODE
					AND A.MNG_YEAR     = L.MNG_YEAR
					AND A.MNG_NO       = L.MNG_NO
					AND A.MNG_CNT      = L.MNG_CNT
               <isNotEmpty property="grUsagePdFrom">
        <![CDATA[
					AND L.NTIC_PD_FROM >= TO_DATE(#grUsagePdFrom#, 'YYYY-MM-DD')
        ]]>
               </isNotEmpty>
				<isNotEmpty property="grUsagePdTo">
        <![CDATA[
					AND L.NTIC_PD_FROM < TO_DATE(#grUsagePdTo#, 'YYYY-MM-DD')
        ]]>
               </isNotEmpty>
					WHERE 1            = 1
					AND A.QUAY_GROUP_CD='H'
               <isNotEmpty property="grUsagePdFrom">
        <![CDATA[
					AND a.gr_usage_pd_from < TO_DATE(#grUsagePdFrom#, 'YYYY-MM-DD')
					AND a.gr_usage_pd_to > TO_DATE(#grUsagePdFrom#, 'YYYY-MM-DD')
        ]]>
               </isNotEmpty>
                              <isNotEmpty property="grUsagePdTo">
        <![CDATA[
					AND a.gr_usage_pd_from < TO_DATE(#grUsagePdTo#, 'YYYY-MM-DD')
					AND a.gr_usage_pd_to > TO_DATE(#grUsagePdTo#, 'YYYY-MM-DD')
        ]]>
               </isNotEmpty>
					  ) S
    				ORDER BY RENT_AREA, NTIC_MTH_NM, ENTRPS_NM
             ) A
             ) Z
        <![CDATA[
        	WHERE ROWNUM <= #recordCountPerPage# and Z.RNUM > #firstIndex#
        ]]>
    </select>

    <select id="gamHtldRentFeeMngtDao.selectHtldRentFeeMngtListTotCnt_S_backup" parameterClass="gamHtldRentFeeDefaultVO" resultClass="int">
           SELECT COUNT(*) totcnt FROM
            	(SELECT *
              FROM (SELECT * FROM ASSETS_RENT_F WHERE QUAY_GROUP_CD ='H') A LEFT OUTER JOIN
					  LEV_REQEST_F L
					  ON A.PRT_AT_CODE  = L.PRT_AT_CODE
					AND A.MNG_YEAR     = L.MNG_YEAR
					AND A.MNG_NO       = L.MNG_NO
					AND A.MNG_CNT      = L.MNG_CNT
               <isNotEmpty property="grUsagePdFrom">
        <![CDATA[
					AND L.NTIC_PD_FROM >= TO_DATE(#grUsagePdFrom#, 'YYYY-MM-DD')
        ]]>
               </isNotEmpty>
				<isNotEmpty property="grUsagePdTo">
        <![CDATA[
					AND L.NTIC_PD_FROM < TO_DATE(#grUsagePdTo#, 'YYYY-MM-DD')
        ]]>
               </isNotEmpty>
					WHERE 1            = 1
					AND A.QUAY_GROUP_CD='H'
               <isNotEmpty property="grUsagePdFrom">
        <![CDATA[
					AND a.gr_usage_pd_from < TO_DATE(#grUsagePdFrom#, 'YYYY-MM-DD')
					AND a.gr_usage_pd_to > TO_DATE(#grUsagePdFrom#, 'YYYY-MM-DD')
        ]]>
               </isNotEmpty>
                              <isNotEmpty property="grUsagePdTo">
        <![CDATA[
					AND a.gr_usage_pd_from < TO_DATE(#grUsagePdTo#, 'YYYY-MM-DD')
					AND a.gr_usage_pd_to > TO_DATE(#grUsagePdTo#, 'YYYY-MM-DD')
        ]]>
               </isNotEmpty>
          ) Z
    </select>

    <select id="gamHtldRentFeeMngtDao.selectHtldCofix_S" parameterClass="gamHtldRentFeeDefaultVO" resultClass="egovMap">
    <![CDATA[
    	SELECT
    		NVL((select BLCE_STDR_INTRRATE
		from cofix_intrrate_f
		where obj_yrmt=(select case
		  when to_char(to_date(#grUsagePdFrom#, 'YYYY-MM-DD'), 'MM')<4 then to_char(to_date(#grUsagePdFrom#, 'YYYY-MM-DD')-365, 'YYYY')||'12'
		  when to_char(to_date(#grUsagePdFrom#, 'YYYY-MM-DD'), 'MM')<7 then to_char(to_date(#grUsagePdFrom#, 'YYYY-MM-DD'), 'YYYY')||'03'
		  when to_char(to_date(#grUsagePdFrom#, 'YYYY-MM-DD'), 'MM')<10 then to_char(to_date(#grUsagePdFrom#, 'YYYY-MM-DD'), 'YYYY')||'06'
		  else to_char(to_date(#grUsagePdFrom#, 'YYYY-MM-DD'), 'YYYY')||'09'
		  end
		from dual)), 0)*100 INTR_RATE
		FROM dual
		]]>
    </select>

    <select id="gamHtldRentFeeMngtDao.selectHtldRentFeeMngtSum_S" parameterClass="gamHtldRentFeeDefaultVO" resultClass="egovMap">
        SELECT
                 TRIM(TO_CHAR(COUNT(*), '999,999,999,999')) SUM_CNT
               , TRIM(TO_CHAR(SUM(DECODE(L.CHRGE_KND, 'A3', 0, 'A4', 0, 'D1', 0, 'D2', 0, L.FEE)), '999,999,999,999')) SUM_FEE
                   	,TRIM(TO_CHAR(SUM(DECODE(L.CHRGE_KND, 'A3', L.FEE, 0)), '999,999,999,999')) SUM_FEE_A3
                   	,TRIM(TO_CHAR(SUM(DECODE(L.CHRGE_KND, 'A4', L.FEE, 0)), '999,999,999,999')) SUM_FEE_A4
                   	,TRIM(TO_CHAR(SUM(DECODE(L.CHRGE_KND, 'D1', L.FEE, 0)), '999,999,999,999')) SUM_FEE_D1
                   	,TRIM(TO_CHAR(SUM(DECODE(L.CHRGE_KND, 'D2', L.FEE, 0)), '999,999,999,999')) SUM_FEE_D2
               ,   TRIM(TO_CHAR(SUM(NVL((CASE WHEN L.NHT_ISUE_YN = 'Y' THEN L.NTIC_AMT END), 0)) , '999,999,999,999')) SUM_NHT_ISUE_AMT
               , TRIM(TO_CHAR(SUM(NVL(L.VAT, 0)), '999,999,999,999')) SUM_VAT
               , TRIM(TO_CHAR(SUM(NVL(L.NTIC_AMT,0)), '999,999,999,999')) SUM_NTIC_AMT
          FROM (SELECT * FROM ASSETS_RENT_F WHERE QUAY_GROUP_CD ='H') A LEFT OUTER JOIN
					  LEV_REQEST_F L
					  ON A.PRT_AT_CODE  = L.PRT_AT_CODE
					AND A.MNG_YEAR     = L.MNG_YEAR
					AND A.MNG_NO       = L.MNG_NO
					AND A.MNG_CNT      = L.MNG_CNT
               <isNotEmpty property="grUsagePdFrom">
        <![CDATA[
					AND L.NTIC_PD_FROM >= TO_DATE(#grUsagePdFrom#, 'YYYY-MM-DD')
        ]]>
               </isNotEmpty>
				<isNotEmpty property="grUsagePdTo">
        <![CDATA[
					AND L.NTIC_PD_FROM < TO_DATE(#grUsagePdTo#, 'YYYY-MM-DD')
        ]]>
               </isNotEmpty>
					WHERE 1            = 1
					AND A.QUAY_GROUP_CD='H'
               <isNotEmpty property="grUsagePdFrom">
        <![CDATA[
					AND a.gr_usage_pd_from < TO_DATE(#grUsagePdFrom#, 'YYYY-MM-DD')
					AND a.gr_usage_pd_to > TO_DATE(#grUsagePdFrom#, 'YYYY-MM-DD')
        ]]>
               </isNotEmpty>
                              <isNotEmpty property="grUsagePdTo">
        <![CDATA[
					AND a.gr_usage_pd_from < TO_DATE(#grUsagePdTo#, 'YYYY-MM-DD')
					AND a.gr_usage_pd_to > TO_DATE(#grUsagePdTo#, 'YYYY-MM-DD')
        ]]>
               </isNotEmpty>
    </select>

    <update id="gamHtldRentFeeMngtDao.updateHtldRentFeeMngt_S">
        UPDATE LEV_REQEST_F SET
		       FCLTY_SE     = #fcltySe#
		     , ENTRPSCD     = #entrpscd#
		     , ENTRPS_NM    = #entrpsNm#
		     , NTIC_PD_FROM = TO_DATE(#nticPdFrom#,'YYYY-MM-DD')
		     , NTIC_PD_TO 	= TO_DATE(#nticPdTo#,'YYYY-MM-DD')
		     , ACCNUT_YEAR  = #accnutYear#
		     , NTICNO       = #nticno#
		     , NTIC_DT      = TO_DATE(#nticDt#,'YYYY-MM-DD')
		     , PAY_TMLMT    = TO_DATE(#payTmlmt#,'YYYY-MM-DD')
		     , OLNLP        = #olnlp#
		     , FEE          = #fee#
		     , VAT_YN       = #vatYn#
		     , VAT          = #vat#
		     , NTIC_AMT     = #nticAmt#
		     , RM           = #rm#
		     , RCIV_SE      = #rcivSe#
		     , RCIV_DT      = TO_DATE(#rcivDt#,'YYYY-MM-DD')
		     , NHT_ISUE_YN  = #nhtIsueYn#
		     , ARRRG_NO     = #arrrgNo#
		     , ARRRG_AMT    = #arrrgAmt#
		     , ARRRG_TARIFF    = #arrrgTariff#
		     , ARRRG_PAY_DATES    = #arrrgPayDates#
		     , REQEST_SEQ   = #reqestSeq#
		     , DEPTCD       = #deptcd#
		     , NTIC_MTH     = #nticMth#
		     , UPD_USR      = #updUsr#
		     , UPDT_DT      = SYSDATE
		WHERE  NTIC_CNT     = #nticCnt#
		AND    PRT_AT_CODE  = #prtAtCode#
		AND    MNG_YEAR     = #mngYear#
		AND    MNG_NO       = #mngNo#
		AND    MNG_CNT      = #mngCnt#
	      AND CHRGE_KND      = #chrgeKnd#
    </update>

    <select id="gamHtldRentFeeMngtDao.selectHtldRentFeeMngtInfo_S" parameterClass="gamHtldRentFeeMngtVO" resultMap="gamHtldRentFeeMngtInfoMap">
        SELECT
                 L.NTIC_CNT
               , L.FCLTY_SE
               , L.CHRGE_KND
               , L.ENTRPSCD
               , L.ENTRPS_NM
               , L.NTIC_PD_FROM
               , L.NTIC_PD_TO
               , L.ACCNUT_YEAR
               , L.NTICNO
               , TO_CHAR(L.NTIC_DT, 'YYYY-MM-DD') NTIC_DT
               , L.PAY_TMLMT
               , L.OLNLP
               , L.FEE
               , L.VAT_YN
               , L.VAT
               , L.NTIC_AMT
               , L.RM
               , L.RCIV_SE
               , TO_CHAR(TO_DATE(L.RCIV_DT), 'YYYY-MM-DD') RCIV_DT
               , L.NHT_ISUE_YN
               , L.ARRRG_NO
               , L.ARRRG_AMT
               , L.ARRRG_TARIFF
               , L.ARRRG_PAY_DATES
               , L.REQEST_SEQ
               , L.DEPTCD
               , L.NTIC_MTH
               , L.REG_USR
               , TO_CHAR(L.REGIST_DT, 'YYYY-MM-DD') REGIST_DT
               , L.UPD_USR
               , TO_CHAR(L.UPDT_DT, 'YYYY-MM-DD') UPDT_DT
               , L.PRT_AT_CODE
               , L.MNG_YEAR
               , L.MNG_NO
               , L.MNG_CNT
               , L.MNG_YEAR || '-' || L.MNG_NO || '-' || L.MNG_CNT AS RENT_MNG_NO
			FROM ASSETS_RENT_F A, LEV_REQEST_F L
             WHERE A.QUAY_GROUP_CD='H'
             	AND A.PRT_AT_CODE=L.PRT_AT_CODE
             	AND A.MNG_YEAR=L.MNG_YEAR
             	AND A.MNG_NO=L.MNG_NO
             	AND A.MNG_CNT=L.MNG_CNT
             	AND L.NTIC_CNT    = #nticCnt#
           AND L.PRT_AT_CODE = #prtAtCode#
           AND L.MNG_YEAR    = #mngYear#
           AND L.MNG_NO      = #mngNo#
           AND L.MNG_CNT     = #mngCnt#
           AND L.CHRGE_KND     = #chrgeKnd#
    </select>

    <select id="gamHtldRentFeeMngtDao.selectAnlrveLevCnt_S" parameterClass="gamHtldRentFeeMngtVO" resultClass="int">
        SELECT COUNT(*) totcnt
          FROM ANLRVE_LEV_F A
         WHERE 1=1
           AND NTICNO      = #nticno#
		   AND ACCNUT_YEAR = #accnutYear#
		   AND NTIC_CNT    = #nticCnt#
		   AND PRT_AT_CODE = #prtAtCode#
		   AND MNG_YEAR    = #mngYear#
		   AND MNG_NO      = #mngNo#
		   AND MNG_CNT     = #mngCnt#
           AND CHRGE_KND     = #chrgeKnd#
    </select>

    <insert id="gamHtldRentFeeMngtDao.insertAnlrveLev_S">
        INSERT INTO ANLRVE_LEV_F (
		                            CHRGE_KND
		                          , ACCNUT_YEAR
		                          , NTICNO
		                          , ACCNUT_SE_CD
		                          , ENTRPSCD
		                          , NTIC_AMT
		                          , NTIC_DT
		                          , NHT_ISUE_YN
		                          , COMPUT_DTLS
		                          , PAY_TMLMT
		                          , FRST_NTIC_DT
		                          , RCIV_TRANSFR_STTUS_CD
		                          , RCIV_DT
		                          , RCIV_SE
		                          , INCPCTY_CD
		                          , OVERRPAY_AMT
		                          , TMPR_ISU_NO
		                          , DSCNT_AMT
		                          , DSCNT_RSN
		                          , DSCNT_CD
		                          , RCIV_SE_NM
		                          , FNNC_INSTT_RCIV_DT
		                          , POST_NTIC_ENNC
		                          , NPYMN_RSN_CD
		                          , ELCTRN_NTIC_RESULT
		                          , ELCTRN_NTIC_INFO_INQIRE_DT
		                          , EXCCLC_YN
		                          , VAT
		                          , VAT_YN
		                          , PRCEPTUR_SE
		                          , GIRO_RCIV_PLACE
		                          , GIRO_RCIV_SE
		                          , CMSN
		                          , CLOS_YN
		                          , DEPTCD
		                          , CHARGER
		                          , OPERT_SE
		                          , ORGINL_NTIC_CHRGE_KND
		                          , ORGINL_NTIC_ACCNUT_YEAR
		                          , ORGINL_NTIC_NO
		                          , ELCTRN_TAXBIL_ISU_YN
		                          , BEGIN_DT
		                          , END_DT
		                          , NTIC_MTH
		                          , REG_USR
		                          , REGIST_DT
		                          , UPD_USR
		                          , UPDT_DT
		                          , NTIC_CNT
		                          , PRT_AT_CODE
		                          , MNG_YEAR
		                          , MNG_NO
		                          , MNG_CNT
		                        )
		                 VALUES (
		                            #chrgeKnd#
		                          , #accnutYear#
		                          , #nticno#
		                          , #accnutSeCd#
		                          , #entrpscd#
		                          , #nticAmt#
		                          , TO_DATE(#nticDt#,'YYYY-MM-DD')
		                          , #nhtIsueYn#
		                          , #computDtls#
		                          , TO_DATE(#payTmlmt#,'YYYY-MM-DD')
		                          , TO_DATE(#frstNticDt#,'YYYY-MM-DD')
		                          , #rcivTransfrSttusCd#
		                          , TO_DATE(#rcivDt#,'YYYY-MM-DD')
		                          , #rcivSe#
		                          , #incpctyCd#
		                          , #overrpayAmt#
		                          , #tmprIsuNo#
		                          , #dscntAmt#
		                          , #dscntRsn#
		                          , #dscntCd#
		                          , #rcivSeNm#
		                          , TO_DATE(#fnncInsttRcivDt#,'YYYY-MM-DD')
		                          , #postNticEnnc#
		                          , #npymnRsnCd#
		                          , #elctrnNticResult#
		                          , TO_DATE(#elctrnNticInfoInqireDt#,'YYYY-MM-DD')
		                          , #excclcYn#
		                          , #vat#
		                          , #vatYn#
		                          , #prcepturSe#
		                          , #giroRcivPlace#
		                          , #giroRcivSe#
		                          , #cmsn#
		                          , #closYn#
		                          , #deptcd#
		                          , #charger#
		                          , #opertSe#
		                          , #orginlNticChrgeKnd#
		                          , #orginlNticAccnutYear#
		                          , #orginlNticNo#
		                          , #elctrnTaxbilIsuYn#
		                          , TO_DATE(#beginDt#,'YYYY-MM-DD')
		                          , TO_DATE(#endDt#,'YYYY-MM-DD')
		                          , #nticMth#
		                          , #regUsr#
		                          , SYSDATE
		                          , #updUsr#
		                          , SYSDATE
		                          , #nticCnt#
		                          , #prtAtCode#
		                          , #mngYear#
		                          , #mngNo#
		                          , #mngCnt#
		                        )
    </insert>

    <delete id="gamHtldRentFeeMngtDao.deleteHtldRentFeeMngt_S">
         DELETE FROM LEV_REQEST_F
          WHERE NTIC_CNT    = #nticCnt#
            AND PRT_AT_CODE = #prtAtCode#
            AND MNG_YEAR    = #mngYear#
            AND MNG_NO      = #mngNo#
            AND MNG_CNT     = #mngCnt#
            AND L.CHRGE_KND     = #chrgeKnd#
    </delete>

	<insert id="gamHtldRentFeeMngtDao.insertHtldRentFeeMngtLevReqest_S">
        INSERT INTO LEV_REQEST_F (
                             NTIC_CNT
                           , FCLTY_SE
                           , CHRGE_KND
                           , ENTRPSCD
                           , ENTRPS_NM
                           , NTIC_PD_FROM
                           , NTIC_PD_TO
                           , ACCNUT_YEAR
                           , NTICNO
                           , NTIC_DT
                           , PAY_TMLMT
                           , OLNLP
                           , FEE
                           , VAT_YN
                           , VAT
                           , NTIC_AMT
                           , RM
                           , RCIV_SE
                           , RCIV_DT
                           , NHT_ISUE_YN
                           , ARRRG_NO
                           , ARRRG_AMT
                           , REQEST_SEQ
                           , DEPTCD
                           , NTIC_MTH
                           , REG_USR
                           , REGIST_DT
                           , UPD_USR
                           , UPDT_DT
                           , PRT_AT_CODE
                           , MNG_YEAR
                           , MNG_NO
                           , MNG_CNT
                         )
                  VALUES (
                             #nticCnt#
                           , #fcltySe#
                           , #chrgeKnd#
                           , #entrpscd#
                           , #entrpsNm#
                           , TO_DATE(#nticPdFrom#, 'YYYY-MM-DD')
                           , TO_DATE(#nticPdTo#, 'YYYY-MM-DD')
                           , #accnutYear#
                           , #nticno#
                           , #nticDt#
                           , TO_DATE(#payTmlmt#, 'YYYY-MM-DD')
                           , #olnlp#
                           , #fee#
                           , #vatYn#
                           , #vat#
                           , #nticAmt#
                           , #rm#
                           , #rcivSe#
                           , TO_DATE(#rcivDt#, 'YYYY-MM-DD')
                           , #nhtIsueYn#
                           , #arrrgNo#
                           , #arrrgAmt#
                           , #reqestSeq#
                           , #deptcd#
                           , #nticMth#
                           , #regUsr#
                           , SYSDATE
                           , #updUsr#
                           , SYSDATE
                           , #prtAtCode#
                           , #mngYear#
                           , #mngNo#
                           , #mngCnt#
                         )
    </insert>

    <select id="gamHtldRentFeeMngtDao.selectNticPrintMaster_D" parameterClass="hashMap" resultClass="egovMap">
		SELECT Z.*
		FROM
		  (SELECT ROWNUM RNUM,
		    P2MGR.sf_makedigit@YGPA_P2MGR(A.PRT_AT_CODE
		    || ASCII(SUBSTR(A.FEE_TP,1,1))
		    || SUBSTR(A.FEE_TP,2,1)
		    || A.FISCAL_YR
		    || A.BILL_NO
		    || NVL(A.ARRRG_NO, '0'),'BILLNO') CSTMR_REF_CODE,
		    (SELECT DECODE(A.PRT_AT_CODE, '620', '1', '621', '2', '3')
		      || FEE_TP_MAP
		      || SUBSTR(A.FISCAL_YR, 3,2)
		      || A.BILL_NO
		      || NVL(A.ARRRG_NO, '00')
		    FROM P2MGR.FEE_TP_F@YGPA_P2MGR
		    WHERE PRT_AT_CODE = A.PRT_AT_CODE
		    AND FEE_TP        = A.FEE_TP
		    ) ELEC_PAY_NO,
		    DECODE(A.PRT_AT_CODE, '622', '6374594', '6374604') GIRO_NO,
		    P2MGR.sf_makedigit@YGPA_P2MGR(A.BILL_AMNT, 'AMT') ELEC_NTIC_AMT,
		    A.*
		  FROM
		    (
		    SELECT R.PRT_AT_CODE,
		      R.FISCAL_YR,
		      R.FEE_TP,
		      R.BILL_NO,
		      R.BILL_AMNT,
		      NVL(L.FEE, 0) FEE,
	          L.INTR_AMNT,
	          L.ADD_AMNT,
	          L.ADD_AMNT_RM,
	          TRUNC(NVL(L.FEE, 0) + NVL(L.INTR_AMNT, 0) + NVL(L.ADD_AMNT, 0), -1) AS SUPPLY_AMNT,
	          (NVL(L.FEE, 0)) AS PURE_FEE, 
		      L.NTIC_CNT,
              L.INTR_RATE*100 INTR_RATE,
              L.NTIC_AMT,
              L.ASSESS_SE,
              L.RM,
		      R.AGENT_NAME,
		      R.AGENT_CODE,
		      TO_CHAR(L.NTIC_PD_FROM, 'YYYY-MM-DD') NTIC_PD_FROM,
		      TO_CHAR(L.NTIC_PD_TO, 'YYYY-MM-DD') NTIC_PD_TO,
		      TO_CHAR(L.NTIC_DT, 'YYYY-MM-DD') NTIC_DT,
		      L.ARRRG_NO,
		      (SELECT RPRSNTV_NM FROM ENTRPS_INFO_F WHERE ENTRPSCD=L.ENTRPSCD) RPRSNTV_NM,
		      (SELECT ADRES FROM ENTRPS_INFO_F WHERE ENTRPSCD=L.ENTRPSCD) ADRES,
		      (SELECT ADRES2 FROM ENTRPS_INFO_F WHERE ENTRPSCD=L.ENTRPSCD) ADRES2,
		      (SELECT ZIP FROM ENTRPS_INFO_F WHERE ENTRPSCD=L.ENTRPSCD) ZIP,
		      GAM_GET_FEE_TP_NM(L.PRT_AT_CODE, 'H', DECODE(R.FEE_TP, 'V2', 'A3',R.WORK_CODE)) CHRGE_KND_NM,
		      R.BZ_RGST_ID,
		      R.VAT,
		      R.VAT_YN,
		      GAM_GETCODENAME('GAM016', R.VAT_YN) TAXT_SE_NM,
		      TO_CHAR(R.BILL_DT, 'YYYY-MM-DD') BILL_DT,
		      TO_CHAR(R.DUE_DATE, 'YYYY-MM-DD') DUE_DATE

		   FROM LEV_REQEST_F L, REV_COLL_F R
		    WHERE 1=1
		      AND L.PRT_AT_CODE=R.PRT_AT_CODE
		      AND L.ACCNUT_YEAR=R.FISCAL_YR
		      AND ((L.NTICNO=R.BILL_NO AND GAM_GET_HTLD_FEE_TP(L.CHRGE_KND)=R.FEE_TP) OR (L.INTR_FEE_NTICNO=R.BILL_NO AND GAM_GET_HTLD_FEE_TP(L.INTR_CHRGE_KND)=R.FEE_TP))
					      AND L.PRT_AT_CODE   = #prtAtCode#
					      AND L.MNG_YEAR      = #mngYear#
					      AND L.MNG_NO        = #mngNo#
					      AND L.MNG_CNT       = #mngCnt#
					      AND L.NTIC_CNT      = #nticCnt#
		      ) A
		  ) Z
    </select>

    <select id="gamHtldRentFeeMngtDao.selectNticPrintDetail_D" parameterClass="hashMap" resultClass="egovMap">
    	SELECT
    		A.RM,
    		D.USAGE_AR,
			  D.APPLC_PRICE,
			  NVL(D.PRICE_SE, '1') PRICE_SE, 
    		TRUNC(D.USAGE_AR*D.APPLC_PRICE, -1) D_PRICE,
    		D.COMPUT_DTLS ,
	        (SELECT GIS_ASSETS_NM
	        FROM GIS_ASSETS_CD_F
	        WHERE ROWNUM              =1
	        AND GIS_ASSETS_PRT_AT_CODE=D.GIS_ASSETS_PRT_AT_CODE
	        AND GIS_ASSETS_CD         =D.GIS_ASSETS_CD
	        AND GIS_ASSETS_SUB_CD     =D.GIS_ASSETS_SUB_CD
	        ) GIS_ASSETS_NM ,
	        (SELECT GIS_ASSETS_LOCPLC
	        FROM GIS_ASSETS_CD_F
	        WHERE ROWNUM              =1
	        AND GIS_ASSETS_PRT_AT_CODE=D.GIS_ASSETS_PRT_AT_CODE
	        AND GIS_ASSETS_CD         =D.GIS_ASSETS_CD
	        AND GIS_ASSETS_SUB_CD     =D.GIS_ASSETS_SUB_CD
	        ) GIS_ASSETS_LOCPLC ,
	        (SELECT GIS_ASSETS_LNM
	        FROM GIS_ASSETS_CD_F
	        WHERE ROWNUM              =1
	        AND GIS_ASSETS_PRT_AT_CODE=D.GIS_ASSETS_PRT_AT_CODE
	        AND GIS_ASSETS_CD         =D.GIS_ASSETS_CD
	        AND GIS_ASSETS_SUB_CD     =D.GIS_ASSETS_SUB_CD
	        ) GIS_ASSETS_LNM ,
	        (SELECT GIS_ASSETS_LNM_SUB
	        FROM GIS_ASSETS_CD_F
	        WHERE ROWNUM              =1
	        AND GIS_ASSETS_PRT_AT_CODE=D.GIS_ASSETS_PRT_AT_CODE
	        AND GIS_ASSETS_CD         =D.GIS_ASSETS_CD
	        AND GIS_ASSETS_SUB_CD     =D.GIS_ASSETS_SUB_CD
	        ) GIS_ASSETS_LNM_SUB
      FROM
        ASSETS_RENT_F A,
        ASSETS_RENT_DETAIL_F D
      WHERE 1             = 1
      AND A.PRT_AT_CODE   = D.PRT_AT_CODE
      AND A.MNG_YEAR      = D.MNG_YEAR
      AND A.MNG_NO        = D.MNG_NO
      AND A.MNG_CNT       = D.MNG_CNT
      AND A.QUAY_GROUP_CD = 'H'
      AND A.PRT_AT_CODE   = #prtAtCode#
      AND A.MNG_YEAR      = #mngYear#
      AND A.MNG_NO        = #mngNo#
      AND A.MNG_CNT       = #mngCnt#
    ORDER BY D.ASSETS_USAGE_SEQ ASC
    </select>
    
    <select id="gamHtldRentFeeMngtDao.selectNticPrintFeeList_D" parameterClass="hashMap" resultClass="egovMap">
    	SELECT Z.*
			FROM
			  (SELECT ROWNUM RNUM,
			    P2MGR.sf_makedigit@YGPA_P2MGR(A.PRT_AT_CODE
			    || ASCII(SUBSTR(A.FEE_TP,1,1))
			    || SUBSTR(A.FEE_TP,2,1)
			    || A.ACCNUT_YEAR
			    || A.NTICNO
			    || NVL(A.ARRRG_NO, '0'),'BILLNO') CSTMR_REF_CODE,
			    (SELECT DECODE(A.PRT_AT_CODE, '620', '1', '621', '2', '3')
			      || FEE_TP_MAP
			      || SUBSTR(A.ACCNUT_YEAR, 3,2)
			      || A.NTICNO
			      || NVL(A.ARRRG_NO, '00')
			    FROM P2MGR.FEE_TP_F@YGPA_P2MGR
			    WHERE PRT_AT_CODE = A.PRT_AT_CODE
			    AND FEE_TP        = GAM_GET_HTLD_FEE_TP(A.CHRGE_KND)
			    ) ELEC_PAY_NO,
			    DECODE(A.PRT_AT_CODE, '622', '6374594', '6374604') GIRO_NO,
			    P2MGR.sf_makedigit@YGPA_P2MGR(A.NTIC_AMT, 'AMT') ELEC_NTIC_AMT,
			    A.*
			  FROM
			    (SELECT S.PRT_AT_CODE,
			      S.MNG_YEAR,
			      S.MNG_NO,
			      S.MNG_CNT,
			      S.MNG_YEAR
			      || '-'
			      || S.MNG_NO
			      || '-'
			      || S.MNG_CNT AS RENT_MNG_NO,
			      S.NTIC_CNT,
			      S.ACCNUT_YEAR,
			      S.NTICNO,
			      GAM_GET_HTLD_FEE_TP(S.CHRGE_KND ) FEE_TP,
			      GAM_GET_FEE_TP_NM(S.PRT_AT_CODE, 'H', S.CHRGE_KND) CHRGE_KND_NM,
			      S.ENTRPSCD,
			      S.ENTRPS_NM,
			      (SELECT RPRSNTV_NM FROM ENTRPS_INFO_F WHERE ENTRPSCD=S.ENTRPSCD
			      ) RPRSNTV_NM,
			      (SELECT ADRES FROM ENTRPS_INFO_F WHERE ENTRPSCD=S.ENTRPSCD) ADRES,
			      (SELECT ADRES2 FROM ENTRPS_INFO_F WHERE ENTRPSCD=S.ENTRPSCD) ADRES2,
			      (SELECT ZIP FROM ENTRPS_INFO_F WHERE ENTRPSCD=S.ENTRPSCD) ZIP,
			      S.NTIC_DT,
			      S.PAY_TMLMT,
			      (SELECT BIZRNO FROM ENTRPS_INFO_F WHERE ENTRPSCD=S.ENTRPSCD) BIZRNO,
			      S.GIS_ASSETS_NM,
			      S.GIS_ASSETS_LOCPLC,
			      S.GIS_ASSETS_LNM,
			      S.GIS_ASSETS_LNM_SUB,
			      '1' GIS_ASSETS_CNT,
			      S.COMPUT_DTLS,
			      S.NTIC_PD_FROM,
			      S.NTIC_PD_TO,
			      S.CHRGE_KND,
			      S.FEE,
			      S.VAT,
			      S.NTIC_AMT,
			      S.VAT_YN,
			      S.TAXT_SE_NM,
			      S.SANCTN_STTUS_NM,
			      S.SANCTN_STTUS,
			      S.NHT_ISUE_YN,
			      S.ARRRG_NO,
			      S.ARRRG_AMT,
					S.ARRRG_TARIFF ,
			        S.ARRRG_PAY_DATES ,
			      S.DEPTCD_NM,
			      S.GR_AR,
			      S.GR_USAGE_PD_FROM,
			      S.GR_USAGE_PD_TO,
			      S.PRMISN_DT,
			      S.REIM_FEE,
			      S.REIM_CHRGE_KND,
			      S.REIM_FEE_NTICNO
			    FROM
			      (SELECT L.NTIC_CNT ,
			        L.FCLTY_SE ,
			        L.CHRGE_KND ,
			        L.ENTRPSCD ,
			        L.ENTRPS_NM ,
			        L.REIM_FEE,
			        L.REIM_CHRGE_KND,
			        L.REIM_FEE_NTICNO,
			        TO_CHAR(L.NTIC_PD_FROM, 'YYYY-MM-DD') NTIC_PD_FROM ,
			        TO_CHAR(L.NTIC_PD_TO, 'YYYY-MM-DD') NTIC_PD_TO ,
			        L.ACCNUT_YEAR ,
			        L.NTICNO ,
			        TO_CHAR(L.NTIC_DT, 'YYYY-MM-DD') NTIC_DT ,
			        TO_CHAR(L.PAY_TMLMT, 'YYYY-MM-DD') PAY_TMLMT ,
			        L.SANCTN_STTUS ,
			        L.SANCTNER_EMPL_NO ,
			        TO_CHAR(L.SANCTN_DT) SANCTN_DT ,
			        GAM_GETCODENAME('GAM046', L.SANCTN_STTUS) SANCTN_STTUS_NM ,
			        NVL(L.OLNLP,0) OLNLP ,
			        NVL(L.FEE,0) FEE ,
			        GAM_GETCODENAME('GAM016', A.TAXT_SE) TAXT_SE_NM ,
			        L.VAT_YN ,
			        NVL(L.VAT,0) VAT ,
			        NVL(L.NTIC_AMT,0) NTIC_AMT ,
			        L.RM ,
			        L.RCIV_SE ,
			        TO_CHAR(L.RCIV_DT, 'YYYY-MM-DD') RCIV_DT ,
			        L.NHT_ISUE_YN ,
			        L.ARRRG_NO ,
			        NVL(L.ARRRG_AMT,0) ARRRG_AMT ,
			        L.ARRRG_TARIFF ,
			        L.ARRRG_PAY_DATES ,
			        L.REQEST_SEQ ,
			        L.DEPTCD ,
			        L.NTIC_MTH ,
			        L.REG_USR ,
			        TO_CHAR(L.REGIST_DT, 'YYYY-MM-DD') REGIST_DT ,
			        L.UPD_USR ,
			        TO_CHAR(L.UPDT_DT, 'YYYY-MM-DD') UPDT_DT ,
			        L.PRT_AT_CODE ,
			        L.MNG_YEAR ,
			        L.MNG_NO ,
			        L.MNG_CNT ,
			        (SELECT CD.CODE_NM
			        FROM COMTCCMMNDETAILCODE CD
			        WHERE CD.CODE_ID = 'GAM019'
			        AND CD.CODE      = L.PRT_AT_CODE
			        AND ROWNUM       = 1
			        ) PRT_AT_CODE_NM ,
			        GAM_GETDEPTNAME(L.DEPTCD) DEPTCD_NM ,
			        NVL(A.GR_AR,0) GR_AR ,
			        TO_CHAR(A.GR_USAGE_PD_FROM, 'YYYY-MM-DD') GR_USAGE_PD_FROM ,
			        TO_CHAR(A.GR_USAGE_PD_TO, 'YYYY-MM-DD') GR_USAGE_PD_TO ,
			        TO_CHAR(A.PRMISN_DT, 'YYYY-MM-DD') PRMISN_DT ,
			        NVL(A.GR_RDCXPT_FEE,0) GR_RDCXPT_FEE ,
			        A.COMPUT_DTLS ,
			        (SELECT GIS_ASSETS_NM
			        FROM GIS_ASSETS_CD_F
			        WHERE ROWNUM              =1
			        AND GIS_ASSETS_PRT_AT_CODE=A.GIS_ASSETS_PRT_AT_CODE
			        AND GIS_ASSETS_CD         =A.GIS_ASSETS_CD
			        AND GIS_ASSETS_SUB_CD     =A.GIS_ASSETS_SUB_CD
			        ) GIS_ASSETS_NM ,
			        (SELECT GIS_ASSETS_LOCPLC
			        FROM GIS_ASSETS_CD_F
			        WHERE ROWNUM              =1
			        AND GIS_ASSETS_PRT_AT_CODE=A.GIS_ASSETS_PRT_AT_CODE
			        AND GIS_ASSETS_CD         =A.GIS_ASSETS_CD
			        AND GIS_ASSETS_SUB_CD     =A.GIS_ASSETS_SUB_CD
			        ) GIS_ASSETS_LOCPLC ,
			        (SELECT GIS_ASSETS_LNM
			        FROM GIS_ASSETS_CD_F
			        WHERE ROWNUM              =1
			        AND GIS_ASSETS_PRT_AT_CODE=A.GIS_ASSETS_PRT_AT_CODE
			        AND GIS_ASSETS_CD         =A.GIS_ASSETS_CD
			        AND GIS_ASSETS_SUB_CD     =A.GIS_ASSETS_SUB_CD
			        ) GIS_ASSETS_LNM ,
			        (SELECT GIS_ASSETS_LNM_SUB
			        FROM GIS_ASSETS_CD_F
			        WHERE ROWNUM              =1
			        AND GIS_ASSETS_PRT_AT_CODE=A.GIS_ASSETS_PRT_AT_CODE
			        AND GIS_ASSETS_CD         =A.GIS_ASSETS_CD
			        AND GIS_ASSETS_SUB_CD     =A.GIS_ASSETS_SUB_CD
			        ) GIS_ASSETS_LNM_SUB
			      FROM
			        (SELECT AR.*,
			          ARD.GIS_ASSETS_PRT_AT_CODE,
			          ARD.GIS_ASSETS_CD,
			          ARD.GIS_ASSETS_SUB_CD,
			          ARD.COMPUT_DTLS
			        FROM ASSETS_RENT_F AR
			        LEFT JOIN ASSETS_RENT_DETAIL_F ARD
			        ON AR.PRT_AT_CODE = ARD.PRT_AT_CODE
			        AND AR.MNG_YEAR   = ARD.MNG_YEAR
			        AND AR.MNG_NO     = ARD.MNG_NO
			        AND AR.MNG_CNT    = ARD.MNG_CNT
			        ) A,
			        LEV_REQEST_F L
			      WHERE 1             = 1
			      AND A.PRT_AT_CODE   = L.PRT_AT_CODE
			      AND A.MNG_YEAR      = L.MNG_YEAR
			      AND A.MNG_NO        = L.MNG_NO
			      AND A.MNG_CNT       = L.MNG_CNT
			      AND A.QUAY_GROUP_CD = 'H'
			      AND L.PRT_AT_CODE   = #prtAtCode#
			      AND L.MNG_YEAR      = #mngYear#
			      AND L.MNG_NO        = #mngNo#
			      AND L.MNG_CNT       = #mngCnt#
			      AND L.NTIC_CNT      = #nticCnt#
			      AND L.CHRGE_KND      = #chrgeKnd#
			      ) S
			    ORDER BY S.ENTRPS_NM ASC,
			      S.NTIC_CNT ASC
			    ) A
			  ) Z
    </select>

    <select id="gamHtldRentFeeMngtDao.selectNticPrintFeeList2_D" parameterClass="hashMap" resultClass="egovMap">
    	SELECT Z.*
			FROM
			  (SELECT ROWNUM RNUM,
			    P2MGR.sf_makedigit@YGPA_P2MGR(A.PRT_AT_CODE
			    || ASCII(SUBSTR(A.FEE_TP,1,1))
			    || SUBSTR(A.FEE_TP,2,1)
			    || A.ACCNUT_YEAR
			    || A.NTICNO
			    || '0','BILLNO') CSTMR_REF_CODE,
			    (SELECT DECODE(A.PRT_AT_CODE, '620', '1', '621', '2', '3')
			      || FEE_TP_MAP
			      || SUBSTR(A.ACCNUT_YEAR, 3,2)
			      || A.NTICNO
			      || '00'
			    FROM P2MGR.FEE_TP_F@YGPA_P2MGR
			    WHERE PRT_AT_CODE = A.PRT_AT_CODE
			    AND FEE_TP        = GAM_GET_HTLD_FEE_TP(A.CHRGE_KND)
			    ) ELEC_PAY_NO,
			    DECODE(A.PRT_AT_CODE, '622', '6374594', '6374604') GIRO_NO,
			    P2MGR.sf_makedigit@YGPA_P2MGR(A.NTIC_AMT, 'AMT') ELEC_NTIC_AMT,
			    A.*
			  FROM
			    (SELECT S.PRT_AT_CODE,
			      S.MNG_YEAR,
			      S.MNG_NO,
			      S.MNG_CNT,
			      S.MNG_YEAR
			      || '-'
			      || S.MNG_NO
			      || '-'
			      || S.MNG_CNT AS RENT_MNG_NO,
			      S.NTIC_CNT,
			      S.ACCNUT_YEAR,
			      S.NTICNO,
			      GAM_GET_HTLD_FEE_TP(S.CHRGE_KND ) FEE_TP,
			      GAM_GET_FEE_TP_NM(S.PRT_AT_CODE, 'H', S.CHRGE_KND) CHRGE_KND_NM,
			      S.ENTRPSCD,
			      S.ENTRPS_NM,
			      (SELECT RPRSNTV_NM FROM ENTRPS_INFO_F WHERE ENTRPSCD=S.ENTRPSCD
			      ) RPRSNTV_NM,
			      (SELECT ADRES FROM ENTRPS_INFO_F WHERE ENTRPSCD=S.ENTRPSCD) ADRES,
			      (SELECT ADRES2 FROM ENTRPS_INFO_F WHERE ENTRPSCD=S.ENTRPSCD) ADRES2,
			      (SELECT ZIP FROM ENTRPS_INFO_F WHERE ENTRPSCD=S.ENTRPSCD) ZIP,
			      S.NTIC_DT,
			      S.PAY_TMLMT,
			      (SELECT BIZRNO FROM ENTRPS_INFO_F WHERE ENTRPSCD=S.ENTRPSCD) BIZRNO,
			      S.GIS_ASSETS_NM,
			      S.GIS_ASSETS_LOCPLC,
			      S.GIS_ASSETS_LNM,
			      S.GIS_ASSETS_LNM_SUB,
			      '1' GIS_ASSETS_CNT,
			      S.COMPUT_DTLS,
			      S.NTIC_PD_FROM,
			      S.NTIC_PD_TO,
			      S.CHRGE_KND,
			      S.FEE,
			      S.VAT,
			      S.NTIC_AMT,
			      S.VAT_YN,
			      S.TAXT_SE_NM,
			      S.SANCTN_STTUS_NM,
			      S.SANCTN_STTUS,
			      S.NHT_ISUE_YN,
			      S.ARRRG_NO,
			      S.ARRRG_AMT,
					S.ARRRG_TARIFF ,
			        S.ARRRG_PAY_DATES ,
			      S.DEPTCD_NM,
			      S.GR_AR,
			      S.GR_USAGE_PD_FROM,
			      S.GR_USAGE_PD_TO,
			      S.PRMISN_DT,
			      S.REIM_FEE,
			      S.REIM_CHRGE_KND,
			      S.REIM_FEE_NTICNO
			    FROM
			      (SELECT L.NTIC_CNT ,
			        L.FCLTY_SE ,
			        L.CHRGE_KND ,
			        L.ENTRPSCD ,
			        L.ENTRPS_NM ,
			        L.REIM_FEE,
			        L.REIM_CHRGE_KND,
			        L.REIM_FEE_NTICNO,
			        TO_CHAR(L.NTIC_PD_FROM, 'YYYY-MM-DD') NTIC_PD_FROM ,
			        TO_CHAR(L.NTIC_PD_TO, 'YYYY-MM-DD') NTIC_PD_TO ,
			        L.ACCNUT_YEAR ,
			        L.NTICNO ,
			        TO_CHAR(L.NTIC_DT, 'YYYY-MM-DD') NTIC_DT ,
			        TO_CHAR(L.PAY_TMLMT, 'YYYY-MM-DD') PAY_TMLMT ,
			        L.SANCTN_STTUS ,
			        L.SANCTNER_EMPL_NO ,
			        TO_CHAR(L.SANCTN_DT) SANCTN_DT ,
			        GAM_GETCODENAME('GAM046', L.SANCTN_STTUS) SANCTN_STTUS_NM ,
			        NVL(L.OLNLP,0) OLNLP ,
			        NVL(L.FEE,0) FEE ,
			        GAM_GETCODENAME('GAM016', A.TAXT_SE) TAXT_SE_NM ,
			        L.VAT_YN ,
			        NVL(L.VAT,0) VAT ,
			        NVL(L.ARRRG_AMT,0) NTIC_AMT ,
			        L.RM ,
			        L.RCIV_SE ,
			        TO_CHAR(L.RCIV_DT, 'YYYY-MM-DD') RCIV_DT ,
			        L.NHT_ISUE_YN ,
			        L.ARRRG_NO ,
			        NVL(L.ARRRG_AMT,0) ARRRG_AMT ,
			        L.ARRRG_TARIFF ,
			        L.ARRRG_PAY_DATES ,
			        L.REQEST_SEQ ,
			        L.DEPTCD ,
			        L.NTIC_MTH ,
			        L.REG_USR ,
			        TO_CHAR(L.REGIST_DT, 'YYYY-MM-DD') REGIST_DT ,
			        L.UPD_USR ,
			        TO_CHAR(L.UPDT_DT, 'YYYY-MM-DD') UPDT_DT ,
			        L.PRT_AT_CODE ,
			        L.MNG_YEAR ,
			        L.MNG_NO ,
			        L.MNG_CNT ,
			        (SELECT CD.CODE_NM
			        FROM COMTCCMMNDETAILCODE CD
			        WHERE CD.CODE_ID = 'GAM019'
			        AND CD.CODE      = L.PRT_AT_CODE
			        AND ROWNUM       = 1
			        ) PRT_AT_CODE_NM ,
			        GAM_GETDEPTNAME(L.DEPTCD) DEPTCD_NM ,
			        NVL(A.GR_AR,0) GR_AR ,
			        TO_CHAR(A.GR_USAGE_PD_FROM, 'YYYY-MM-DD') GR_USAGE_PD_FROM ,
			        TO_CHAR(A.GR_USAGE_PD_TO, 'YYYY-MM-DD') GR_USAGE_PD_TO ,
			        TO_CHAR(A.PRMISN_DT, 'YYYY-MM-DD') PRMISN_DT ,
			        NVL(A.GR_RDCXPT_FEE,0) GR_RDCXPT_FEE ,
			        A.COMPUT_DTLS ,
			        (SELECT GIS_ASSETS_NM
			        FROM GIS_ASSETS_CD_F
			        WHERE ROWNUM              =1
			        AND GIS_ASSETS_PRT_AT_CODE=A.GIS_ASSETS_PRT_AT_CODE
			        AND GIS_ASSETS_CD         =A.GIS_ASSETS_CD
			        AND GIS_ASSETS_SUB_CD     =A.GIS_ASSETS_SUB_CD
			        ) GIS_ASSETS_NM ,
			        (SELECT GIS_ASSETS_LOCPLC
			        FROM GIS_ASSETS_CD_F
			        WHERE ROWNUM              =1
			        AND GIS_ASSETS_PRT_AT_CODE=A.GIS_ASSETS_PRT_AT_CODE
			        AND GIS_ASSETS_CD         =A.GIS_ASSETS_CD
			        AND GIS_ASSETS_SUB_CD     =A.GIS_ASSETS_SUB_CD
			        ) GIS_ASSETS_LOCPLC ,
			        (SELECT GIS_ASSETS_LNM
			        FROM GIS_ASSETS_CD_F
			        WHERE ROWNUM              =1
			        AND GIS_ASSETS_PRT_AT_CODE=A.GIS_ASSETS_PRT_AT_CODE
			        AND GIS_ASSETS_CD         =A.GIS_ASSETS_CD
			        AND GIS_ASSETS_SUB_CD     =A.GIS_ASSETS_SUB_CD
			        ) GIS_ASSETS_LNM ,
			        (SELECT GIS_ASSETS_LNM_SUB
			        FROM GIS_ASSETS_CD_F
			        WHERE ROWNUM              =1
			        AND GIS_ASSETS_PRT_AT_CODE=A.GIS_ASSETS_PRT_AT_CODE
			        AND GIS_ASSETS_CD         =A.GIS_ASSETS_CD
			        AND GIS_ASSETS_SUB_CD     =A.GIS_ASSETS_SUB_CD
			        ) GIS_ASSETS_LNM_SUB
			      FROM
			        (SELECT AR.*,
			          ARD.GIS_ASSETS_PRT_AT_CODE,
			          ARD.GIS_ASSETS_CD,
			          ARD.GIS_ASSETS_SUB_CD,
			          ARD.COMPUT_DTLS
			        FROM ASSETS_RENT_F AR
			        LEFT JOIN ASSETS_RENT_DETAIL_F ARD
			        ON AR.PRT_AT_CODE = ARD.PRT_AT_CODE
			        AND AR.MNG_YEAR   = ARD.MNG_YEAR
			        AND AR.MNG_NO     = ARD.MNG_NO
			        AND AR.MNG_CNT    = ARD.MNG_CNT
			        ) A,
			        LEV_REQEST_F L
			      WHERE 1             = 1
			      AND A.PRT_AT_CODE   = L.PRT_AT_CODE
			      AND A.MNG_YEAR      = L.MNG_YEAR
			      AND A.MNG_NO        = L.MNG_NO
			      AND A.MNG_CNT       = L.MNG_CNT
			      AND A.QUAY_GROUP_CD = 'H'
			      AND L.PRT_AT_CODE   = #prtAtCode#
			      AND L.MNG_YEAR      = #mngYear#
			      AND L.MNG_NO        = #mngNo#
			      AND L.MNG_CNT       = #mngCnt#
			      AND L.NTIC_CNT      = #nticCnt#
			      AND L.CHRGE_KND      = #chrgeKnd#
			      ) S
			    ORDER BY S.ENTRPS_NM ASC,
			      S.NTIC_CNT ASC
			    ) A
			  ) Z
    </select>

    <select id="gamHtldRentFeeMngtDao.selectTaxNticPrintFeeList_D" parameterClass="hashMap" resultClass="egovMap">
    	SELECT Z.*
			FROM
			  (SELECT ROWNUM RNUM,
			    A.*
			  FROM
			    (SELECT S.PRT_AT_CODE,
			      S.MNG_YEAR,
			      S.MNG_NO,
			      S.MNG_CNT,
			      S.MNG_YEAR
			      || '-'
			      || S.MNG_NO
			      || '-'
			      || S.MNG_CNT AS RENT_MNG_NO,
			      S.NTIC_CNT,
			      S.ACCNUT_YEAR,
			      S.NTICNO,
			      GAM_GET_FEE_TP_NM(S.PRT_AT_CODE, 'H', S.CHRGE_KND) CHRGE_KND_NM,
			      S.ENTRPSCD,
			      S.ENTRPS_NM,
			      (SELECT RPRSNTV_NM FROM ENTRPS_INFO_F WHERE ENTRPSCD=S.ENTRPSCD) RPRSNTV_NM,
			      (SELECT BIZCND FROM ENTRPS_INFO_F WHERE ENTRPSCD=S.ENTRPSCD) BIZCND,
			      (SELECT INDUTY FROM ENTRPS_INFO_F WHERE ENTRPSCD=S.ENTRPSCD) INDUTY,
			      (SELECT ADRES FROM ENTRPS_INFO_F WHERE ENTRPSCD=S.ENTRPSCD) ADRES,
			      (SELECT ZIP FROM ENTRPS_INFO_F WHERE ENTRPSCD=S.ENTRPSCD) ZIP,
			      MAX(S.NTIC_DT) NTIC_DT,
			      (SELECT BIZRNO FROM ENTRPS_INFO_F WHERE ENTRPSCD=S.ENTRPSCD) BIZRNO,
			      MAX(S.GIS_ASSETS_NM) GIS_ASSETS_NM,
			      MAX(S.GIS_ASSETS_LOCPLC) GIS_ASSETS_LOCPLC,
			      MAX(S.GIS_ASSETS_LNM) GIS_ASSETS_LNM,
			      MAX(S.GIS_ASSETS_LNM_SUB) GIS_ASSETS_LNM_SUB,
			      COUNT(S.GIS_ASSETS_NM) GIS_ASSETS_CNT,
			      MIN(S.NTIC_PD_FROM) NTIC_PD_FROM,
			      MAX(S.NTIC_PD_TO) NTIC_PD_TO,
			      MAX(DECODE(S.CHRGE_KND, 'A3', '', 'A4', '', 'D1', '', 'D2', '', S.CHRGE_KND)) CHRGE_KND,
			      SUM(S.FEE) FEE_AMOUNT,
			      SUM(S.VAT) VAT_AMOUNT,
			      MAX(S.VAT_YN) VAT_YN,
			      SUM(S.NTIC_AMT) TOTAL_NTIC_AMT,
			      MAX(S.DEPTCD) DEPTCD,
			      MAX(S.DEPTCD_NM) DEPTCD_NM,
			      MAX(S.GR_AR) GR_AR,
			      MAX(S.GR_USAGE_PD_FROM) GR_USAGE_PD_FROM,
			      MAX(S.GR_USAGE_PD_TO) GR_USAGE_PD_TO,
			      MAX(S.RM) RM,
			      MAX(S.RCIV_SE) RCIV_SE
			    FROM
			      (SELECT L.NTIC_CNT ,
			        L.ACCNUT_YEAR ,
			        L.NTICNO ,
			        L.CHRGE_KND ,
			        L.PRT_AT_CODE ,
			        L.MNG_YEAR ,
			        L.MNG_NO ,
			        L.MNG_CNT ,
			        L.ENTRPSCD ,
			        L.ENTRPS_NM ,
			        TO_CHAR(L.NTIC_PD_FROM, 'YYYY-MM-DD') NTIC_PD_FROM ,
			        TO_CHAR(L.NTIC_PD_TO, 'YYYY-MM-DD') NTIC_PD_TO ,
			        TO_CHAR(L.NTIC_DT, 'YYYY-MM-DD') NTIC_DT ,
			        NVL(L.OLNLP,0) OLNLP ,
			        NVL(L.FEE,0) FEE,
			        L.VAT_YN ,
			        NVL(L.VAT,0) VAT ,
			        NVL(L.NTIC_AMT,0) NTIC_AMT ,
			        L.RM ,
			        L.RCIV_SE ,
			        L.DEPTCD ,
			        (SELECT CD.CODE_NM
			        FROM COMTCCMMNDETAILCODE CD
			        WHERE CD.CODE_ID = 'GAM019'
			        AND CD.CODE      = L.PRT_AT_CODE
			        AND ROWNUM       = 1 ) PRT_AT_CODE_NM ,
			        GAM_GETDEPTNAME(L.DEPTCD) DEPTCD_NM ,
			        NVL(A.GR_AR,0) GR_AR ,
			        TO_CHAR(A.GR_USAGE_PD_FROM, 'YYYY-MM-DD') GR_USAGE_PD_FROM ,
			        TO_CHAR(A.GR_USAGE_PD_TO, 'YYYY-MM-DD') GR_USAGE_PD_TO ,
			        (SELECT GIS_ASSETS_NM
			        FROM GIS_ASSETS_CD_F
			        WHERE ROWNUM              =1
			        AND GIS_ASSETS_PRT_AT_CODE=A.GIS_ASSETS_PRT_AT_CODE
			        AND GIS_ASSETS_CD         =A.GIS_ASSETS_CD
			        AND GIS_ASSETS_SUB_CD     =A.GIS_ASSETS_SUB_CD
			        ) GIS_ASSETS_NM ,
			        (SELECT GIS_ASSETS_LOCPLC
			        FROM GIS_ASSETS_CD_F
			        WHERE ROWNUM              =1
			        AND GIS_ASSETS_PRT_AT_CODE=A.GIS_ASSETS_PRT_AT_CODE
			        AND GIS_ASSETS_CD         =A.GIS_ASSETS_CD
			        AND GIS_ASSETS_SUB_CD     =A.GIS_ASSETS_SUB_CD
			        ) GIS_ASSETS_LOCPLC ,
			        (SELECT GIS_ASSETS_LNM
			        FROM GIS_ASSETS_CD_F
			        WHERE ROWNUM              =1
			        AND GIS_ASSETS_PRT_AT_CODE=A.GIS_ASSETS_PRT_AT_CODE
			        AND GIS_ASSETS_CD         =A.GIS_ASSETS_CD
			        AND GIS_ASSETS_SUB_CD     =A.GIS_ASSETS_SUB_CD
			        ) GIS_ASSETS_LNM ,
			        (SELECT GIS_ASSETS_LNM_SUB
			        FROM GIS_ASSETS_CD_F
			        WHERE ROWNUM              =1
			        AND GIS_ASSETS_PRT_AT_CODE=A.GIS_ASSETS_PRT_AT_CODE
			        AND GIS_ASSETS_CD         =A.GIS_ASSETS_CD
			        AND GIS_ASSETS_SUB_CD     =A.GIS_ASSETS_SUB_CD
			        ) GIS_ASSETS_LNM_SUB
			      FROM
			        (SELECT AR.*,
			          ARD.GIS_ASSETS_PRT_AT_CODE,
			          ARD.GIS_ASSETS_CD,
			          ARD.GIS_ASSETS_SUB_CD,
			          ARD.COMPUT_DTLS
			        FROM ASSETS_RENT_F AR
			        LEFT JOIN ASSETS_RENT_DETAIL_F ARD
			        ON AR.PRT_AT_CODE = ARD.PRT_AT_CODE
			        AND AR.MNG_YEAR   = ARD.MNG_YEAR
			        AND AR.MNG_NO     = ARD.MNG_NO
			        AND AR.MNG_CNT    = ARD.MNG_CNT
			        ) A,
			        LEV_REQEST_F L
			      WHERE 1             = 1
			      AND A.PRT_AT_CODE   = L.PRT_AT_CODE
			      AND A.MNG_YEAR      = L.MNG_YEAR
			      AND A.MNG_NO        = L.MNG_NO
			      AND A.MNG_CNT       = L.MNG_CNT
			      AND A.QUAY_GROUP_CD = 'H'
			      AND L.PRT_AT_CODE   = #prtAtCode#
			      AND L.MNG_YEAR      = #mngYear#
			      AND L.MNG_NO        = #mngNo#
			      AND L.MNG_CNT       = #mngCnt#
			      AND L.NTIC_CNT      = #nticCnt#
			      ) S
			    GROUP BY S.PRT_AT_CODE,
			      S.MNG_YEAR,
			      S.MNG_NO,
			      S.MNG_CNT,
			      S.NTIC_CNT,
			      S.ENTRPSCD,
			      S.ENTRPS_NM,
			      S.ACCNUT_YEAR,
			      S.NTICNO
			    ORDER BY S.ENTRPS_NM ASC,
			      S.NTIC_CNT ASC
			    ) A
			  ) Z
    </select>

     <select id="gamHtldRentFeeMngtDao.selectAssetRentFeeDetailList_D" parameterClass="gamHtldRentFeeMngtVO" resultClass="egovMap">
	                       SELECT
				'고지' BILL_TP,
        R.FISCAL_YR,
        R.WORK_CODE,
        R.BILL_NO,
        R.BILL_AMNT,
        TO_CHAR(R.BILL_DT, 'YYYY-MM-DD') BILL_DT,
        TO_CHAR(R.DUE_DATE, 'YYYY-MM-DD') DUE_DATE,
        R.RCVD_TP,
        TO_CHAR(R.RCVD_DT, 'YYYY-MM-DD') RCVD_DT,
        TO_CHAR(R.OCR_DT, 'YYYY-MM-DD') OCR_DT,
        R.DEPT,
        R.EMPL,
        to_char(R.STR_DATE, 'YYYY-MM-DD') STR_DATE,
        to_char(R.END_DATE, 'YYYY-MM-DD') END_DATE
		  FROM LEV_REQEST_F L, REV_COLL_F R
		 WHERE 1 = 1
      AND L.PRT_AT_CODE=R.PRT_AT_CODE
      AND L.ACCNUT_YEAR=R.FISCAL_YR
      AND L.CHRGE_KND=R.WORK_CODE
      AND L.NTICNO=R.BILL_NO
     AND L.PRT_AT_CODE = #prtAtCode#
	AND L.MNG_YEAR = #mngYear#
	AND L.MNG_NO = #mngNo#
	AND L.MNG_CNT = #mngCnt#
     AND L.CHRGE_KND     = #chrgeKnd#
    AND L.NTIC_CNT = #nticCnt#
      union
      SELECT '연체' BILL_TP,
      U.FISCAL_YR,
        U.WORK_CODE,
        U.BILL_NO,
        U.djiro_amnt bill_amnt,
        TO_CHAR(u.dly_bill_dt, 'YYYY-MM-DD') BILL_DT,
        TO_CHAR(u.DLY_DUE_DT, 'YYYY-MM-DD') DUE_DATE,
        U.DLY_RCVD_TP rcvd_tp,
        TO_CHAR(U.DLY_RCVD_DT, 'YYYY-MM-DD') RCVD_DT,
        TO_CHAR(U.OCR_DT, 'YYYY-MM-DD') ocr_dt,
        U.DEPT dept,
        U.EMPL empl,
        '' STR_DATE,
        '' END_DATE
        FROM LEV_REQEST_F L, UNPAID_F U WHERE L.PRT_AT_CODE=U.PRT_AT_CODE AND L.ACCNUT_YEAR=U.FISCAL_YR AND L.CHRGE_KND=U.WORK_CODE AND L.NTICNO=U.BILL_NO
              AND L.PRT_AT_CODE = #prtAtCode#
			       AND L.MNG_YEAR = #mngYear#
			       AND L.MNG_NO = #mngNo#
			       AND L.MNG_CNT = #mngCnt#
                  AND L.CHRGE_KND     = #chrgeKnd#
                  AND L.NTIC_CNT = #nticCnt#
                  ORDER BY BILL_DT
    </select>

    <select id="gamHtldRentFeeMngtDao.selectAssetRentFeeDetailMstPk_S" parameterClass="gamHtldRentFeeMngtVO" resultClass="egovMap">
		SELECT
			A.QUAY_GROUP_CD,
			TO_CHAR(A.GR_USAGE_PD_FROM, 'YYYY-MM-DD') GR_USAGE_PD_FROM,
			TO_CHAR(A.GR_USAGE_PD_TO, 'YYYY-MM-DD') GR_USAGE_PD_TO,
			A.GR_AR,
			A.GR_FEE,
			L.PRT_AT_CODE
	       , L.MNG_YEAR
	       , L.MNG_NO
	       , L.MNG_CNT
	        , L.NTIC_CNT
	       , L.CHRGE_KND
	       , L.ENTRPSCD
	       , L.ENTRPS_NM
	       , TO_CHAR(L.NTIC_PD_FROM, 'YYYY-MM-DD') NTIC_PD_FROM
	       , TO_CHAR(L.NTIC_PD_TO, 'YYYY-MM-DD') NTIC_PD_TO
	       , GAM_GET_FEE_TP_NM(L.PRT_AT_CODE, 'H', L.CHRGE_KND) CHRGE_KND_NM
	       , NVL(L.FEE,0) FEE
	       , L.VAT_YN
	       , NVL(L.VAT,0) VAT
	       , NVL(L.REIM_FEE, 0) REIM_FEE
	       , TO_CHAR(L.PAY_TMLMT, 'YYYY-MM-DD') PAY_TMLMT
	       , L.NHT_ISUE_YN
	       , NVL(L.NHT_PRINT_YN,'N') AS NHT_PRINT_YN
	       , TO_CHAR(L.NTIC_DT, 'YYYY-MM-DD') NTIC_DT
	       , NVL(L.NTIC_AMT,0) NTIC_AMT
	       , NVL(L.ARRRG_AMT,0) ARRRG_AMT
	       , NVL(L.INTR_AMNT,0) INTR_AMNT
	       , L.RCIV_SE
	       , TO_CHAR(L.RCIV_DT, 'YYYY-MM-DD') RCIV_DT
	       , L.RM
	       , L.NTIC_MTH
	       , GAM_GETCODENAME('GAM008', L.NTIC_MTH) NTIC_MTH_NM
	       , L.DEPTCD
			, GAM_GETDEPTNAME(L.DEPTCD) DEPTCD_NM
	       , L.REG_USR
	       , TO_CHAR(L.REGIST_DT, 'YYYY-MM-DD') REGIST_DT
	       , L.UPD_USR
	       , TO_CHAR(L.UPDT_DT, 'YYYY-MM-DD') UPDT_DT

	       , L.ACCNUT_YEAR
	       , L.NTICNO
	       , L.SANCTN_STTUS
	       , L.SANCTNER_EMPL_NO
	       , TO_CHAR(L.SANCTN_DT, 'YYYY-MM-DD') SANCTN_DT
	       , GAM_GETCODENAME('GAM046', L.SANCTN_STTUS) SANCTN_STTUS_NM
	       , NVL(L.OLNLP,0) OLNLP
	       , L.ARRRG_NO
	       , L.ARRRG_TARIFF
	       , L.ARRRG_PAY_DATES
	       , L.INTR_AMNT
	       , L.INTR_CHRGE_KND
	       , L.INTR_FEE_NTICNO
	  FROM ASSETS_RENT_F A, LEV_REQEST_F L
	 WHERE 1 = 1
	   AND L.PRT_AT_CODE = #prtAtCode#
       AND L.MNG_YEAR = #mngYear#
       AND L.MNG_NO = #mngNo#
       AND L.MNG_CNT = #mngCnt#
       AND L.NTIC_CNT = #nticCnt#
       AND L.CHRGE_KND = #chrgeKnd#
	   AND L.PRT_AT_CODE = A.PRT_AT_CODE
       AND L.MNG_YEAR = A.MNG_YEAR
       AND L.MNG_NO = A.MNG_NO
       AND L.MNG_CNT = A.MNG_CNT
    </select>

    <select id="gamHtldRentFeeMngtDao.selectAssetRentFeeDetailSumPk_S" parameterClass="gamHtldRentFeeMngtVO" resultClass="egovMap">
         SELECT
                 COUNT(*) SUM_CNT
               , SUM(L.FEE) SUM_FEE
               , SUM(NVL(L.NTIC_AMT,0)) SUM_NTIC_AMT
                   	,SUM(L.INTR_AMNT) SUM_FEE_A3
                   	,SUM(L.ARRRG_AMT) SUM_FEE_D1
                   	,SUM(L.REIM_FEE) SUM_FEE_D2
                , SUM(NVL(L.NTIC_AMT, 0)) SUM_NHT_ISUE_AMT
               , SUM(NVL(L.VAT, 0)) SUM_VAT
          FROM ASSETS_RENT_F A, LEV_REQEST_F L
		 WHERE 1 = 1
		   AND A.PRT_AT_CODE = L.PRT_AT_CODE
			AND A.MNG_YEAR = L.MNG_YEAR
			AND A.MNG_NO = L.MNG_NO
			AND A.MNG_CNT = L.MNG_CNT
		   AND A.QUAY_GROUP_CD='H'
	       AND L.PRT_AT_CODE = #prtAtCode#
	       AND L.MNG_YEAR = #mngYear#
	       AND L.MNG_NO = #mngNo#
	       AND L.MNG_CNT = #mngCnt#
	       GROUP BY L.PRT_AT_CODE, L.MNG_YEAR, L.MNG_NO, L.MNG_CNT
    </select>

    <update id="gamHtldRentFeeMngtDao.updateAssetRentFeeMngtListDetail_S">
        UPDATE LEV_REQEST_F SET
		     RM     = #rm#
		     , UPD_USR      = #updUsr#
		     , UPDT_DT      = SYSDATE
		     , PAY_TMLMT = TO_DATE(#payTmlmt#, 'YYYY-MM-DD')
        	<isNotNull prepend="," property="reimFee" >
	        	REIM_FEE = #reimFee#
	        	<isNotEqual prepend="," property="reimFee" compareValue="0">
	        	REIM_FEE_NTICNO=''
	        	, REIM_CHRGE_KND = 'DB'
	        	, NTIC_AMT=FEE+NVL(VAT,0)+#reimFee#
	        	</isNotEqual>
	        	<isEqual prepend="," property="reimFee" compareValue="0">
	        	REIM_CHRGE_KND = ''
	        	, NTIC_AMT=FEE+NVL(VAT,0)
	        	</isEqual>
        	</isNotNull>
		WHERE  NTIC_CNT     = #nticCnt#
		AND    PRT_AT_CODE  = #prtAtCode#
		AND    MNG_YEAR     = #mngYear#
		AND    MNG_NO       = #mngNo#
		AND    MNG_CNT      = #mngCnt#
		AND	CHRGE_KND = #chrgeKnd#
    </update>

	<select id="gamHtldRentFeeMngtDao.selectCofixIntrrateList_D" parameterClass="gamHtldRentFeeMngtVO" resultClass="egovMap">
	  SELECT OBJ_YRMT,
			BLCE_STDR_INTRRATE*100 BLCE_STDR_INTRRATE,
			NEW_MANIP_AMT_STDR_INTRRATE*100 NEW_MANIP_AMT_STDR_INTRRATE,
			TO_CHAR(ANNODT, 'YYYY-MM-DD') ANNODT
		FROM COFIX_INTRRATE_F
		WHERE 1=1
		<isNotEmpty property="nticDtFrom" prepend="AND">
			<![CDATA[
			OBJ_YRMT > TO_CHAR(TO_DATE(#nticDtFrom#, 'YYYY-MM-DD')-365, 'YYYYMM')
			]]>
		</isNotEmpty>
		ORDER BY ANNODT DESC
    </select>

    <select id="gamHtldRentFeeMngtDao.selectNoticeRequest_S" parameterClass="gamHtldRentFeeMngtVO" resultClass="egovMap">
		SELECT
			L.PRT_AT_CODE PRT_AT_CODE,
			L.MNG_YEAR,
			L.MNG_NO,
			L.MNG_CNT,
			L.NTIC_CNT,
	        #chrgeKnd# CHRGE_KND,
	        L.ENTRPSCD,
	        L.ENTRPS_NM,
			#payTmlmt# PAY_TMLMT,
			L.FEE,
			L.VAT,
			L.VAT_YN,
			L.NTIC_AMT,
			L.INTR_AMNT,
			'DB' REIM_CHRGE_KND,
			'A3' INTR_CHRGE_KND
	  FROM LEV_REQEST_F L
	 WHERE 1 = 1
	   AND L.PRT_AT_CODE = #prtAtCode#
       AND L.MNG_YEAR = #mngYear#
       AND L.MNG_NO = #mngNo#
       AND L.MNG_CNT = #mngCnt#
       AND L.NTIC_CNT = #nticCnt#
    </select>

      <select id="gamHtldRentFeeMngtDao.selectNticNoAccnutYear_S" parameterClass="egovMap" resultClass="egovMap">
		SELECT LPAD(NVL(MAX(BILL_NO), 0) + 1, 6, '0') NTICNO,
		       TO_CHAR(SYSDATE, 'YYYY') ACCNUT_YEAR
		FROM REV_COLL_F
		WHERE PRT_AT_CODE = #prtAtCode# AND FEE_TP = GAM_GET_HTLD_FEE_TP(#chrgeKnd#) AND FISCAL_YR = TO_CHAR(SYSDATE, 'YYYY')
	</select>

      <select id="gamHtldRentFeeMngtDao.selectIntrNticNoAccnutYear_S" parameterClass="egovMap" resultClass="egovMap">
		SELECT LPAD(NVL(MAX(BILL_NO), 0) + 1, 6, '0') NTICNO,
		       TO_CHAR(SYSDATE, 'YYYY') ACCNUT_YEAR
		FROM REV_COLL_F
		WHERE PRT_AT_CODE = #prtAtCode# AND FEE_TP = GAM_GET_HTLD_FEE_TP(#intrChrgeKnd#) AND FISCAL_YR = TO_CHAR(SYSDATE, 'YYYY')
	</select>

      <select id="gamHtldRentFeeMngtDao.selectNticRequestRcvdTp_S" parameterClass="egovMap" resultClass="egovMap">
		<!-- SELECT BILL_NO,
				RCVD_TP,
		       RCVD_DT,
		       BILL_PRT_YN
		FROM REV_COLL_F P
		WHERE (P.PRT_AT_CODE, P.FISCAL_YR, P.FEE_TP, P.WORK_CODE, P.BILL_NO)
			IN (
				SELECT PRT_AT_CODE,
				    ACCNUT_YEAR,
				    GAM_GET_FEE_TP(CHRGE_KND),
				    GAM_GET_WORK_CODE(PRT_AT_CODE, MNG_YEAR, MNG_NO, MNG_CNT, NTIC_CNT, CHRGE_KND),
				    NTICNO
				FROM LEV_REQEST_F
				WHERE PRT_AT_CODE=#prtAtCode# AND MNG_YEAR=#mngYear# AND MNG_NO=#mngNo# AND MNG_CNT=#mngCnt# AND NTIC_CNT=#nticCnt# AND CHRGE_KND=#chrgeKnd#
			) -->
			<!-- 일반부두 소스로 고침. 2015.11.30 김종민 수정 -->
		SELECT BILL_NO,
				RCVD_TP,
		       RCVD_DT,
		       BILL_PRT_YN
		FROM REV_COLL_F P,
				(
					SELECT PRT_AT_CODE, ACCNUT_YEAR, NTICNO, CHRGE_KND
					FROM LEV_REQEST_F
					WHERE PRT_AT_CODE=#prtAtCode# AND MNG_YEAR=#mngYear# AND MNG_NO=#mngNo# AND MNG_CNT=#mngCnt# AND NTIC_CNT=#nticCnt# AND CHRGE_KND=#chrgeKnd#
				) L
		WHERE P.PRT_AT_CODE = L.PRT_AT_CODE
			AND P.FISCAL_YR=L.ACCNUT_YEAR
			AND P.FEE_TP = GAM_GET_HTLD_FEE_TP(L.CHRGE_KND)
			AND BILL_NO=L.NTICNO
	</select>

    <update id="gamHtldRentFeeMngtDao.updateLevReqestIssueYn" parameterClass="egovMap">
        UPDATE LEV_REQEST_F SET
      		NHT_ISUE_YN=#nhtIsueYn#,
      		NTICNO=#nticno#,
      		ACCNUT_YEAR=#accnutYear#,
      		PAY_TMLMT=#payTmlmt#
     		<isNotNull prepend="," property="nticAmt">
      			NTIC_AMT=#nticAmt#
     		</isNotNull>
     		<isNotNull prepend="," property="intrAmnt">
      			INTR_AMNT=#intrAmnt#
     		</isNotNull>
     		<isNotNull prepend="," property="intrRate">
      			INTR_RATE=TO_NUMBER(#intrRate#)/100
     		</isNotNull>
     		<isNotNull prepend="," property="intrChrgeKnd">
      			INTR_CHRGE_KND=#intrChrgeKnd#
     		</isNotNull>
     		<isNotNull prepend="," property="intrFeeNticno">
     			INTR_FEE_NTICNO=#intrFeeNticno#
     		</isNotNull>
     		<isNotNull prepend="," property="rm">
     			RM=#rm#
     		</isNotNull>
       <isEqual prepend="," property="nhtIsueYn" compareValue="Y">
       		NTIC_DT=SYSDATE
     	</isEqual>
       <isNotEqual prepend="," property="nhtIsueYn" compareValue="Y">
       		NTIC_DT=''
     	</isNotEqual>
     	WHERE
			PRT_AT_CODE=#prtAtCode#
	      	AND MNG_YEAR=#mngYear#
	      	AND MNG_NO=#mngNo#
	      	AND MNG_CNT=#mngCnt#
	      	AND NTIC_CNT=#nticCnt#
	      	AND (NHT_PRINT_YN IS NULL OR NHT_PRINT_YN = 'N')
  </update>

    <insert id="gamHtldRentFeeMngtDao.insertNticRequestRevCollF_S" parameterClass="egovMap" >
        INSERT INTO REV_COLL_F (
      PRT_AT_CODE,
      FEE_TP,
      WORK_CODE,
      FISCAL_YR, BILL_NO,
      AGENT_CODE, BZ_RGST_ID, AGENT_NAME, SSN,
      BILL_DT, DUE_DATE, BILL_PRT_YN,
      BILL_AMNT, EXMP_AMNT, OVER_AMNT, DC_AMNT,
		RCVD_TP,
      UPDT_UID, UPDT_DATE, FIRST_BILL_DT, VAT_YN, VAT, STR_DATE, END_DATE,
      DEPT,USER_NAME
      )
      values (
      	#prtAtCode#,
      	GAM_GET_HTLD_FEE_TP(#chrgeKnd#),
      	#chrgeKnd#,
      	#accnutYear#,
      	#nticno#,
      	#entrpscd#,
      	(SELECT BIZRNO FROM ENTRPS_INFO_F WHERE ENTRPSCD=#entrpscd#),
      	#entrpsNm#,
      	(SELECT SSN FROM ENTRPS_INFO_F WHERE ENTRPSCD=#entrpscd#),
      	SYSDATE,
      	#payTmlmt#,
      	#nhtPrintYn#,
      	#nticAmt#, #rdcxptFee#, 0, 0,
      	'0',
      	#updUsr#, SYSDATE, SYSDATE, #vatYn#, #vat#, #nticPdFrom#, #nticPdTo#,
	      #deptCd#,
	      #userName#
      )
    </insert>

    <insert id="gamHtldRentFeeMngtDao.insertIntrNticRequestRevCollF_S" parameterClass="egovMap" >
        INSERT INTO REV_COLL_F (
      PRT_AT_CODE,
      FEE_TP,
      WORK_CODE,
      FISCAL_YR, BILL_NO,
      AGENT_CODE, BZ_RGST_ID, AGENT_NAME, SSN,
      BILL_DT, DUE_DATE, BILL_PRT_YN,
      BILL_AMNT, EXMP_AMNT, OVER_AMNT, DC_AMNT,
		RCVD_TP,
      UPDT_UID, UPDT_DATE, FIRST_BILL_DT, VAT_YN, VAT, STR_DATE, END_DATE,
      DEPT,USER_NAME
      )
        SELECT
      L.PRT_AT_CODE,
      GAM_GET_HTLD_FEE_TP(#intrChrgeKnd#) FEE_TP,
      GAM_GET_WORK_CODE(L.PRT_AT_CODE, L.MNG_YEAR, L.MNG_NO, L.MNG_CNT, L.NTIC_CNT, #intrChrgeKnd#)  WORK_CODE,
      #accnutYear# FISCAL_YR, #intrFeeNticno# BILL_NO,
      L.ENTRPSCD,
      (SELECT BIZRNO FROM ENTRPS_INFO_F E WHERE L.ENTRPSCD=ENTRPSCD) BZ_RGST_ID,
      L.ENTRPS_NM AGENT_NAME,
      (SELECT SSN FROM ENTRPS_INFO_F E WHERE L.ENTRPSCD=ENTRPSCD) SSN,
      SYSDATE,
      TO_DATE(L.PAY_TMLMT, 'YYYY-MM-DD'),
      L.NHT_PRINT_YN,
      L.INTR_AMNT, 0, 0, 0,
	  '0',
      #updUsr#, SYSDATE, SYSDATE, '0', '0', L.NTIC_PD_FROM, L.NTIC_PD_TO,
      #deptCd#,
      #userName#
      FROM LEV_REQEST_F L
      WHERE PRT_AT_CODE=#prtAtCode#
      	AND MNG_YEAR=#mngYear#
      	AND MNG_NO=#mngNo#
      	AND MNG_CNT=#mngCnt#
      	AND NTIC_CNT=#nticCnt#
    </insert>

    <delete id="gamHtldRentFeeMngtDao.deleteNticRequestRevCollF_S">
         DELETE FROM REV_COLL_F
          WHERE (PRT_AT_CODE, FISCAL_YR, FEE_TP, WORK_CODE, BILL_NO) IN (
          	SELECT L.PRT_AT_CODE,
          		L.ACCNUT_YEAR,
          		GAM_GET_HTLD_FEE_TP(L.CHRGE_KND),
          		L.CHRGE_KND,
          		L.NTICNO
          	FROM LEV_REQEST_F L
		      WHERE PRT_AT_CODE=#prtAtCode#
		      	AND MNG_YEAR=#mngYear#
		      	AND MNG_NO=#mngNo#
		      	AND MNG_CNT=#mngCnt#
		      	AND NTIC_CNT=#nticCnt#
      	)
    </delete>

        <delete id="gamHtldRentFeeMngtDao.deleteIntrNticRequestRevCollF_S">
         DELETE FROM REV_COLL_F
          WHERE (PRT_AT_CODE, FISCAL_YR, FEE_TP, WORK_CODE, BILL_NO) IN (
          	SELECT L.PRT_AT_CODE,
          		L.ACCNUT_YEAR,
          		GAM_GET_HTLD_FEE_TP(L.INTR_CHRGE_KND),
          		GAM_GET_WORK_CODE(L.PRT_AT_CODE, L.MNG_YEAR, L.MNG_NO, L.MNG_CNT, L.NTIC_CNT, L.INTR_CHRGE_KND),
          		L.INTR_FEE_NTICNO
          	FROM LEV_REQEST_F L
		      WHERE PRT_AT_CODE=#prtAtCode#
		      	AND MNG_YEAR=#mngYear#
		      	AND MNG_NO=#mngNo#
		      	AND MNG_CNT=#mngCnt#
		      	AND NTIC_CNT=#nticCnt#
      	)
    </delete>

    <select id="gamHtldRentFeeMngtDao.selectNoticeRequestPk_S" parameterClass="gamHtldRentFeeMngtVO" resultClass="egovMap">
		SELECT L.PRT_AT_CODE,
		  L.MNG_YEAR,
		  L.MNG_NO,
		  L.MNG_CNT,
		  L.NTIC_CNT,
		  L.CHRGE_KND,
		  L.ENTRPSCD,
		  L.ENTRPS_NM,
		  #nticPdFrom# NTIC_PD_FROM,
		  #nticPdTo# NTIC_PD_TO,
		  A.GR_AR,
		  #rm# RM,
		  TO_CHAR(p2mgr.sf_get_wrk_dt@ygpa_portmis(SYSDATE+14), 'YYYY-MM-DD') PAY_TMLMT,
		  #intrRate# INTR_RATE,
		  #intrAmnt# INTR_AMNT,
		  L.FEE,
		  #vat# VAT,
		  #nticAmt# NTIC_AMT,
		  #chrgeKnd# CHRGE_KND
		FROM ASSETS_RENT_F A,
		  LEV_REQEST_F L
		WHERE 1 = 1
		AND L.PRT_AT_CODE=A.PRT_AT_CODE
		AND L.MNG_YEAR=A.MNG_YEAR
		AND L.MNG_NO=A.MNG_NO
		AND L.MNG_CNT=A.MNG_CNT
		AND A.QUAY_GROUP_CD='H'
	    AND L.PRT_AT_CODE = #prtAtCode#
        AND L.MNG_YEAR = #mngYear#
        AND L.MNG_NO = #mngNo#
        AND L.MNG_CNT = #mngCnt#
        AND L.NTIC_CNT = #nticCnt#
    </select>

    <select id="gamHtldRentFeeMngtDao.selectInsertHtldRentFee_S" parameterClass="gamHtldRentFeeMngtVO" resultClass="int">
		SELECT
			COUNT(*) TOT_CNT
	  FROM LEV_REQEST_F L
	 WHERE 1 = 1
	   AND L.PRT_AT_CODE = #prtAtCode#
       AND L.MNG_YEAR = #mngYear#
       AND L.MNG_NO = #mngNo#
       AND L.MNG_CNT = #mngCnt#
       AND L.NTIC_CNT = #nticCnt#
       AND L.CHRGE_KND = 'HZ'
    </select>

	<insert id="gamHtldRentFeeMngtDao.insertHtldRentFee_S">
        INSERT INTO LEV_REQEST_F (
          PRT_AT_CODE
          , MNG_YEAR
          , MNG_NO
          , MNG_CNT
          , NTIC_CNT
          , FCLTY_SE
          , CHRGE_KND
          , ENTRPSCD
          , ENTRPS_NM
          , NTIC_PD_FROM
          , NTIC_PD_TO
          , FEE
          , VAT_YN
          , VAT
          , NTIC_AMT
          , INTR_AMNT
		  , INTR_RATE
          , NTIC_MTH
          , REG_USR
          , REGIST_DT
        )
        SELECT
          PRT_AT_CODE
          , MNG_YEAR
          , MNG_NO
          , MNG_CNT
          , #nticCnt#
          , '1'
          , 'HZ'
          , ENTRPSCD
          , ENTRPS_NM
          , TO_DATE(#nticPdFrom#, 'YYYY-MM-DD')
          , TO_DATE(#nticPdTo#, 'YYYY-MM-DD')
          , #fee#
          , TAXT_SE
          , #vat#
          , #nticAmt#
          , #intrAmnt#
          , #intrRate#/100
          , NTIC_MTH
          , #regUsr#
          , SYSDATE
          FROM ASSETS_RENT_F
          WHERE PRT_AT_CODE=#prtAtCode#
          	and MNG_YEAR=#mngYear#
          	and MNG_NO=#mngNo#
          	and MNG_CNT=#mngCnt#
    </insert>

    <update id="gamHtldRentFeeMngtDao.updateHtldRentFee_S">
    	<![CDATA[
        UPDATE LEV_REQEST_F SET
		     NTIC_PD_FROM = TO_DATE(#nticPdFrom#,'YYYY-MM-DD')
		     , NTIC_PD_TO 	= TO_DATE(#nticPdTo#,'YYYY-MM-DD')
		     , FEE          = #fee#
		     , VAT_YN       = #vatYn#
		     , VAT          = #vat#
		     , NTIC_AMT     = #nticAmt#
		     , NTIC_MTH     = #nticMth#
		     , INTR_AMNT     = #intrAmnt#
		     , INTR_RATE     = #intrRate#/100
		     , UPD_USR      = #updUsr#
		     , UPDT_DT      = SYSDATE
		WHERE  PRT_AT_CODE  = #prtAtCode#
			AND MNG_YEAR     = #mngYear#
			AND MNG_NO       = #mngNo#
			AND MNG_CNT      = #mngCnt#
			AND NTIC_CNT     = #nticCnt#
		    AND CHRGE_KND = 'HZ'
		    AND (NHT_ISUE_YN IS NULL OR NHT_ISUE_YN  <> 'Y')
	      ]]>
    </update>

  <update id="gamHtldRentFeeMngtDao.updateLevReqestNhtPrintYn" parameterClass="hashMap">
        UPDATE LEV_REQEST_F SET
      		NHT_PRINT_YN=#nhtPrintYn#
      		WHERE
			PRT_AT_CODE=#prtAtCode#
      	AND MNG_YEAR=#mngYear#
      	AND MNG_NO=#mngNo#
      	AND MNG_CNT=#mngCnt#
      	AND NTIC_CNT=#nticCnt#
      	AND CHRGE_KND=#chrgeKnd#
  </update>

  <update id="gamHtldRentFeeMngtDao.updateRevCollFBillPrintYn" parameterClass="hashMap">
        UPDATE REV_COLL_F SET
      		BILL_PRT_YN=#nhtPrintYn#
      		WHERE
      			(PRT_AT_CODE, FISCAL_YR, FEE_TP, WORK_CODE, BILL_NO) IN (
          	SELECT L.PRT_AT_CODE,
          		L.ACCNUT_YEAR,
          		GAM_GET_HTLD_FEE_TP(L.CHRGE_KND),
          		<!-- GAM_GET_WORK_CODE(L.PRT_AT_CODE, L.MNG_YEAR, L.MNG_NO, L.MNG_CNT, L.NTIC_CNT, L.INTR_CHRGE_KND), -->
          		L.CHRGE_KND, <!-- WORK_CODE 수정 2015.12.04 김종민 -->
          		L.NTICNO
          	FROM LEV_REQEST_F L
		      WHERE PRT_AT_CODE=#prtAtCode#
		      	AND MNG_YEAR=#mngYear#
		      	AND MNG_NO=#mngNo#
		      	AND MNG_CNT=#mngCnt#
		      	AND NTIC_CNT=#nticCnt#
      	)
  </update>

  <update id="gamHtldRentFeeMngtDao.updateUnpaidFBillPrintYn" parameterClass="hashMap">
        UPDATE UNPAID_F_TEST SET
      		DLY_BILL_PRT_YN=#nhtPrintYn#
      		WHERE
	      		(PRT_AT_CODE, FISCAL_YR, FEE_TP, WORK_CODE, BILL_NO) IN (
          	SELECT L.PRT_AT_CODE,
          		L.ACCNUT_YEAR,
          		GAM_GET_HTLD_FEE_TP(L.INTR_CHRGE_KND),
          		GAM_GET_WORK_CODE(L.PRT_AT_CODE, L.MNG_YEAR, L.MNG_NO, L.MNG_CNT, L.NTIC_CNT, L.INTR_CHRGE_KND),
          		L.INTR_FEE_NTICNO
          	FROM LEV_REQEST_F L
		      WHERE PRT_AT_CODE=#prtAtCode#
		      	AND MNG_YEAR=#mngYear#
		      	AND MNG_NO=#mngNo#
		      	AND MNG_CNT=#mngCnt#
		      	AND NTIC_CNT=#nticCnt#
  </update>

	<delete id="gamHtldRentFeeMngtDao.deleteHtldRentFeeMngtList_S">
	<![CDATA[
	    delete lev_reqest_f
		where (PRT_AT_CODE, mng_year, mng_no, mng_cnt, ntic_cnt) IN (
		select l.prt_at_code,
		  l.mng_year,
		  l.mng_no,
		  l.mng_cnt,
		  l.ntic_cnt
		from assets_rent_f a, lev_reqest_f l
		where 1=1
		  and a.prt_at_code=l.prt_at_code
		  and a.mng_year=l.mng_year
		  and a.mng_no=l.mng_no
		  and a.mng_cnt=l.mng_cnt
		  and a.quay_group_cd='H'
		  and (
		    (a.ntic_mth='1' and l.ntic_pd_from>=to_date(#nticPdFrom#, 'YYYY-MM-DD') and l.ntic_pd_to<add_months(to_date(#nticPdFrom#, 'YYYY-MM-DD'), 12))
		    OR (a.ntic_mth='2' and l.ntic_pd_from>=to_date(#nticPdFrom#, 'YYYY-MM-DD') and l.ntic_pd_to<add_months(to_date(#nticPdFrom#, 'YYYY-MM-DD'),6))
		    OR (a.ntic_mth='3' and l.ntic_pd_from>=to_date(#nticPdFrom#, 'YYYY-MM-DD') and l.ntic_pd_to<add_months(to_date(#nticPdFrom#, 'YYYY-MM-DD'),4))
		    OR (a.ntic_mth='4' and l.ntic_pd_from>=to_date(#nticPdFrom#, 'YYYY-MM-DD') and l.ntic_pd_to<add_months(to_date(#nticPdFrom#, 'YYYY-MM-DD'),3))
		    OR (l.ntic_pd_from>=to_date(#nticPdFrom#, 'YYYY-MM-DD') and l.ntic_pd_to<add_months(to_date(#nticPdFrom#, 'YYYY-MM-DD'),1))
		    )
		)
		]]>
	</delete>

    <select id="gamHtldRentFeeMngtDao.selectRevCollF" parameterClass="map" resultClass="egovMap">
        /*+ gamNticRequestMngtDAO.selectRevCollF */
        /* [전자고지] 고지 정보 조회 eunsungj */
        SELECT
			R.PRT_AT_CODE,
			R.FEE_TP,
			R.FISCAL_YR,
			R.BILL_NO,
			R.VSSL_KEY,
			R.YR,
			R.SER_NO,
			R.ACCNT_CODE,
			R.AGENT_CODE,
			R.BILL_AMNT,
			R.BILL_AMNT_R3,
			R.BILL_AMNT_R2,
			R.BILL_AMNT_R1,
			TO_CHAR(R.BILL_DT, 'YYYYMMDD') BILL_DT,
			R.BILL_PRT_YN,
			R.AMNT_RSN,
			R.SSN,
			TO_CHAR(R.DUE_DATE, 'YYYYMMDD') DUE_DATE,
			TO_CHAR(R.FIRST_BILL_DT, 'YYYYMMDD') FIRST_BILL_DT,
			R.ICHE_STATUS,
			R.BZ_RGST_ID,
			R.AGENT_NAME,
			R.IO_TP,
			TO_CHAR(R.RCVD_DT, 'YYYYMMDD') RCVD_DT,
			R.RCVD_TP,
			R.RSLT_CODE,
			R.VSSL_KOR_NM,
			TO_CHAR(R.UPDT_DATE, 'YYYYMMDD') UPDT_DATE,
			R.UPDT_UID,
			R.EXMP_AMNT,
			R.OVER_AMNT,
			R.SALIMI_NO,
			TO_CHAR(R.IO_DT, 'YYYYMMDD') IO_DT,
			R.DC_AMNT,
			R.DC_CODE,
			R.DC_RATE,
			R.RCVD_NM,
			TO_CHAR(R.RECPT_EPDT, 'YYYYMMDD') RECPT_EPDT,
			R.POST_BILL_YN,
			R.NOPAY_LOSS_REAS_CD,
			R.ELCT_BILL_RSLT,
			TO_CHAR(R.BULL_INFO_INQR_DTIME, 'YYYYMMDD') BULL_INFO_INQR_DTIME,
			R.LAST,
			R.VAT,
			R.VAT_YN,
			R.JINGSUJA,
			R.JIRO_RCVD_TP,
			R.JIRO_RCVD_BR,
			R.COMMISSION,
			R.MAGAM_FLAG,
			TO_CHAR(R.OCR_DT, 'YYYYMMDD') OCR_DT,
			R.DEPT,
			R.EMPL,
			R.WORK_CODE,
			R.ORIGIN_FEE_TP,
			R.ORIGIN_FISCAL_YR,
			R.ORIGIN_BILL_NO,
			R.CYBER_VAT,
			R.VACCT_NO,
			TO_CHAR(R.END_DATE, 'YYYYMMDD') END_DATE,
			R.FAC_CODE,
			R.FAC_SUB_CODE,
			TO_CHAR(R.STR_DATE, 'YYYYMMDD') STR_DATE,
			R.CALL_LETTER,
			R.CNV_YN,
			R.INPUT_YN,
			R.FINAL_FLAG,
			R.RESPONSE_DESC1,
			R.RESPONSE_DESC2,
			R.LOGIS_CONFIRM_NAME,
			R.LOGIS_SEND_YN,
			R.SENDING_COUNT,
			R.BILL_COUNT,
			R.RCVD_COUNT,
			R.TAX_CODE,
			R.TAX_MODIFY_CODE,
			R.VAT1,
			R.VAT2,
			R.VAT3,
			R.SMALL_BILL_NO_INFO,
			R.SMALL_BILL_NO,
			R.SMALL_FISCAL_YR,
			R.SMALL_BILL_YN,
			R.BILL_AMNT_BF,
			R.USER_NAME,
			<!--
			(R.BILL_AMNT+NVL(R.VAT, 0)+NVL(R.REIM_FEE, 0)) BILL_SUM_AMNT,
			 -->
			 L.NTIC_AMT BILL_SUM_AMNT,
      		L.ARRRG_NO DLY_SER_NO,
      		TO_CHAR(L.PAY_TMLMT, 'YYYYMMDD') DLY_DUE_DT
        FROM REV_COLL_F R, LEV_REQEST_F L
        WHERE 1=1
          AND L.PRT_AT_CODE=#prtAtCode#
          AND L.MNG_YEAR=#mngYear#
          AND L.MNG_NO=#mngNo#
          AND L.MNG_CNT=#mngCnt#
          AND L.NTIC_CNT=#nticCnt#
          AND L.CHRGE_KND=#chrgeKnd#
                    AND R.PRT_AT_CODE = L.PRT_AT_CODE
          AND R.FEE_TP = GAM_GET_HTLD_FEE_TP(L.CHRGE_KND)
          AND R.FISCAL_YR = L.ACCNUT_YEAR
          AND R.BILL_NO = L.NTICNO
    </select>

	<delete id="gamHtldRentFeeMngtDao.clearHtldRentFeeList_D" parameterClass="gamHtldRentFeeDefaultVO">
	<![CDATA[
		DELETE FROM LEV_REQEST_F
		where (PRT_AT_CODE,
		  MNG_YEAR,
		  MNG_NO,
		  MNG_CNT,
		  NTIC_CNT
		  ) in (
		  select
		  L.PRT_AT_CODE,
		  L.MNG_YEAR,
		  L.MNG_NO,
		  L.MNG_CNT,
		  L.NTIC_CNT
					FROM ASSETS_RENT_F A LEFT JOIN
					  LEV_REQEST_F L
					  ON A.PRT_AT_CODE  = L.PRT_AT_CODE
					AND A.MNG_YEAR     = L.MNG_YEAR
					AND A.MNG_NO       = L.MNG_NO
					AND A.MNG_CNT      = L.MNG_CNT
					AND L.NTIC_PD_FROM >= TO_DATE(#nticPdFrom#, 'YYYY-MM-DD')
          ]]>
					<isNotEmpty prepend="AND" property="nticPdTo">
	<![CDATA[
						L.NTIC_PD_FROM < TO_DATE(#nticPdTo#, 'YYYY-MM-DD')
          ]]>
					</isNotEmpty>
	<![CDATA[
					WHERE 1            = 1
					AND A.QUAY_GROUP_CD='H'
					AND a.gr_usage_pd_from < TO_DATE(#nticPdFrom#, 'YYYY-MM-DD')
					AND a.gr_usage_pd_to > TO_DATE(#nticPdFrom#, 'YYYY-MM-DD')
          )
          ]]>
	</delete>
	
	<!-- 고지할 때 사용료, 이자, 이자율, 부가세, 고지금액을 변경한다. 2015.12.10 김종민 추가 -->
	<update id="gamHtldRentFeeMngtDao.updateLevReqestAmount_S" parameterClass="gamHtldRentFeeMngtVO">
		UPDATE LEV_REQEST_F SET
			FEE = #fee#, 
			INTR_AMNT = #intrAmnt#,
			VAT = #vat#,
			INTR_RATE = #intrRate#,
			NTIC_AMT = #nticAmt#,
			ADD_AMNT = #addAmnt#,
			ADD_AMNT_RM = #addAmntRm#
		WHERE
			PRT_AT_CODE = #prtAtCode#
			AND MNG_YEAR = #mngYear#
			AND MNG_NO = #mngNo#
			AND MNG_CNT = #mngCnt#
			AND NTIC_CNT = #nticCnt#
	</update> 

	<select id="gamHtldRentFeeMngtDao.selectHtldRentAreaList_D" resultClass="egovMap">
		SELECT 
			CODE
			,CODE_NM 
		FROM
			COMTCCMMNDETAILCODE
    	WHERE 
    		CODE_ID = 'GAM062'
	</select>

	<insert id="gamHtldRentFeeMngtDao.insertHtldRentDetailFeeHist_S">
        INSERT INTO HTLD_RENT_DETAIL_FEE_HIST_F (
          PRT_AT_CODE
          , MNG_YEAR
          , MNG_NO
          , MNG_CNT
          , ASSETS_USAGE_SEQ
          , NTIC_CNT
          , CHRGE_KND
          , USAGE_AR
          , APPLC_PRICE
          , PRICE_SE
          , FEE
          , INTR_AMNT
          , INTR_RATE
          , NTIC_PD_FROM
          , NTIC_PD_TO
          , REG_USR
          , REGIST_DT
        ) VALUES (
        	#prtAtCode#
        	, #mngYear#
        	, #mngNo#
        	, #mngCnt#
        	, #assetsUsageSeq#
        	, #nticCnt#
        	, #chrgeKnd#
        	, TO_NUMBER(#usageAr#)
        	, TO_NUMBER(#applcPrice#)
        	, #priceSe#
        	, TO_NUMBER(#fee#)
        	, TO_NUMBER(#intrAmnt#)
        	, TO_NUMBER(#intrRate#)/100
        	, TO_DATE(#nticPdFrom#, 'YYYY-MM-DD')
        	, TO_DATE(#nticPdTo#, 'YYYY-MM-DD')
        	, #regUsr#
        	, SYSDATE
        )
    </insert>

	<delete id="gamHtldRentFeeMngtDao.deleteHtldRentDetailFeeHist_D">
		DELETE FROM HTLD_RENT_DETAIL_FEE_HIST_F
		WHERE
			PRT_AT_CODE = #prtAtCode#
			AND MNG_YEAR = #mngYear#
			AND MNG_NO = #mngNo#
			AND MNG_CNT = #mngCnt#
			AND NTIC_CNT = #nticCnt#
			AND CHRGE_KND = #chrgeKnd#
	</delete>	

    <select id="gamHtldRentFeeMngtDao.selectNticPrintDetailHist_D" parameterClass="hashMap" resultClass="egovMap">
    	SELECT 
          PRT_AT_CODE
          , MNG_YEAR
          , MNG_NO
          , MNG_CNT
          , ASSETS_USAGE_SEQ
          , NTIC_CNT
          , CHRGE_KND
          , USAGE_AR
          , APPLC_PRICE
          , PRICE_SE
          , FEE
          , INTR_AMNT
          , INTR_RATE
          , NTIC_PD_FROM
          , NTIC_PD_TO
         FROM
         	HTLD_RENT_DETAIL_FEE_HIST_F
         WHERE
				PRT_AT_CODE   = #prtAtCode#
				AND MNG_YEAR      = #mngYear#
				AND MNG_NO        = #mngNo#
				AND MNG_CNT       = #mngCnt#
				AND NTIC_CNT      = #nticCnt#         	
    </select>

</sqlMap>