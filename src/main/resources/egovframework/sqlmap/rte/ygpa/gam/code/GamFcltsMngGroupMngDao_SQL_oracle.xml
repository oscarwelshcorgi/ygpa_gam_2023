<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="ygpa.gam.code">

	<typeAlias alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias alias="hashMap" type="java.util.HashMap"/>
	<typeAlias alias="gamFcltsMngGroupMngVo" type="egovframework.rte.ygpa.gam.code.service.GamFcltsMngGroupMngVo"/>

	<resultMap id="gamFcltsMngGroupMngSumMap" class="egovframework.rte.ygpa.gam.code.service.GamFcltsMngGroupMngVo">
		<result property="dataCount" column="DATA_COUNT" columnIndex="1"/>
		<result property="sumArchFcltsCnt" column="SUM_ARCH_FCLTS_CNT" columnIndex="2"/>
		<result property="sumCvlEngFcltsCnt" column="SUM_CVL_ENG_FCLTS_CNT" columnIndex="3"/>
		<result property="sumMechFcltsCnt" column="SUM_MECH_FCLTS_CNT" columnIndex="4"/>
		<result property="sumElctyFcltsCnt" column="SUM_ELCTY_FCLTS_CNT" columnIndex="5"/>
		<result property="sumInfoCommFcltsCnt" column="SUM_INFO_COMM_FCLTS_CNT" columnIndex="6"/>
		<result property="sumEtcFcltsCnt" column="SUM_ETC_FCLTS_CNT" columnIndex="7"/>
	</resultMap>

	<select id="gamFcltsMngGroupMngDao.selectFcltsMngGroupMngList_D" parameterClass="gamFcltsMngGroupMngVo" resultClass="egovMap">
		SELECT A.*
			FROM (
				SELECT ROWNUM RNUM, S.*
					FROM (
						SELECT
								 FCLTS_MNG_GROUP_NO
								,FCLTS_MNG_GROUP_NM
								,PRT_AT_CODE
								,GAM_GETCODENAME('GAM019',PRT_AT_CODE) AS PRT_AT_CODE_NM
								,LOC
								,OWNER
								,TO_CHAR(BLD_DT,'YYYY-MM-DD') AS BLD_DT
								,TO_CHAR(CNST_BEGIN_DT,'YYYY-MM-DD') AS CNST_BEGIN_DT
								,TO_CHAR(CNST_END_DT,'YYYY-MM-DD') AS CNST_END_DT
								,CNSTRTR
								,LTRIM(TO_CHAR(NVL(CNSTRCT_AMT,0),'999,999,999,990')) AS CNSTRCT_AMT
								,FCLTS_GBN
								,GAM_GET_FCLTS_GBN_NM(FCLTS_GBN) AS FCLTS_GBN_NM
								,FCLTS_SE
								,GAM_GET_FCLTS_SE_NM(FCLTS_SE) AS FCLTS_SE_NM
								,FCLTS_KND
								,GAM_GET_FCLTS_KND_NM(FCLTS_KND) AS FCLTS_KND_NM
								,FCLTS_CN
								,FCLTS_STRCT
								,ARCH_FCLTS_CN
								,ARCH_FCLTS_STRCT
								,CVL_ENG_FCLTS_CN
								,CVL_ENG_FCLTS_STRCT
								,MECH_FCLTS_CN
								,MECH_FCLTS_STRCT
								,ELCTY_FCLTS_CN
								,ELCTY_FCLTS_STRCT
								,INFO_COMM_FCLTS_CN
								,INFO_COMM_FCLTS_STRCT
								,ETC_FCLTS_CN
								,ETC_FCLTS_STRCT
								,LTRIM(TO_CHAR(NVL(ARCH_FCLTS_CNT,0),'999,999,999,990')) AS ARCH_FCLTS_CNT
								,LTRIM(TO_CHAR(NVL(CVL_ENG_FCLTS_CNT,0),'999,999,999,990')) AS CVL_ENG_FCLTS_CNT
								,LTRIM(TO_CHAR(NVL(MECH_FCLTS_CNT,0),'999,999,999,990')) AS MECH_FCLTS_CNT
								,LTRIM(TO_CHAR(NVL(ELCTY_FCLTS_CNT,0),'999,999,999,990')) AS ELCTY_FCLTS_CNT
								,LTRIM(TO_CHAR(NVL(INFO_COMM_FCLTS_CNT,0),'999,999,999,990')) AS INFO_COMM_FCLTS_CNT
								,LTRIM(TO_CHAR(NVL(ETC_FCLTS_CNT,0),'999,999,999,990')) AS ETC_FCLTS_CNT
								,RM
								,REG_USR
								,TO_CHAR(REGIST_DT,'YYYY-MM-DD HH24:MI:SS') AS REGIST_DT
								,UPD_USR
								,TO_CHAR(UPDT_DT,'YYYY-MM-DD HH24:MI:SS') AS UPDT_DT
							FROM FCLTS_MNG_GROUP_F
						WHERE 1 = 1

						<isNotEmpty property="sFcltsMngGroupNo">
						AND FCLTS_MNG_GROUP_NO LIKE #sFcltsMngGroupNo# || '%'
						</isNotEmpty>

						<isNotEmpty property="sFcltsMngGroupNm">
						AND FCLTS_MNG_GROUP_NM LIKE '%' || #sFcltsMngGroupNm# || '%'
						</isNotEmpty>

						ORDER BY FCLTS_MNG_GROUP_NO
				) S
		) A
		<![CDATA[
		WHERE ROWNUM <= #recordCountPerPage# and RNUM > #firstIndex#
		]]>
	</select>

	<select id="gamFcltsMngGroupMngDao.selectFcltsMngGroupMngListTotCnt_S" parameterClass="gamFcltsMngGroupMngVo" resultMap="gamFcltsMngGroupMngSumMap">
		SELECT
				 LTRIM(TO_CHAR(COUNT(*),'999,999,999,990')) AS DATA_COUNT
				,LTRIM(TO_CHAR(NVL(SUM(ARCH_FCLTS_CNT),0),'999,999,999,990')) AS SUM_ARCH_FCLTS_CNT
				,LTRIM(TO_CHAR(NVL(SUM(CVL_ENG_FCLTS_CNT),0),'999,999,999,990')) AS SUM_CVL_ENG_FCLTS_CNT
				,LTRIM(TO_CHAR(NVL(SUM(MECH_FCLTS_CNT),0),'999,999,999,990')) AS SUM_MECH_FCLTS_CNT
				,LTRIM(TO_CHAR(NVL(SUM(ELCTY_FCLTS_CNT),0),'999,999,999,990')) AS SUM_ELCTY_FCLTS_CNT
				,LTRIM(TO_CHAR(NVL(SUM(INFO_COMM_FCLTS_CNT),0),'999,999,999,990')) AS SUM_INFO_COMM_FCLTS_CNT
				,LTRIM(TO_CHAR(NVL(SUM(ETC_FCLTS_CNT),0),'999,999,999,990')) AS SUM_ETC_FCLTS_CNT
			FROM FCLTS_MNG_GROUP_F
		WHERE 1=1

		<isNotEmpty property="sFcltsMngGroupNo">
		AND FCLTS_MNG_GROUP_NO LIKE #sFcltsMngGroupNo# || '%'
		</isNotEmpty>

		<isNotEmpty property="sFcltsMngGroupNm">
		AND FCLTS_MNG_GROUP_NM LIKE '%' || #sFcltsMngGroupNm# || '%'
		</isNotEmpty>

	</select>

	<select id="gamFcltsMngGroupMngDao.selectFcltsMngGroupMngPk_S" parameterClass="gamFcltsMngGroupMngVo" resultClass="egovMap">
		SELECT
				 FCLTS_MNG_GROUP_NO
				,FCLTS_MNG_GROUP_NM
				,PRT_AT_CODE
				,GAM_GETCODENAME('GAM019',PRT_AT_CODE) AS PRT_AT_CODE_NM
				,LOC
				,OWNER
				,TO_CHAR(BLD_DT,'YYYY-MM-DD') AS BLD_DT
				,TO_CHAR(CNST_BEGIN_DT,'YYYY-MM-DD') AS CNST_BEGIN_DT
				,TO_CHAR(CNST_END_DT,'YYYY-MM-DD') AS CNST_END_DT
				,CNSTRTR
				,LTRIM(TO_CHAR(NVL(CNSTRCT_AMT,0),'999,999,999,990')) AS CNSTRCT_AMT
				,FCLTS_GBN
				,GAM_GET_FCLTS_GBN_NM(FCLTS_GBN) AS FCLTS_GBN_NM
				,FCLTS_SE
				,GAM_GET_FCLTS_SE_NM(FCLTS_SE) AS FCLTS_SE_NM
				,FCLTS_KND
				,GAM_GET_FCLTS_KND_NM(FCLTS_KND) AS FCLTS_KND_NM
				,FCLTS_CN
				,FCLTS_STRCT
				,ARCH_FCLTS_CN
				,ARCH_FCLTS_STRCT
				,CVL_ENG_FCLTS_CN
				,CVL_ENG_FCLTS_STRCT
				,MECH_FCLTS_CN
				,MECH_FCLTS_STRCT
				,ELCTY_FCLTS_CN
				,ELCTY_FCLTS_STRCT
				,INFO_COMM_FCLTS_CN
				,INFO_COMM_FCLTS_STRCT
				,ETC_FCLTS_CN
				,ETC_FCLTS_STRCT
				,LTRIM(TO_CHAR(NVL(ARCH_FCLTS_CNT,0),'999,999,999,990')) AS ARCH_FCLTS_CNT
				,LTRIM(TO_CHAR(NVL(CVL_ENG_FCLTS_CNT,0),'999,999,999,990')) AS CVL_ENG_FCLTS_CNT
				,LTRIM(TO_CHAR(NVL(MECH_FCLTS_CNT,0),'999,999,999,990')) AS MECH_FCLTS_CNT
				,LTRIM(TO_CHAR(NVL(ELCTY_FCLTS_CNT,0),'999,999,999,990')) AS ELCTY_FCLTS_CNT
				,LTRIM(TO_CHAR(NVL(INFO_COMM_FCLTS_CNT,0),'999,999,999,990')) AS INFO_COMM_FCLTS_CNT
				,LTRIM(TO_CHAR(NVL(ETC_FCLTS_CNT,0),'999,999,999,990')) AS ETC_FCLTS_CNT
				,RM
				,REG_USR
				,TO_CHAR(REGIST_DT,'YYYY-MM-DD HH24:MI:SS') AS REGIST_DT
				,UPD_USR
				,TO_CHAR(UPDT_DT,'YYYY-MM-DD HH24:MI:SS') AS UPDT_DT
			FROM FCLTS_MNG_GROUP_F
		WHERE FCLTS_MNG_GROUP_NO = #fcltsMngGroupNo#
	</select>

	<select id="gamFcltsMngGroupMngDao.selectFcltsMngGroupMngMaxGroupNo_S" parameterClass="gamFcltsMngGroupMngVo" resultClass="java.lang.String">
		SELECT #prtAtCode# || '-' || SUBSTRB(#bldDt#,1,4) || '-' || LTRIM(TO_CHAR(TO_NUMBER(NVL(MAX(SUBSTRB(FCLTS_MNG_GROUP_NO,10,5)),'00000'))+1,'00000'))
			FROM FCLTS_MNG_GROUP_F
		WHERE FCLTS_MNG_GROUP_NO LIKE #prtAtCode# || '-' || SUBSTRB(#bldDt#,1,4) || '%'
	</select>

	<insert id="gamFcltsMngGroupMngDao.insertFcltsMngGroupMng_S">
		INSERT INTO FCLTS_MNG_GROUP_F
		(
			 FCLTS_MNG_GROUP_NO
			,FCLTS_MNG_GROUP_NM
			,PRT_AT_CODE
			,LOC
			,OWNER
			,BLD_DT
			,CNST_BEGIN_DT
			,CNST_END_DT
			,CNSTRTR
			,CNSTRCT_AMT
			,FCLTS_GBN
			,FCLTS_SE
			,FCLTS_KND
			,FCLTS_CN
			,FCLTS_STRCT
			,ARCH_FCLTS_CN
			,ARCH_FCLTS_STRCT
			,CVL_ENG_FCLTS_CN
			,CVL_ENG_FCLTS_STRCT
			,MECH_FCLTS_CN
			,MECH_FCLTS_STRCT
			,ELCTY_FCLTS_CN
			,ELCTY_FCLTS_STRCT
			,INFO_COMM_FCLTS_CN
			,INFO_COMM_FCLTS_STRCT
			,ETC_FCLTS_CN
			,ETC_FCLTS_STRCT
			,ARCH_FCLTS_CNT
			,CVL_ENG_FCLTS_CNT
			,MECH_FCLTS_CNT
			,ELCTY_FCLTS_CNT
			,INFO_COMM_FCLTS_CNT
			,ETC_FCLTS_CNT
			,RM
			,REG_USR
			,REGIST_DT
		)
		VALUES
		(
			 #fcltsMngGroupNo#
			,#fcltsMngGroupNm#
			,#prtAtCode#
			,#loc#
			,#owner#
			,TO_DATE(#bldDt#,'YYYY-MM-DD')
			,TO_DATE(#cnstBeginDt#,'YYYY-MM-DD')
			,TO_DATE(#cnstEndDt#,'YYYY-MM-DD')
			,#cnstrtr#
			,NVL(TO_NUMBER(REPLACE(#cnstrctAmt#,',','')),0)
			,#fcltsGbn#
			,#fcltsSe#
			,#fcltsKnd#
			,#fcltsCn#
			,#fcltsStrct#
			,#archFcltsCn#
			,#archFcltsStrct#
			,#cvlEngFcltsCn#
			,#cvlEngFcltsStrct#
			,#mechFcltsCn#
			,#mechFcltsStrct#
			,#elctyFcltsCn#
			,#elctyFcltsStrct#
			,#infoCommFcltsCn#
			,#infoCommFcltsStrct#
			,#etcFcltsCn#
			,#etcFcltsStrct#
			,NVL(TO_NUMBER(REPLACE(#archFcltsCnt#,',','')),0)
			,NVL(TO_NUMBER(REPLACE(#cvlEngFcltsCnt#,',','')),0)
			,NVL(TO_NUMBER(REPLACE(#mechFcltsCnt#,',','')),0)
			,NVL(TO_NUMBER(REPLACE(#elctyFcltsCnt#,',','')),0)
			,NVL(TO_NUMBER(REPLACE(#infoCommFcltsCnt#,',','')),0)
			,NVL(TO_NUMBER(REPLACE(#etcFcltsCnt#,',','')),0)
			,#rm#
			,#regUsr#
			,SYSDATE
		)
	</insert>

	<update id="gamFcltsMngGroupMngDao.updateFcltsMngGroupMng_S">
		UPDATE FCLTS_MNG_GROUP_F SET
			 FCLTS_MNG_GROUP_NM = #fcltsMngGroupNm#
			,PRT_AT_CODE = #prtAtCode#
			,LOC = #loc#
			,OWNER = #owner#
			,BLD_DT = TO_DATE(#bldDt#,'YYYY-MM-DD')
			,CNST_BEGIN_DT = TO_DATE(#cnstBeginDt#,'YYYY-MM-DD')
			,CNST_END_DT = TO_DATE(#cnstEndDt#,'YYYY-MM-DD')
			,CNSTRTR = #cnstrtr#
			,CNSTRCT_AMT = NVL(TO_NUMBER(REPLACE(#cnstrctAmt#,',','')),0)
			,FCLTS_GBN = #fcltsGbn#
			,FCLTS_SE = #fcltsSe#
			,FCLTS_KND = #fcltsKnd#
			,FCLTS_CN = #fcltsCn#
			,FCLTS_STRCT = #fcltsStrct#
			,ARCH_FCLTS_CN = #archFcltsCn#
			,ARCH_FCLTS_STRCT = #archFcltsStrct#
			,CVL_ENG_FCLTS_CN = #cvlEngFcltsCn#
			,CVL_ENG_FCLTS_STRCT = #cvlEngFcltsStrct#
			,MECH_FCLTS_CN = #mechFcltsCn#
			,MECH_FCLTS_STRCT = #mechFcltsStrct#
			,ELCTY_FCLTS_CN = #elctyFcltsCn#
			,ELCTY_FCLTS_STRCT = #elctyFcltsStrct#
			,INFO_COMM_FCLTS_CN = #infoCommFcltsCn#
			,INFO_COMM_FCLTS_STRCT = #infoCommFcltsStrct#
			,ETC_FCLTS_CN = #etcFcltsCn#
			,ETC_FCLTS_STRCT = #etcFcltsStrct#
			,ARCH_FCLTS_CNT = NVL(TO_NUMBER(REPLACE(#archFcltsCnt#,',','')),0)
			,CVL_ENG_FCLTS_CNT = NVL(TO_NUMBER(REPLACE(#cvlEngFcltsCnt#,',','')),0)
			,MECH_FCLTS_CNT = NVL(TO_NUMBER(REPLACE(#mechFcltsCnt#,',','')),0)
			,ELCTY_FCLTS_CNT = NVL(TO_NUMBER(REPLACE(#elctyFcltsCnt#,',','')),0)
			,INFO_COMM_FCLTS_CNT = NVL(TO_NUMBER(REPLACE(#infoCommFcltsCnt#,',','')),0)
			,ETC_FCLTS_CNT= NVL(TO_NUMBER(REPLACE(#etcFcltsCnt#,',','')),0)
			,RM = #rm#
			,UPD_USR = #regUsr#
			,UPDT_DT = SYSDATE
		WHERE FCLTS_MNG_GROUP_NO = #fcltsMngGroupNo#
	</update>

	<delete id="gamFcltsMngGroupMngDao.deleteFcltsMngGroupMng_S">
		DELETE FROM FCLTS_MNG_GROUP_F
		WHERE FCLTS_MNG_GROUP_NO = #fcltsMngGroupNo#
	</delete>

</sqlMap>