<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="300" Id="ISIdDplctCnfirm" Left="8" PidAttrib="7" Title="아이디&#32;중복확인" Top="8" Ver="1.0" Width="400" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_output">
				<Contents></Contents>
			</Dataset>
		</Datasets>
		<Static Height="14" Id="Static19" Left="50" Style="C_Static" TabOrder="2" Text="사용할아이디" Top="98" Width="87"></Static>
		<Edit Border="Flat" CheckLength="Byte" DisableBKColor="white" DisableColor="black" Height="18" Id="txtId" ImeMode="none" Left="138" LeftMargin="1" MaxLength="20" OnKeyDown="txtId_OnKeyDown" Style="C_Edit" TabOrder="1" Top="95" UseIME="FALSE" Width="142"></Edit>
		<Static Height="14" Id="Static0" Left="50" Style="C_Static" TabOrder="3" Text="결과&#32;:&#32;" Top="119" Width="40"></Static>
		<Button ButtonStyle="TRUE" Height="18" Id="btnUse" ImageID="btn_02_2" Left="337" OnClick="btnUse_OnClick" Style="C_Button" TabOrder="4" Text="사용" Top="64" Width="48"></Button>
		<Button ButtonStyle="TRUE" Height="18" Id="btnSearch" ImageID="btn_02_2" Left="279" OnClick="btnSearch_OnClick" Style="C_Button" TabOrder="5" Text="조회" Top="65" Width="48"></Button>
		<Static Height="81" Id="stsResult" Left="98" Style="C_Static" TabOrder="6" Top="119" Width="200"></Static>
		<Image Align="Left" Height="50" Id="Image2" ImageID="pop_title_bg" OnClick="Image2_OnClick" TabOrder="7" Width="400"></Image>
		<Image Height="15" Id="Image3" ImageID="bu02" Left="15" TabOrder="8" Top="18" Width="8"></Image>
		<Static Color="user6" Height="16" Id="Static6" Left="27" Style="C_lblTitle" TabOrder="9" Text="아이디&#32;중복확인" Top="20" Width="200"></Static>
		<Image Height="11" Id="ImgClose" ImageID="btn_close" Left="341" OnClick="ImgClose_OnClick" Static="FALSE" TabOrder="10" Top="19" Width="44"></Image>
		<Image Height="4" Id="Image1" ImageID="icon_06" Left="42" TabOrder="11" Top="103" Width="5"></Image>
	</Form>
	<Script><![CDATA[#include "lib::common.js";

function fnCallback(svcid, errcd, errmsg)
{
	gfn_hideProg(this);
	if(errCd < 0){
		gfn_Message(errCd,errMsg);
		return;
	}
	if(svcid == "get"){
		ds_output.GetColumn(0,"checkId");
		ds_output.GetColumn(0,"usedCnt");
		if ( ds_output.GetColumn(0,"usedCnt") == 1 ) {
			stsResult.Text = "이미사용중인 아이디입니다.";
		}else if ( ds_output.GetColumn(0,"usedCnt") == 0 ) {
			stsResult.Text = "사용할 수 있는 아이디입니다.";
		}else {
			stsResult.Text = "먼저 중복확인을 실행하십시오.";
		}
	}
}


function btnSearch_OnClick(obj)
{
	if ( !gfn_CheckField("txtId", "사용할아이디") ) return false;
	
	gfn_showProg(this,"조회중입니다.");
	ds_output.ClearData();
	var strSvcid = "get";
	var strController = "/ipa/uss/umt/cmm/ISIdDplctCnfirm.do?checkId="+txtId.Text;
	//var strVoClass = "egovframework.com.cmm.ComDefaultVO";
	//var strInputDs = "ds_input=ds_input";
	
	var arrayInputDs = [];
					   	
	var strOutputDs = "ds_output=ds_output";
	var strParam = "";
	var strFnCallback = "fnCallback";

	fnCmTr(this, strSvcid, strController, arrayInputDs, strOutputDs, strParam, strFnCallback);
}


function btnInsert_OnClick(obj)
{
	this.ClosePopup();
}



function btnUse_OnClick(obj)
{
	if ( ds_output.GetColumn(0,"usedCnt") == 0 ) {
		if(isValidObject(parent.txtEntrprsmberId)) parent.txtEntrprsmberId.Text = ds_output.GetColumn(0,"checkId");
		if(isValidObject(parent.txtMberId)) parent.txtMberId.Text = ds_output.GetColumn(0,"checkId");
		if(isValidObject(parent.txtEmplyrId)) parent.txtEmplyrId.Text = ds_output.GetColumn(0,"checkId");
		if(isValidObject(parent.txtUserId)) parent.txtUserId.Text = ds_output.GetColumn(0,"checkId");
	
		//this.ClosePopup();
		ImgClose_OnClick();
	}else{
		stsResult.Text = "먼저 중복확인을 실행하십시오.";
	}
	
}

function txtId_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(nChar == '13') {
		btnSearch_OnClick();
	}
}

function ImgClose_OnClick(obj,nX,nY)
{
	close();
}
]]></Script>
</Window>