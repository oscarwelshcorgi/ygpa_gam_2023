<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="600" Id="ISAuthorRoleManage" Left="8" OnLoadCompleted="ISAuthorRoleManage_OnLoadCompleted" PidAttrib="7" Title="권한&#32;롤&#32;관리" Top="8" Ver="1.0" Width="800" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="menuDc" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_input">
				<Contents>
					<colinfo id="searchCondition" size="256" summ="default" type="STRING"/>
					<colinfo id="searchKeyword" size="256" summ="default" type="STRING"/>
					<record>
						<searchCondition></searchCondition>
						<searchKeyword></searchKeyword>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_combo">
				<Contents>
					<colinfo id="code" size="256" summ="default" type="STRING"/>
					<colinfo id="name" size="256" summ="default" type="STRING"/>
					<colinfo id="value" size="256" summ="default" type="STRING"/>
					<record>
						<code>Y</code>
						<name>Y</name>
						<value>등록</value>
					</record>
					<record>
						<code>N</code>
						<name>N</name>
						<value>미등록</value>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user13" Bottom="98" Height="40" Id="Shape0" Left="16" LineColor="user14" LineKind="Vertical" Right="784" TabOrder="9" Top="58" Type="Rectangle" Width="768"></Shape>
		<Edit Border="Flat" CheckLength="Byte" DisableBKColor="white" DisableColor="black" Enable="FALSE" Height="18" Id="txtSearchKeyword" ImeMode="none" Left="88" LeftMargin="1" MaxLength="20" OnKeyDown="txtSearchKeyword_OnKeyDown" Readonly="TRUE" Style="C_Edit" TabOrder="1" Top="70" Width="154"></Edit>
		<Button ButtonStyle="TRUE" Height="18" Id="btnSearch" ImageID="btn_02_2" Left="664" OnClick="btnSearch_OnClick" Style="C_Button" TabOrder="2" Text="조회" Top="70" Width="48"></Button>
		<Button ButtonStyle="TRUE" Height="18" Id="btnInsert" ImageID="btn_02_2" Left="720" OnClick="btnInsert_OnClick" Style="C_Button" TabOrder="3" Text="저장" Top="70" Width="48"></Button>
		<Image Align="Left" Height="50" Id="Image2" ImageID="pop_title_bg" TabOrder="5" Width="800"></Image>
		<Image Height="15" Id="Image3" ImageID="bu02" Left="15" TabOrder="6" Top="18" Width="8"></Image>
		<Static Color="user6" Height="16" Id="Static0" Left="27" Style="C_lblTitle" TabOrder="7" Text="권한&#32;롤&#32;관리" Top="20" Width="153"></Static>
		<Image Height="11" Id="ImgClose" ImageID="btn_close" Left="741" OnClick="ImgClose_OnClick" Static="FALSE" TabOrder="8" Top="19" Width="44"></Image>
		<Static Align="Right" Height="14" Id="Static19" Left="12" Style="C_Static" TabOrder="4" Text="권한코드" Top="70" Width="61"></Static>
		<Grid AutoFit="TRUE" BindDataset="ds_list" BkColor2="default" BkSelColor="user17" BoldHead="true" Border="Flat" BorderColor="user5" Bottom="584" Color="user0" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadHeight="19" Height="480" Id="grdList" InputPanel="FALSE" Left="16" LineColor="default" MinWidth="100" OnHeadClick="grdList_OnHeadClick" Right="784" SelColor="user20" TabOrder="10" TabStop="true" Top="104" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="768">
			<contents>
				<format id="Default">
					<columns>
						<col width="20"/>
						<col width="86"/>
						<col width="103"/>
						<col width="80"/>
						<col width="80"/>
						<col width="220"/>
						<col width="80"/>
						<col width="80"/>
					</columns>
					<head>
						<cell autosizing="keep" bkcolor="user10" col="0" color="user12" display="checkbox" text="selChk"/>
						<cell bkcolor="user10" col="1" color="user12" display="text" text="롤ID"/>
						<cell bkcolor="user10" col="2" color="user12" display="text" text="롤명"/>
						<cell bkcolor="user10" col="3" color="user12" display="text" text="롤타입"/>
						<cell bkcolor="user10" col="4" color="user12" display="text" text="롤소트"/>
						<cell bkcolor="user10" col="5" color="user12" display="text" text="롤설명"/>
						<cell bkcolor="user10" col="6" color="user12" display="text" text="등록일자"/>
						<cell bkcolor="user10" col="7" color="user12" display="text" text="등록여부"/>
					</head>
					<body>
						<cell autosizing="keep" bkcolor="user6" bkcolor2="user4" col="0" colid="delChk" display="checkbox" edit="checkbox"/>
						<cell bkcolor="user6" bkcolor2="user4" col="1" colid="roleCode" display="text"/>
						<cell bkcolor="user6" bkcolor2="user4" col="2" colid="roleNm" display="text"/>
						<cell align="center" bkcolor="user6" bkcolor2="user4" col="3" colid="roleTyp" display="text"/>
						<cell bkcolor="user6" bkcolor2="user4" col="4" colid="roleSort" display="text"/>
						<cell bkcolor="user6" bkcolor2="user4" col="5" colid="roleDc" display="text"/>
						<cell align="center" bkcolor="user6" bkcolor2="user4" col="6" colid="creatDt" display="text"/>
						<cell align="center" bkcolor="user6" bkcolor2="user4" col="7" colid="regYn" combocol="code" combodataset="ds_combo" combotext="value" display="combo" edit="combo"/>
					</body>
				</format>
			</contents>
		</Grid>
	</Form>
	<Script><![CDATA[#include "lib::common.js";

function fnCallback(svcid, errcd, errmsg)
{
	gfn_hideProg(this);
	if(errCd < 0){
		gfn_Message(errCd,errMsg);
		return;
	}
	if(svcid == "getList"){
		//alert("Success");

	}
	if(svcid == "insert"){
		alert(errMsg);
		parent.btnSearch_OnClick();
		imgClose_OnClick();	
	}
	//alert(ds_list.SaveXML());
}
function btnList_OnClick(obj)
{
	Go(G_Server + "/ipa/cmm/sec/ram/ISAuthorListView.do");
}

function btnSearch_OnClick(obj)
{
	if ( ds_list.GetCount() > 0 ) gfn_GridSort(grdList, -1);
	gfn_showProg(this,"조회중입니다.");
	ds_input.ClearData();
	ds_input.AddRow();
	ds_input.SetColumn(0,"searchCondition",1);
	ds_input.SetColumn(0,"searchKeyword",txtSearchKeyword.Text);


	var strSvcid = "getList";
	var strController = "/ipa/cmm/sec/ram/ISAuthorRoleList.do";
	//var strVoClass = "egovframework.com.cmm.ComDefaultVO";
	//var strInputDs = "ds_input=ds_input";
	
	var arrayInputDs = [
						["ds_input","ds_input","egovframework.com.sec.ram.service.AuthorRoleManageVO"]
					   ];
					   	
	var strOutputDs = "ds_list=ds_output";
	var strParam = "";
	var strFnCallback = "fnCallback";

	fnCmTr(this, strSvcid, strController, arrayInputDs, strOutputDs, strParam, strFnCallback);
}

function btnInsert_OnClick(obj)
{
	gfn_showProg(this,"저장중입니다.");
	var roleCodes = "";
	var regYns = "";
 	for (i=0; i<ds_list.RowCount(); i++){
		if ( ds_list.GetColumn(i, "delChk") == 1 ){
			roleCodes += ds_list.GetColumn(i, "roleCode")+";";
			regYns += ds_list.GetColumn(i, "regYn")+";";

		}
 	}

	var param = "&roleCodes=" + roleCodes;
	param += "&regYns=" + regYns;
	 	

	var strSvcid = "insert";
	var strController = "/ipa/cmm/sec/ram/ISAuthorRoleInsert.do?authorCode="+txtSearchKeyword.Text+param;
	var arrayInputDs = [];
	var strOutputDs = "";
	var strParam = "";
	var strFnCallback = "fnCallback";

	fnCmTr(this, strSvcid, strController, arrayInputDs, strOutputDs, strParam, strFnCallback);

}

function ISAuthorRoleManage_OnLoadCompleted(obj)
{

	if ( gdsPARAM.GetColumn(0,"PARAM_NAME") == 'authorCode' ) 
		txtSearchKeyword.Text = gdsPARAM.GetColumn(0,"PARAM_VALUE");
		
	gdsPARAM.ClearData();
	
	
	btnSearch_OnClick();
}

function grdList_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if (grdList.GetCellProp("head",nCell,"text")=='selChk'
		|| grdList.GetCellProp("head",nCell,"text")=='0'
		|| grdList.GetCellProp("head",nCell,"text")=='1'
	){
		lfn_GridSelChk(obj, "delChk");
	}{
		gfn_GridSort(obj, nCell);
	}
}

function ImgClose_OnClick(obj,nX,nY)
{
	close();
}

function txtSearchKeyword_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if (nChar==13) btnSearch_OnClick();
}
]]></Script>
</Window>