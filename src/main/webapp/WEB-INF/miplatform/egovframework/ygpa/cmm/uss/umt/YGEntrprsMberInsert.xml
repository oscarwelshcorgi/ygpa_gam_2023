<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="500" Id="ISEntrprsMberInsert" Left="8" OnLoadCompleted="ISEntrprsMberInsert_OnLoadCompleted" PidAttrib="7" Title="기업회원등록" Top="8" Ver="1.0" Width="600" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_input">
				<Contents>
					<colinfo id="uniqId" size="256" summ="default" type="STRING"/>
					<colinfo id="entrprsmberId" size="256" summ="default" type="STRING"/>
					<colinfo id="entrprsSeCode" size="256" summ="default" type="STRING"/>
					<colinfo id="bizrno" size="256" summ="default" type="STRING"/>
					<colinfo id="jurirno" size="256" summ="default" type="STRING"/>
					<colinfo id="cmpnyNm" size="256" summ="default" type="STRING"/>
					<colinfo id="cxfc" size="256" summ="default" type="STRING"/>
					<colinfo id="zip" size="256" summ="default" type="STRING"/>
					<colinfo id="adres" size="256" summ="default" type="STRING"/>
					<colinfo id="entrprsMiddleTelno" size="256" summ="default" type="STRING"/>
					<colinfo id="fxnum" size="256" summ="default" type="STRING"/>
					<colinfo id="indutyCode" size="256" summ="default" type="STRING"/>
					<colinfo id="applcntNm" size="256" summ="default" type="STRING"/>
					<colinfo id="sysdate" size="256" summ="default" type="STRING"/>
					<colinfo id="entrprsMberSttus" size="256" summ="default" type="STRING"/>
					<colinfo id="entrprsMberPassword" size="256" summ="default" type="STRING"/>
					<colinfo id="entrprsMberPasswordHint" size="256" summ="default" type="STRING"/>
					<colinfo id="entrprsMberPasswordCnsr" size="256" summ="default" type="STRING"/>
					<colinfo id="groupId" size="256" summ="default" type="STRING"/>
					<colinfo id="detailAdres" size="256" summ="default" type="STRING"/>
					<colinfo id="entrprsEndTelno" size="256" summ="default" type="STRING"/>
					<colinfo id="areaNo" size="256" summ="default" type="STRING"/>
					<colinfo id="applcntEmailAdres" size="256" summ="default" type="STRING"/>
					<colinfo id="applcntIhidnum" size="256" summ="default" type="STRING"/>
					<record>
						<adres></adres>
						<applcntEmailAdres></applcntEmailAdres>
						<applcntIhidnum></applcntIhidnum>
						<applcntNm></applcntNm>
						<areaNo></areaNo>
						<bizrno></bizrno>
						<cmpnyNm></cmpnyNm>
						<cxfc></cxfc>
						<detailAdres></detailAdres>
						<entrprsEndTelno></entrprsEndTelno>
						<entrprsmberId></entrprsmberId>
						<entrprsMberPassword></entrprsMberPassword>
						<entrprsMberPasswordCnsr></entrprsMberPasswordCnsr>
						<entrprsMberPasswordHint></entrprsMberPasswordHint>
						<entrprsMberSttus></entrprsMberSttus>
						<entrprsMiddleTelno></entrprsMiddleTelno>
						<entrprsSeCode></entrprsSeCode>
						<fxnum></fxnum>
						<groupId></groupId>
						<indutyCode></indutyCode>
						<jurirno></jurirno>
						<sysdate></sysdate>
						<uniqId></uniqId>
						<zip></zip>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_groupId">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_passwordHint">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sexdstnCode">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_entrprsMberSttus">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_entrprsSeCode">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_indutyCode">
				<Contents></Contents>
			</Dataset>
		</Datasets>
		<Static Align="Right" Height="14" Id="Static19" Left="18" Style="C_Static" TabOrder="2" Text="기업회원아이디" Top="103" Width="100"></Static>
		<Edit BindDataset="ds_input" Border="Flat" Column="entrprsmberId" DisableColor="black" Enable="FALSE" Height="18" Id="txtEntrprsmberId" ImeMode="none" Left="122" LeftMargin="1" MaxLength="20" Readonly="TRUE" Style="C_Edit" TabOrder="1" Top="100" UseIME="FALSE" Width="118"></Edit>
		<Image Height="15" Id="imgIdCheck" ImageID="btn_07" Left="244" OnClick="imgIdCheck_OnClick" Static="FALSE" TabOrder="3" Top="102" Width="18"></Image>
		<Static Height="14" Id="Static0" Left="268" Style="C_Static" TabOrder="4" Text="(중복아이디&#32;검색)" Top="103" Width="137"></Static>
		<Static Align="Right" Height="14" Id="Static1" Left="18" Style="C_Static" TabOrder="6" Text="회사명" Top="123" Width="100"></Static>
		<Edit BindDataset="ds_input" Border="Flat" Column="cmpnyNm" DisableBKColor="white" DisableColor="black" Height="18" Id="txtCmpnyNm" ImeMode="none" Left="122" LeftMargin="1" MaxLength="18" Style="C_Edit" TabOrder="5" Top="120" Width="118"></Edit>
		<Static Align="Right" Height="14" Id="Static3" Left="18" Style="C_Static" TabOrder="8" Text="비밀번호" Top="143" Width="100"></Static>
		<Edit BindDataset="ds_input" Border="Flat" Column="entrprsMberPassword" DisableBKColor="white" DisableColor="black" Height="18" Id="txtEntrprsMberPassword" ImeMode="none" Left="122" LeftMargin="1" MaxLength="20" Password="TRUE" Style="C_Edit" TabOrder="7" Top="140" UseIME="FALSE" Width="118"></Edit>
		<Edit BindDataset="ds_input" Border="Flat" DisableBKColor="white" DisableColor="black" Height="18" Id="txtEntrprsMberPassword2" ImeMode="none" Left="360" LeftMargin="1" MaxLength="20" Password="TRUE" Style="C_Edit" TabOrder="9" Top="140" UseIME="FALSE" Width="118"></Edit>
		<Static Align="Right" Height="14" Id="Static5" Left="257" Style="C_Static" TabOrder="10" Text="비밀번호확인" Top="143" Width="100"></Static>
		<Static Align="Right" Height="14" Id="Static6" Left="18" Style="C_Static" TabOrder="11" Text="비밀번호힌트" Top="163" Width="100"></Static>
		<Edit BindDataset="ds_input" Border="Flat" Column="entrprsMberPasswordCnsr" DisableBKColor="white" DisableColor="black" Height="18" Id="txtEntrprsMberPasswordCnsr" ImeMode="none" Left="122" LeftMargin="1" MaxLength="20" Style="C_Edit" TabOrder="12" Top="180" Width="252"></Edit>
		<Static Align="Right" Height="14" Id="Static7" Left="18" Style="C_Static" TabOrder="13" Text="비밀번호정답" Top="183" Width="100"></Static>
		<Combo BindDataset="ds_input" Border="Flat" BorderColor="user5" CodeColumn="code" Column="entrprsMberPasswordHint" DataColumn="codeNM" Height="18" Id="cmbEntrprsMberPasswordHint" INDEX="1" InnerDataset="ds_passwordHint" Left="122" TabOrder="14" Text="---선택하세요---" Top="159" Width="252"></Combo>
		<Static Align="Right" Height="14" Id="Static8" Left="18" Style="C_Static" TabOrder="15" Text="업종코드" Top="203" Width="100"></Static>
		<Combo BindDataset="ds_input" Border="Flat" BorderColor="user5" CodeColumn="code" Column="indutyCode" DataColumn="codeNm" Height="18" Id="Combo1" InnerDataset="ds_indutyCode" Left="122" TabOrder="18" Text="---선택하세요---" Top="199" Width="110"></Combo>
		<Static Align="Right" Height="14" Id="Static9" Left="18" Style="C_Static" TabOrder="17" Text="회사전화번호" Top="284" Width="100"></Static>
		<Edit BindDataset="ds_input" Border="Flat" Column="areaNo" DisableBKColor="white" DisableColor="black" Height="18" Id="Edit3" ImeMode="none" Left="122" LeftMargin="1" MaxLength="5" Number="TRUE" Style="C_Edit" TabOrder="16" Top="281" Width="48"></Edit>
		<Static Align="Center" Font="Tahoma,10,Bold" Height="14" Id="Static10" Left="172" Style="C_Static" TabOrder="19" Text="-" Top="282" Width="9"></Static>
		<Edit BindDataset="ds_input" Border="Flat" Column="entrprsMiddleTelno" DisableBKColor="white" DisableColor="black" Height="18" Id="Edit5" ImeMode="none" Left="183" LeftMargin="1" MaxLength="5" Number="TRUE" Style="C_Edit" TabOrder="20" Top="281" Width="48"></Edit>
		<Static Align="Center" Font="Tahoma,10,Bold" Height="14" Id="Static11" Left="233" Style="C_Static" TabOrder="21" Text="-" Top="282" Width="9"></Static>
		<Edit BindDataset="ds_input" Border="Flat" Column="entrprsEndTelno" DisableBKColor="white" DisableColor="black" Height="18" Id="Edit6" ImeMode="none" Left="244" LeftMargin="1" MaxLength="5" Number="TRUE" Style="C_Edit" TabOrder="22" Top="281" Width="48"></Edit>
		<Static Align="Right" Height="14" Id="Static12" Left="18" Style="C_Static" TabOrder="24" Text="팩스번호" Top="304" Width="100"></Static>
		<Edit BindDataset="ds_input" Border="Flat" Column="fxnum" DisableBKColor="white" DisableColor="black" Height="18" Id="Edit7" ImeMode="none" Left="122" LeftMargin="1" MaxLength="15" Style="C_Edit" TabOrder="23" Top="301" UseIME="FALSE" Width="198"></Edit>
		<Static Align="Right" Height="14" Id="Static13" Left="18" Style="C_Static" TabOrder="26" Text="신청자이름" Top="385" Width="100"></Static>
		<Edit BindDataset="ds_input" Border="Flat" Column="applcntNm" DisableBKColor="white" DisableColor="black" Height="18" Id="Edit8" ImeMode="none" Left="122" LeftMargin="1" MaxLength="20" Style="C_Edit" TabOrder="25" Top="382" Width="198"></Edit>
		<Static Align="Right" Height="14" Id="Static14" Left="18" Style="C_Static" TabOrder="28" Text="신청자이메일주소" Top="405" Width="100"></Static>
		<Edit BindDataset="ds_input" Border="Flat" Column="applcntEmailAdres" DisableBKColor="white" DisableColor="black" Height="18" Id="Edit9" ImeMode="none" Left="122" LeftMargin="1" MaxLength="50" Style="C_Edit" TabOrder="27" Top="402" UseIME="FALSE" Width="252"></Edit>
		<Static Align="Right" Height="14" Id="Static15" Left="18" Style="C_Static" TabOrder="30" Text="우편번호" Top="325" Width="100"></Static>
		<Edit BindDataset="ds_input" Border="Flat" Column="zip" DisableColor="black" Enable="FALSE" Height="18" Id="txtZip" ImeMode="none" Left="122" LeftMargin="1" MaxLength="20" Readonly="TRUE" Style="C_Edit" TabOrder="29" Top="322" Width="96"></Edit>
		<Image Height="15" Id="imgZip" ImageID="btn_07" Left="223" OnClick="imgZip_OnClick" Static="FALSE" TabOrder="31" Top="324" Width="18"></Image>
		<Static Height="14" Id="Static16" Left="247" Style="C_Static" TabOrder="32" Text="(우편번호&#32;검색)" Top="325" Width="137"></Static>
		<Static Align="Right" Height="14" Id="Static17" Left="18" Style="C_Static" TabOrder="34" Text="주소" Top="345" Width="100"></Static>
		<Edit BindDataset="ds_input" Border="Flat" Column="adres" DisableColor="black" Enable="FALSE" Height="18" Id="txtAdres" ImeMode="none" Left="122" LeftMargin="1" MaxLength="33" Readonly="TRUE" Style="C_Edit" TabOrder="33" Top="342" Width="252"></Edit>
		<Static Align="Right" Height="14" Id="Static18" Left="18" Style="C_Static" TabOrder="36" Text="상세주소" Top="365" Width="100"></Static>
		<Edit BindDataset="ds_input" Border="Flat" Column="detailAdres" DisableBKColor="white" DisableColor="black" Height="18" Id="txtDetailAdres" ImeMode="none" Left="122" LeftMargin="1" MaxLength="33" Style="C_Edit" TabOrder="35" Top="362" Width="252"></Edit>
		<Static Align="Right" Height="14" Id="Static20" Left="18" Style="C_Static" TabOrder="37" Text="그룹아이디" Top="425" Width="100"></Static>
		<Combo BindDataset="ds_input" Border="Flat" BorderColor="user5" CodeColumn="code" Column="groupId" DataColumn="codeNm" Height="18" Id="Combo2" InnerDataset="ds_groupId" Left="122" TabOrder="38" Text="---선택하세요---" Top="421" Width="110"></Combo>
		<Static Align="Right" Height="14" Id="Static21" Left="257" Style="C_Static" TabOrder="39" Text="기업회원상태코드" Top="426" Width="100"></Static>
		<Combo BindDataset="ds_input" Border="Flat" BorderColor="user5" CodeColumn="code" Column="entrprsMberSttus" DataColumn="codeNm" Height="18" Id="Combo3" InnerDataset="ds_entrprsMberSttus" Left="360" TabOrder="40" Text="---선택하세요---" Top="422" Width="110"></Combo>
		<Static Align="Right" Height="14" Id="Static22" Left="258" Style="C_Static" TabOrder="41" Text="기업구분코드" Top="203" Width="100"></Static>
		<Combo BindDataset="ds_input" Border="Flat" BorderColor="user5" CodeColumn="code" Column="entrprsSeCode" DataColumn="codeNm" Height="18" Id="Combo4" InnerDataset="ds_entrprsSeCode" Left="360" TabOrder="42" Text="---선택하세요---" Top="199" Width="110"></Combo>
		<Static Align="Right" Height="14" Id="Static23" Left="18" Style="C_Static" TabOrder="44" Text="대표이사이름" Top="223" Width="100"></Static>
		<Edit BindDataset="ds_input" Border="Flat" Column="cxfc" DisableBKColor="white" DisableColor="black" Height="18" Id="Edit13" ImeMode="none" Left="122" LeftMargin="1" MaxLength="20" Style="C_Edit" TabOrder="43" Top="220" Width="118"></Edit>
		<Static Align="Right" Height="14" Id="Static24" Left="18" Style="C_Static" TabOrder="45" Text="사업자등록번호" Top="243" Width="100"></Static>
		<MaskEdit Align="Center" BindDataset="ds_input" Border="Flat" BorderColor="user5" Column="bizrno" Height="18" Id="MaskEdit0" Left="122" Mask="###-##-#####" TabOrder="46" Top="240" Type="STRING" Width="118"></MaskEdit>
		<Static Align="Right" Height="14" Id="Static25" Left="18" Style="C_Static" TabOrder="47" Text="법인등록번호" Top="263" Width="100"></Static>
		<Button ButtonStyle="TRUE" Height="18" Id="btnInsert" ImageID="btn_02_2" Left="480" OnClick="btnInsert_OnClick" Style="C_Button" TabOrder="48" Text="저장" Top="66" Width="48"></Button>
		<Button ButtonStyle="TRUE" Height="18" Id="btnClear" ImageID="btn_02_2" Left="538" OnClick="btnClear_OnClick" Style="C_Button" TabOrder="49" Text="취소" Top="66" Width="48"></Button>
		<Image Align="Left" Height="50" Id="Image0" ImageID="pop_title_bg" TabOrder="50" Width="600"></Image>
		<Image Height="15" Id="Image2" ImageID="bu02" Left="15" TabOrder="51" Top="18" Width="8"></Image>
		<Static Color="user6" Height="16" Id="Static26" Left="27" Style="C_lblTitle" TabOrder="52" Text="기업회원등록" Top="20" Width="153"></Static>
		<Image Height="11" Id="ImgClose" ImageID="btn_close" Left="541" OnClick="ImgClose_OnClick" Static="FALSE" TabOrder="53" Top="19" Width="44"></Image>
		<Image Height="4" Id="Image9" ImageID="icon_06" Left="25" TabOrder="54" Top="107" Width="5"></Image>
		<Image Height="4" Id="Image1" ImageID="icon_06" Left="74" TabOrder="55" Top="127" Width="5"></Image>
		<Image Height="4" Id="Image3" ImageID="icon_06" Left="61" TabOrder="56" Top="147" Width="5"></Image>
		<Image Height="4" Id="Image4" ImageID="icon_06" Left="37" TabOrder="57" Top="167" Width="5"></Image>
		<Image Height="4" Id="Image5" ImageID="icon_06" Left="37" TabOrder="58" Top="187" Width="5"></Image>
		<Image Height="4" Id="Image6" ImageID="icon_06" Left="26" TabOrder="59" Top="247" Width="5"></Image>
		<Image Height="4" Id="Image7" ImageID="icon_06" Left="38" TabOrder="60" Top="288" Width="5"></Image>
		<Image Height="4" Id="Image8" ImageID="icon_06" Left="62" TabOrder="61" Top="329" Width="5"></Image>
		<Image Height="4" Id="Image10" ImageID="icon_06" Left="85" TabOrder="62" Top="347" Width="5"></Image>
		<Image Height="4" Id="Image11" ImageID="icon_06" Left="50" TabOrder="63" Top="390" Width="5"></Image>
		<Image Height="4" Id="Image12" ImageID="icon_06" Left="14" TabOrder="64" Top="410" Width="5"></Image>
		<Image Height="4" Id="Image13" ImageID="icon_06" Left="49" TabOrder="65" Top="429" Width="5"></Image>
		<Image Height="4" Id="Image14" ImageID="icon_06" Left="251" TabOrder="66" Top="429" Width="5"></Image>
		<Image Height="4" Id="Image15" ImageID="icon_06" Left="276" TabOrder="67" Top="148" Width="5"></Image>
		<Edit BindDataset="ds_input" Border="Flat" Column="jurirno" DisableBKColor="white" DisableColor="black" Height="18" Id="Edit0" ImeMode="none" Left="122" LeftMargin="1" MaxLength="13" Number="TRUE" Style="C_Edit" TabOrder="68" Top="260" Width="118"></Edit>
	</Form>
	<Script><![CDATA[#include "lib::common.js";

function fnCallback(svcid, errcd, errmsg)
{
	gfn_hideProg(this);
	if(errCd < 0){
		gfn_Message(errCd,errMsg);
		return;
	}
	if(svcid == "insert"){
		alert(errMsg);	
		parent.btnSearch_OnClick();
		imgClose_OnClick();
	}	
	if(svcid == "getcode"){
		//alert(ds_passwordHint.saveXml());
		//alert(ds_sexdstnCode.saveXml());
		//alert(ds_entrprsMberSttus.saveXml());
		//alert(ds_entrprsSeCode.saveXml());
		//alert(ds_indutyCode.saveXml());
	}

	
}

function imgZip_OnClick(obj,nX,nY)
{
	var url=G_Server+"/ipa/sym/cmm/zip/ISCcmZipSearchPopupView.do";

	var iXPos = ClientToScreenX(this, 0);
	var iyPos = ClientToScreenY(this, 30);

	Dialog(url,"",400,300,"",iXPos,iyPos);
/*	
	var iXPos = ClientToScreenX(obj, 0);
	var iyPos = ClientToScreenY(obj, obj.height);

	var url=G_Server+"/ipa/sym/cmm/zip/ISCcmZipSearchPopupView.do";
	var divleft = -1;
	var divtop = -1;
	var objname = "zipDiv";
	if(!isValidObject(object(objname))){
		Create("PopupDiv", objname ,'width="400" height="300" border="Flat" url="'+url+'"'); 
		object(objname).TrackPopup(iXPos, iyPos);		
	}else{
		object(objname).TrackPopup(iXPos, iyPos);		
	}
*/	
}

function imgIdCheck_OnClick(obj,nX,nY)
{
	var url=G_Server+"/ipa/uss/umt/cmm/ISIdDplctCnfirmView.do";

	var iXPos = ClientToScreenX(this, 0);
	var iyPos = ClientToScreenY(this, 30);

	Dialog(url,"",400,300,"",iXPos,iyPos);	
	/*
	var iXPos = ClientToScreenX(obj, 0);
	var iyPos = ClientToScreenY(obj, obj.height);

	var url=G_Server+"/ipa/uss/umt/cmm/ISIdDplctCnfirmView.do";
	var divleft = -1;
	var divtop = -1;
	var objname = "idDiv";
	if(!isValidObject(object(objname))){
		Create("PopupDiv", objname ,'width="292" height="152" border="Flat" url="'+url+'"'); 
		object(objname).TrackPopup(iXPos, iyPos);		
	}else{
		object(objname).TrackPopup(iXPos, iyPos);		
	}
	*/
}

function btnList_OnClick(obj)
{
	Go(G_Server + "/ipa/uss/umt/entrprs/ISEntrprsMberManageView.do");
}

function btnClear_OnClick(obj)
{
	ds_input.Reset();
	txtEntrprsMberPassword2 = "";
}

function btnInsert_OnClick(obj)
{
	if ( txtEntrprsMberPassword.text != txtEntrprsMberPassword2.text ){
			alert("비밀번호와 비밀번호 확인이 일치하지 않습니다.");
			txtEntrprsMberPassword.setFocus();
			return false;	
	}
	
	if ( !gfn_CheckField("txtEntrprsmberId|txtCmpnyNm|txtEntrprsMberPassword|txtEntrprsMberPassword2|cmbEntrprsMberPasswordHint|txtEntrprsMberPasswordCnsr|MaskEdit0|Edit3|Edit5|Edit6|txtZip|txtAdres|Edit8|Edit9|Combo2|Combo3", "기업회원아이디|회사명|비밀번호|비밀번호확인|비밀번호힌트|비밀번호정답|사업자등록번호|회사전화번호|회사전화번호|회사전화번호|우편번호|주소|신청자이름|신청자이메일주소|그룹아이디|기업회원상태코드") ) return false;

	if ( !gfn_CheckEmail(Edit9.Text) ) {
			alert("이메일 주소 형식이 아닙니다.");
			Edit9.setFocus();
			return false;
	}

	gfn_showProg(this,"저장중입니다.");
	var strSvcid = "insert";
	var strController = "/ipa/uss/umt/entrprs/ISEntrprsMberInsert.do";
	var arrayInputDs = [
						["ds_input","ds_input","egovframework.com.uss.umt.service.EntrprsManageVO"]
					   ];
	var strOutputDs = "";
	var strParam = "";
	var strFnCallback = "fnCallback";

	fnCmTr(this, strSvcid, strController, arrayInputDs, strOutputDs, strParam, strFnCallback);	
}



function selectCmmCode()
{
	gfn_showProg(this,"조회중입니다.");
	

	var strSvcid = "getcode";
	var strController = "/ipa/uss/umt/entrprs/ISEntrprsMberInsertCmmCode.do";
	var arrayInputDs = [];
					   //클라이언트, 서버
	var strOutputDs = "ds_passwordHint=ds_passwordHint"
					 +" ds_sexdstnCode=ds_sexdstnCode"
					 +" ds_entrprsMberSttus=ds_entrprsMberSttus"
					 +" ds_entrprsSeCode=ds_entrprsSeCode"
					 +" ds_indutyCode=ds_indutyCode"
					 +" ds_groupId=ds_groupId";
	var strParam = "";
	var strFnCallback = "fnCallback";
	
	fnCmTr(this, strSvcid, strController, arrayInputDs, strOutputDs, strParam, strFnCallback);	
}

function ISEntrprsMberInsert_OnLoadCompleted(obj)
{
	selectCmmCode();
}

function ImgClose_OnClick(obj,nX,nY)
{
	close();
}
]]></Script>
</Window>