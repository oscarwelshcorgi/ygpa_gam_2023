<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="24" Id="COMM_PAGE" Left="8" PidAttrib="7" Top="8" Ver="1.0" Width="570" WorkArea="true">
		<Grid AutoFitEndLine="Hide" AutoScrollBar="None" BkColor2="default" BoldHead="true" Border="Flat" BorderColor="white" Bottom="20" Color="user0" Enable="true" EndLineColor="default" Font="돋움,8" HeadBorder="None" Height="18" Id="grd_Page" InputPanel="FALSE" Left="13" LineColor="white" OnHeadClick="grd_Page_OnHeadClick" Right="439" ShadowColor="white" TabOrder="1" TabStop="true" Top="2" UseAutoSizing="Col" UseDBuff="true" UseExSizing="Col" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="426">
			<contents>
				<format id="Default">
					<columns>
						<col width="24"/>
						<col width="24"/>
						<col width="24"/>
						<col width="24"/>
						<col width="24"/>
						<col width="24"/>
						<col width="24"/>
						<col width="24"/>
						<col width="24"/>
						<col width="24"/>
						<col width="24"/>
						<col width="24"/>
						<col width="24"/>
						<col width="24"/>
					</columns>
					<head>
						<cell bkcolor="white" bkimageid="btn_prev" col="0" display="button"/>
						<cell bkcolor="white" bkimageid="btn_left" col="1" display="button"/>
						<cell bkcolor="white" col="2" display="text" text="1"/>
						<cell bkcolor="white" col="3" color="user2" display="text" text="2"/>
						<cell bkcolor="white" col="4" display="text" text="3"/>
						<cell bkcolor="white" col="5" display="text" text="4"/>
						<cell bkcolor="white" col="6" display="text" text="5"/>
						<cell bkcolor="white" col="7" display="text" text="6"/>
						<cell bkcolor="white" col="8" display="text" text="7"/>
						<cell bkcolor="white" col="9" display="text" text="8"/>
						<cell bkcolor="white" col="10" display="text" text="999"/>
						<cell bkcolor="white" col="11" display="text" text="100"/>
						<cell bkcolor="white" bkimageid="btn_right" col="12" display="button"/>
						<cell bkcolor="white" bkimageid="btn_next" col="13" display="button"/>
					</head>
				</format>
			</contents>
		</Grid>
	</Form>
	<Script><![CDATA[
function COMM_PAGE_OnLoadCompleted(obj)
{
	
}

function fn_PaintGrid()
{
	grd_Page.Redraw = false;
	var lv_CurPage  = GDS_PAGE_INFO_TEMP.GetColumn(0,"CURRPAGE");	//현재 페이지
	var lv_PageSize = GDS_PAGE_INFO_TEMP.GetColumn(0,"PAGESIZE");	//페이지 사이즈
	var lv_TotCnt   = GDS_PAGE_INFO_TEMP.GetColumn(0,"TOTALCOUNT");	//데이터 갯수
	if(lv_TotCnt == 0)	return;
	
	var lv_TotPage  = truncate(lv_TotCnt/lv_PageSize);				//전체 페이지 계산
	if(lv_TotCnt%lv_PageSize > 0)	lv_Totpage++;					//
	var lv_InitVal  = 1;											//페이징 시작 페이지
	//현재 페이지가 10으로 떨어지면서 10보다 클때 시작페이지는 십단위페이지 + 1
	if(lv_CurPage%10 == 0 && lv_CurPage > 10)	lv_InitVal = lv_CurPage - 9;
	else if(lv_CurPage > 10)	lv_InitVal =lv_CurPage - (lv_CurPage%10) + 1;
//	var lv_PageGab  = lv_TotPage - (lv_InitVal*10);
	var lv_PageGab  = lv_TotPage - lv_InitVal + 1;
	if(lv_PageGab > 10)	lv_PageGab = 10;

	var lv_col = 0;
	var lv_cts  = "";
		lv_cts += "	<contents>\n";
		lv_cts += "		<format id='Default'>\n";
		lv_cts += "			<columns>\n";
		lv_cts += "				<col width='20'/>\n";
		lv_cts += "				<col width='20'/>\n";
		for(var i=1; i<=lv_PageGab; i++)
			lv_cts += "				<col width='20'/>\n";
		lv_cts += "				<col width='20'/>\n";
		lv_cts += "				<col width='20'/>\n";
		lv_cts += "			</columns>\n";
		lv_cts += "			<head>\n";
		//맨처음,이전 10 페이지 활성화
		if(lv_InitVal > 10)
			lv_cts += "				<cell bkcolor='white' bkimageid='ico_first' col='" + lv_col + "' cursor = 'hand' display='text'/>\n";
		else
			lv_cts += "				<cell bkcolor='white' bkimageid='ico_first' col='" + lv_col + "' cursor = 'arrow' display='text'/>\n";
		lv_col++;
		if(lv_InitVal > 10)
			lv_cts += "				<cell bkcolor='white' bkimageid='ico_pre' col='" + lv_col + "' cursor='hand' display='text'/>\n";
		else
			lv_cts += "				<cell bkcolor='white' bkimageid='ico_pre' col='" + lv_col + "' cursor='arrow' display='text'/>\n";
		lv_col++;
		for(var i=1; i<=lv_PageGab; i++)
		{
			if((lv_InitVal-1)+i == lv_CurPage)
				lv_cts += "				<cell bkcolor='white' col='" + lv_col + "' color='darkblue' cursor='arrow' display='text' text='" + ((lv_InitVal-1)+i) + "'/>\n";
			else
				lv_cts += "				<cell bkcolor='white' col='" + lv_col + "' color='user6' cursor='hand' display='text' text='" + ((lv_InitVal-1)+i) + "'/>\n";
			lv_col++;
		}
		//맨뒤,다음 10 페이지 활성화
		if(lv_Totpage > lv_InitVal+9)
			lv_cts += "				<cell bkcolor='white' bkimageid='ico_next' col='" + lv_col + "' cursor='hand' display='text'/>\n";
		else
			lv_cts += "				<cell bkcolor='white' bkimageid='ico_next' col='" + lv_col + "' cussor='arrow' display='text'/>\n";
		lv_col++;
		if(lv_Totpage > lv_InitVal+9)
			lv_cts += "				<cell bkcolor='white' bkimageid='ico_last' col='" + lv_col + "' cursor='hand' display='text'/>\n";
		else
			lv_cts += "				<cell bkcolor='white' bkimageid='ico_last' col='" + lv_col + "' cursor='arrow' display='text'/>\n";
		lv_cts += "			</head>\n";
		lv_cts += "		</format>\n";
		lv_cts += "	</contents>";
	grd_Page.Contents = lv_cts;
	fn_SetGridPos((lv_PageGab+4)*24);
	grd_Page.Redraw = true;
	SetWaitCursor(false);
}
function grd_Page_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	var lv_tmp = toUpper(grd_Page.GetCellProp("head",nCell,"cursor"));
	if(lv_tmp <> "HAND")	return;
	
	lv_tmp = grd_Page.GetCellProp("head",nCell,"text");
	if(lv_tmp == "")
	{
		lv_tmp = grd_Page.GetCellProp("head",nCell,"BkImageID");
	}
	if(lv_tmp == "ico_first")	lv_tmp = "1";
	else if(lv_tmp == "ico_pre")
	{
		lv_tmp = toNumber(grd_Page.GetCellProp("head",2,"text"))-10;
	}
	else if(lv_tmp == "ico_next")
	{
		lv_tmp = toNumber(grd_Page.GetCellProp("head",11,"text"))+1;
	}
	else if(lv_tmp == "ico_last")
	{
		var lv_PageSize = GDS_PAGE_INFO_TEMP.GetColumn(0,"PAGESIZE");
		var lv_TotCnt   = GDS_PAGE_INFO_TEMP.GetColumn(0,"TOTALCOUNT");
		var lv_TotPage  = toNumber(truncate(lv_TotCnt/lv_PageSize));
		if(lv_TotCnt%lv_PageSize > 0)	lv_Totpage++;
		var lv_last = toNumber(lv_Totpage%10-1);
		if(lv_last == -1)	lv_last = 9;
		lv_tmp = lv_Totpage - lv_last;
	}
	
	GDS_PAGE_INFO.SetColumn(0,"CURRPAGE",lv_tmp);
	GDS_PAGE_INFO_TEMP.SetColumn(0,"CURRPAGE",lv_tmp);
	parent.fn_select();
}
//그리드 위치 중앙으로
function fn_SetGridPos(l_width)
{
	var lv_left = (this.width - l_width)/2;
	grd_Page.Left = lv_left;
}]]></Script>
</Window>